<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
    <id>https://yangggshuyi.github.io</id>
    <title>è–…ç¾Šæ¯›è®°å½•ä»ª</title>
    <updated>2021-03-24T02:19:11.392Z</updated>
    <generator>https://github.com/jpmonette/feed</generator>
    <link rel="alternate" href="https://yangggshuyi.github.io"/>
    <link rel="self" href="https://yangggshuyi.github.io/atom.xml"/>
    <subtitle>æ—§å²èˆäººå¦‚æœ¨è½ æ–°æ˜¥äºˆä¹‰å†æ˜“é£</subtitle>
    <logo>https://yangggshuyi.github.io/images/avatar.png</logo>
    <icon>https://yangggshuyi.github.io/favicon.ico</icon>
    <rights>All rights reserved 2021, è–…ç¾Šæ¯›è®°å½•ä»ª</rights>
    <entry>
        <title type="html"><![CDATA[å‡ å¥åºŸè¯]]></title>
        <id>https://yangggshuyi.github.io/post/ji-ju-fei-hua/</id>
        <link href="https://yangggshuyi.github.io/post/ji-ju-fei-hua/">
        </link>
        <updated>2021-03-24T01:54:59.000Z</updated>
        <summary type="html"><![CDATA[<p>é¢è…¾è®¯é¢å‡ºäº†æ‹çˆ±çš„å¿ƒå¾—ï¼Œä»¥ä¸ºå–œæ¬¢ä¸Šå´å¼€å§‹ç–è¿œæ¥ç€åˆæ¥è¿‘ã€‚æœç„¶ï¼Œæ— è®ºæ˜¯æ‹çˆ±è¿˜æ˜¯é¢è¯•ï¼Œæˆ‘éƒ½è¡¨ç°å‡ºåº”æ¥ä¸æš‡ï¼Œæ‰è¥Ÿè§è‚˜ã€‚</p>
]]></summary>
        <content type="html"><![CDATA[<p>é¢è…¾è®¯é¢å‡ºäº†æ‹çˆ±çš„å¿ƒå¾—ï¼Œä»¥ä¸ºå–œæ¬¢ä¸Šå´å¼€å§‹ç–è¿œæ¥ç€åˆæ¥è¿‘ã€‚æœç„¶ï¼Œæ— è®ºæ˜¯æ‹çˆ±è¿˜æ˜¯é¢è¯•ï¼Œæˆ‘éƒ½è¡¨ç°å‡ºåº”æ¥ä¸æš‡ï¼Œæ‰è¥Ÿè§è‚˜ã€‚</p>
<!-- more -->
<p>é€€æ­¥çš„å¼€å§‹</p>
<p>è‡ªæˆ‘æ„Ÿè§‰è‰¯å¥½ï¼Œæ˜¯é€€æ­¥çš„å¼€å§‹å—ï¼Ÿç­”ï¼šä¸ä¸€å®šåœ¨é€€æ­¥ï¼Œä½†ä¸€å®šæ²¡åœ¨è¿›æ­¥å‘¢</p>
<p>å¿˜ä¹æ‰€ä»¥</p>
<p>å³ä½¿æœ€é«˜æ˜çš„äººä¹Ÿå¾ˆå®¹æ˜“è‡ªé«˜è‡ªå¤§ï¼šç»™ä»–æŸäº›ç‰¹æƒï¼Œä»–å°±å¿˜ä¹æ‰€ä»¥ï¼Œå£°ç§°è¿™äº›æ˜¯ä»–ä¸å¯å‰¥å¤ºçš„æƒåˆ©ï¼›äºˆä»–å°‘è®¸æƒå¨ï¼Œä»–å°±å˜æˆæš´å›ã€‚ç»™å‚»ç“œä¸€å¥—åˆ¶æœï¼Œä¸Šé¢ç¼ä¸€ä¸¤ä¸ªæ ‡ç­¾ï¼Œä»–å°±ä»¥ä¸ºè‡ªå·±çš„è¯å³æ˜¯æ³•å¾‹</p>
<p>æ±‚å®‰æ…°</p>
<p>7å¤©5é¢+githubå´©æºƒï¼Œå¯æˆ‘æ€ä¹ˆè·Ÿç€ä¸€èµ·å´©æºƒäº†ã€‚æ¯å¤©å››å¤„æ±‚å®‰æ…°ï¼Œè¿™ä¸€ç‚¹å¥½åƒçœŸçš„å¾ˆè®¨åŒã€‚</p>
<p>æœŸå¾…</p>
<p>é ç€é‚£äº›å¯¹æ˜å¤©çš„æœŸå¾…ï¼Œç•…æƒ³æœªæ¥ï¼Œä¹Ÿè®©æˆ‘æƒ³è¦ç»§ç»­ç”Ÿæ´»ä¸‹å»</p>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[è…¾è®¯æ•°åˆ†é¢ç»é—®é¢˜æ±‡æ€»ï¼ˆæ›´æ–°ä¸­ï¼‰]]></title>
        <id>https://yangggshuyi.github.io/post/teng-xun-shu-fen-mian-jing-wen-ti-hui-zong-geng-xin-zhong/</id>
        <link href="https://yangggshuyi.github.io/post/teng-xun-shu-fen-mian-jing-wen-ti-hui-zong-geng-xin-zhong/">
        </link>
        <updated>2021-03-16T14:24:47.000Z</updated>
        <summary type="html"><![CDATA[<p>åœæ­¢å†…è€—ï¼Œå‡å°‘ç„¦è™‘ã€‚ã€‚ã€‚</p>
]]></summary>
        <content type="html"><![CDATA[<p>åœæ­¢å†…è€—ï¼Œå‡å°‘ç„¦è™‘ã€‚ã€‚ã€‚</p>
<!-- more -->
<h1 id="å®ä¹ é¡¹ç›®">å®ä¹ &amp;é¡¹ç›®</h1>
<p>1.ç›‘æ§å“ªäº›æŒ‡æ ‡ï¼Ÿ</p>
<p>2.æœ€é‡è¦çš„æŒ‡æ ‡æ˜¯é‚£å‡ ä¸ªï¼Ÿ</p>
<p>3.å¦‚ä½•åšå¼‚åŠ¨æŒ‡æ ‡åˆ†æï¼Ÿ</p>
<p>4.æ¨¡å‹æ„å»ºäº†å“ªäº›ç‰¹å¾ï¼Ÿ</p>
<p>5.æœ€åå‘ç°å“ªäº›ç‰¹å¾æ¯”è¾ƒæœ‰æ„ä¹‰ï¼Ÿ</p>
<p>6.æ•°æ®å¤„ç†é—®é¢˜ï¼šç±»ä¸å¹³è¡¡æ€ä¹ˆå¤„ç†çš„ï¼Ÿæ¬ /è¿‡é‡‡æ ·</p>
<p>8.ä¸ºä»€ä¹ˆGBDTç²¾åº¦æ¯”å†³ç­–æ ‘é«˜ï¼Ÿ</p>
<h1 id="sql-python">sql &amp; python</h1>
<ol>
<li>
<p>onä½œå’Œwhereæœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ</p>
</li>
<li>
<p>å„ç§ç±»å‹çš„joinæœ‰ä»€ä¹ˆåŒºåˆ«</p>
</li>
<li>
<p>whereå’Œhavingæœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ</p>
</li>
</ol>
<p><a href="https://yangshuyi.xyz/post/sql-li-jie-lei-mian-shi-ti/">ä¸Šé¢çš„å›ç­”åœ¨è¿™é‡Œ</a></p>
<ol start="4">
<li>
<p>ä¸ç”¨ distinct è¯­æ³•æ€ä¹ˆå®ç° å»é‡åŠŸèƒ½ï¼Ÿ</p>
<p>group by <strong>è¡¥å…… distinct  å’Œ group by åœ¨å»é‡æ—¶çš„åŒºåˆ«</strong>ï¼š</p>
<p>â‘ distinct æ˜¯æŠŠå†…å®¹å­˜å‚¨åœ¨hashç»“æ„ï¼Œç„¶åæŠŠ key æ‹¿å‡ºæ¥ï¼Œç©ºé—´æ¢å–æ—¶é—´ ï¼›</p>
<p>â‘¡ group by æ˜¯åˆ†ç»„ç»Ÿè®¡ï¼Œæ—¶é—´æ¢å–ç©ºé—´ï¼›</p>
<p>â‘¢æ•°æ®è¶Šç¦»æ•£ï¼ŒDISTINCT éœ€è¦æ¶ˆè€—çš„ç©ºé—´è¶Šå¤§ï¼Œæ•ˆç‡ä¹Ÿå°±è¶Šä½ã€‚</p>
</li>
<li>
<p>åˆ†å¸ƒå¼é—®é¢˜</p>
<p>æœ‰äº†è§£è¿‡hadoopä¹ˆï¼Ÿ<strong>æ•°æ®å€¾æ–œ</strong>æ—¶å¦‚ä½•å‘ç”Ÿçš„ï¼Ÿ</p>
<p>sparkä¸ºå•¥æ¯”hiveå¿«ï¼Ÿæ‰€æœ‰æ¡ä»¶ä¸‹éƒ½æˆç«‹ä¹ˆï¼Ÿ</p>
<p>æ¯”è¾ƒsparkã€hiveã€MySQLæŸ¥è¯¢çš„åŒºåˆ«</p>
<p>åˆ†å¸ƒå¼äº†è§£å¤šå°‘ï¼Œåšè¿‡çš„åˆ†å¸ƒå¼æˆ–å¤šçº¿ç¨‹ç›¸å…³çš„å—</p>
</li>
<li>
<p>Python</p>
<p>Pythoné‡Œä¸€èˆ¬ç”¨ä»€ä¹ˆåŒ…</p>
<p>pandas: value_counts/duplicated/dropna/shape/apply/<strong>df.groupby(by = æŒ‰æŸåˆ—åˆ†ç»„).agg({&quot;åˆ—å&quot;:&quot;å‡½æ•°&quot;})</strong>/merge</p>
<p>PyODPS: pythonæ‰§è¡Œsqlä»»åŠ¡è¯»å–æ•°æ®</p>
<p>...</p>
</li>
</ol>
<h1 id="ç»Ÿè®¡ç†è®ºæœºå™¨å­¦ä¹ ">ç»Ÿè®¡ç†è®º&amp;æœºå™¨å­¦ä¹ </h1>
<h2 id="abå®éªŒ">ABå®éªŒ</h2>
<pre><code>Â·    1ä¸ºå•¥ç”¨tæ£€éªŒï¼ŸçŸ¥é“å“ªäº›ç»Ÿè®¡å­¦æ£€éªŒï¼Ÿ
Â·    2å¦‚ä½•ç†è§£på€¼
Â·    3å“ªäº›æŒ‡æ ‡ï¼Ÿæœä»ä»€ä¹ˆåˆ†å¸ƒï¼Ÿä¸ºä»€ä¹ˆæœä»ï¼Ÿ
Â·    4æ ·æœ¬é‡æ€ä¹ˆç¡®å®š
Â·    5å®éªŒå¯¹ç…§ç»„æ ·æœ¬æ€ä¹ˆé€‰æ‹©
Â·    6.ç»´åº¦çˆ†ç‚¸æ€ä¹ˆè§£å†³ï¼ˆæ­£äº¤/äº’æ–¥ï¼‰
Â·    7.å¦‚æœå®é™…æƒ…å†µå’Œå®éªŒç»“æœä¸ç¬¦ï¼Œä¸ºä»€ä¹ˆï¼Ÿ
Â·    8.ä¸€èˆ¬æµç¨‹æ€»ç»“
Â·    9.å®éªŒä¸­é‡åˆ°è¿‡ä»€ä¹ˆå›°éš¾ï¼Œæ€ä¹ˆè§£å†³çš„
</code></pre>
<ol>
<li>
<p>Z T å¡æ–¹ Fæ£€éªŒ</p>
</li>
<li>
<p>å‡ºç°æ ·æœ¬è§‚å¯Ÿç»“æœæˆ–è€…æ›´æç«¯çš„æ¦‚ç‡</p>
</li>
<li>
<p>æŒ‡æ ‡åŒ…æ‹¬ gmv äº¤æ˜“é¢ gaap æ¯›åˆ©é¢ ctr ç‚¹å‡»ç‡ã€‚æ¯ä½ç”¨æˆ·å‘¨æœŸå†…çš„ gmv å‘ˆç°å³ååˆ†å¸ƒï¼›åŸå› æ˜¯éƒ¨åˆ†ç”¨æˆ·ï¼ˆæ¯”å¦‚å¤§è¯åº—ï¼‰çš„æç«¯è¡Œä¸ºï¼Œå¦‚å¤§é‡‘é¢è®¢å•ï¼Œç»™å®éªŒçš„è¯„ä»·æŒ‡æ ‡å¸¦æ¥å†³å®šæ€§çš„å˜åŒ–ï¼Œæ‰€ä»¥æœ‰å¿…è¦å¯¹å¼‚å¸¸ç”¨æˆ·çš„æ•°æ®è¿›è¡Œè¿‡æ»¤ã€‚åˆ†å¸ƒå¯ä»¥ç”»ç›´æ–¹å›¾ç®±çº¿å›¾/çœ‹åˆ†ä½ç‚¹/ç­‰è·åˆ†ç®±ç®—æ¯”ä¾‹/åˆ†å¸ƒæ£€éªŒ</p>
</li>
<li>
<p>æ˜¾è‘—æ€§æ°´å¹³0.05ï¼Œéœ€è¦æå‡çš„gmvæ¯”ä¾‹1% åˆ©ç”¨åŒºé—´ä¼°è®¡é‡Œè®¡ç®—æ ·æœ¬é‡çš„å…¬å¼ â€”â€” å¯ç”¨æ¥è®¡ç®—å®éªŒå‘¨æœŸæ•°</p>
</li>
<li>
<p>ç”¨æˆ·ç™»å½•æ¬¡åºåˆ’åˆ†ABABAB...ï¼Œä»è€Œåˆ†ä¸ºABä¸¤ç»„ä½œä¸ºå®éªŒç»„å’Œå¯¹ç…§ç»„ã€‚æ³¨æ„å¿…é¡»ä¿è¯ä¸€ä¸ªç”¨æˆ·ä»…å¤„äºä¸€ä¸ªç»„ï¼Œéœ€è¦å¤„ç†åŒä¸€ç”¨æˆ·æ‹¥æœ‰ä¸åŒè´¦å·çš„é—®é¢˜ï¼ˆåˆ©ç”¨IPåœ°å€ï¼Œè®¾å¤‡ç­‰æ£€æµ‹ï¼‰</p>
</li>
<li>
<p>å®éªŒå’Œå®éªŒä¹‹é—´äº¤å‰ï¼Œç”¨æˆ·åŒæ—¶æ•°æ®å¤šä¸ªå®éªŒï¼Œè¦æ±‚å®éªŒå’Œå®éªŒä¹‹é—´ä¸ä¼šç›¸äº’å½±å“ï¼Œå¯ä»¥ç¼©å°å®éªŒå‘¨æœŸï¼ˆæˆ‘çš„ç®€å•åˆ†æµä¸æ¶‰åŠåˆ°è¿™é‡Œï¼‰</p>
</li>
<li>
<p>â‘ åˆ†æµä¸å‡è¡¡ï¼Œéœ€è¦è¿›è¡Œæœ‰æ•ˆæ€§æ£€éªŒ AA test/ DID â‘¡æ ·æœ¬é‡é—®é¢˜ä¸è¶³ä»¥æ˜¾è‘—  â‘¢æ–°å¥‡æ•ˆåº”ï¼Œå¯ä»¥åªçœ‹æ–°å¢ç”¨æˆ· â‘£è¯•éªŒå‘¨æœŸé€‰æ‹©ï¼Œè€ƒè™‘ç”¨æˆ·æ´»è·ƒé—´éš”æœŸï¼ˆè¿ç»­ä¸¤æ¬¡è´­ä¹°çš„æ—¶é—´é—´éš”ï¼‰ï¼Œä»¥ä¿è¯å®éªŒç»„ç”¨æˆ·éƒ½è¢«ç­–ç•¥è§¦è¾¾</p>
</li>
<li>
<p>ç¡®å®šå®éªŒç›®çš„-å…³é”®æŒ‡æ ‡å’Œè¾…åŠ©æŒ‡æ ‡-ç¡®å®šæ ·æœ¬é‡-æ—¶é—´å‘¨æœŸ-åˆ†æµ-æœ‰æ•ˆæ€§æ£€éªŒ-å¼€å±•è¯•éªŒ-å¼‚å¸¸å¤„ç†-æ£€éªŒ-åˆ†æç»“æœ</p>
</li>
<li>
<p>å›°éš¾</p>
<ul>
<li>â‘ åŒä¸€ç”¨æˆ·çš„ä¸åŒè´¦å·é—®é¢˜ï¼ŒåŒ…æ‹¬è¿é”åº—é—®é¢˜ï¼Œè¿™äº›ç”¨æˆ·ä¹‹é—´æ˜¯ç›¸äº’è”ç³»çš„ï¼Œå¯èƒ½å¯¼è‡´å®éªŒç»„å’Œå¯¹ç…§ç»„ä¸ç‹¬ç«‹ï¼Œå¹¶ä¸”æˆ‘ä»¬ä¸å¸Œæœ›ä»–ä»¬çœ‹åˆ°ä¸åŒçš„ä»·æ ¼ï¼Œæ¶‰åŠåˆ°åˆ†æµçš„å¤„ç†ï¼›</li>
<li>â‘¡è¯•éªŒå‘¨æœŸçš„é€‰æ‹©ï¼ŒæŒ‰ç…§ä»€ä¹ˆå‘¨æœŸå»åŠ æ€»ï¼Œè€ƒè™‘è¿ç»­ä¸¤æ¬¡è´­ä¹°çš„æ—¶é—´é—´éš”ï¼ŒæŒ‰ç…§å‘¨æ¥åŠ æ€»ï¼›</li>
<li>â‘¢å¼‚å¸¸ç”¨æˆ·/å¤§é‡‘é¢è®¢å•çš„è¿‡æ»¤ï¼›</li>
<li>â‘£åˆ©ç”¨DIDæ–¹æ³•å‡å°‘è¶‹åŠ¿æ€§å’Œå‘¨æœŸæ€§æ³¢åŠ¨å½±å“ï¼Œå³ç”¨è¯•éªŒåçš„æ•°æ®-è¯•éªŒå‰çš„æ•°æ®çš„å·®å€¼ä½œä¸ºæ•°æ®ã€‚</li>
</ul>
</li>
</ol>
<h2 id="é¢„å¤„ç†">é¢„å¤„ç†</h2>
<ol>
<li>
<p>åæ€æ•°æ®å¦‚ä½•å¤„ç†ï¼šå˜æ¢/ç¦»æ•£åŒ–/å¼‚å¸¸å€¼ç­›é€‰<a href="https://yangshuyi.xyz/post/di-er-ci-mian-shi-zong-jie/#5-%E5%81%8F%E6%80%81">ä¹‹å‰å†™è¿‡</a></p>
</li>
<li>
<p>ç¼ºå¤±å€¼å¦‚ä½•å¤„ç†ï¼šåˆ é™¤/æ’è¡¥/ç¦»æ•£åŒ–/randomç”Ÿæˆ <a href="https://yangshuyi.xyz/post/di-er-ci-mian-shi-zong-jie/#1%E7%BC%BA%E5%A4%B1%E5%80%BC">ä¹‹å‰å†™è¿‡</a></p>
</li>
</ol>
<h2 id="æœºå™¨å­¦ä¹ ">æœºå™¨å­¦ä¹ </h2>
<p>MAE å’Œ RMSE ä½œä¸ºmetricçš„åº”ç”¨åœºæ™¯æ˜¯ä»€ä¹ˆï¼Ÿ</p>
<p>çŸ¥é“å“ªäº›æ­£åˆ™åŒ–ï¼Ÿ</p>
<p>çŸ¥é“å“ªäº›æŸå¤±å‡½æ•°ï¼Ÿ</p>
<p>K-meansèšç±»è¿‡ç¨‹</p>
<p>éšæœºæ£®æ—çš„éšæœºæ€§ä½“ç°åœ¨ï¼Ÿ</p>
<p>SVMçš„æ ¸å‡½æ•°çš„å®šä¹‰å’Œä½œç”¨ï¼Ÿ</p>
<p>LRå›å½’å…¬å¼çš„æ¨å¯¼</p>
<p>LDAï¼Ÿ</p>
<p>å‘é‡é—´çš„ç›¸ä¼¼æ€§è®¡ç®—æ–¹æ³•</p>
<p>æœ´ç´ è´å¶æ–¯?</p>
<h1 id="ä¸šåŠ¡åˆ†æ">ä¸šåŠ¡åˆ†æ</h1>
<h2 id="1è¯„ä¼°æŸä¸ªæ”¹ç‰ˆ">1.è¯„ä¼°æŸä¸ªæ”¹ç‰ˆ</h2>
<p>æœ‰åœ¨å¾®ä¿¡å†…çœ‹è¿‡å…¬ä¼—å·æ–‡ç« ä¹ˆï¼Ÿå¾®ä¿¡è®¢é˜…å·æ”¹ç‰ˆï¼Œæ–‡ç« åº•éƒ¨æœ‰ç›¸å…³æ–‡ç« æ¨èï¼Œä½ ä¼šæ€ä¹ˆè¯„ä¼°ï¼Ÿ</p>
<p><strong>æ ¸å¿ƒç‚¹ï¼šæ•°æ®åˆ†æï¼ˆè½¬åŒ–ç‡ã€æ ¸å¿ƒæŒ‡æ ‡çš„å˜åŠ¨æƒ…å†µï¼‰+ A/B test</strong></p>
<p>1ã€æ˜¯æ¨èçš„æ•ˆæœã€‚éœ€è¦æ–‡ç« çš„æ›å…‰logï¼Œæ–‡ç« æ›å…‰åçš„ç‚¹å‡»logï¼Œç®€å•è®¡ç®—è½¬åŒ–ç‡ã€‚</p>
<p>2ã€æ˜¯å¤§ç›˜é˜…è¯»æ•ˆæœã€‚éœ€è¦æœ‰A/B testï¼Œå¯¹æ¯”æ— æ¨è/æœ‰æ¨èçš„ç”¨æˆ·ï¼Œæœ€ç»ˆçš„é˜…è¯»é‡æ˜¯å¦æœ‰æ˜æ˜¾å·®å¼‚ã€‚éœ€è¦æœ‰ç”¨æˆ·é˜…è¯»æ–‡ç« çš„logã€‚</p>
<h2 id="2-å¸¸è§æ¨¡å‹">2. å¸¸è§æ¨¡å‹</h2>
<p>AARRRæ¨¡å‹ï¼Ÿ è·å–-æ¿€æ´»ï¼ˆæ´»è·ƒèµ·æ¥ï¼Ÿï¼‰- ç•™å­˜ - è½¬åŒ–æ”¶ç›Š - æ¨èä¼ æ’­</p>
<figure data-type="image" tabindex="1"><img src="http://image.woshipm.com/wp-files/2021/01/DfJRcfxc4mpb0oUqJTT9.png" alt="img" loading="lazy"></figure>
<h2 id="3-æŒ‡æ ‡å˜åŠ¨åˆ†æ">3. æŒ‡æ ‡å˜åŠ¨åˆ†æ</h2>
<p>3.1 å¾®ä¿¡æ”¯ä»˜æŸå¤©çš„æ”¯ä»˜æ€»é‡åŒæ¯”å‘ç”Ÿ5%çš„ä¸‹é™ï¼Œä½ ä¼šæ€ä¹ˆæŸ¥æ‰¾åŸå› ï¼Ÿ</p>
<p><a href="https://yangshuyi.xyz/post/ye-wu-or-zhi-biao-yi-dong-wen-ti/">ä¹‹å‰å†™è¿‡</a></p>
<p>3.2 æ–‡ç« æ¨èè½¬åŒ–ç‡é«˜ï¼Œå¤§ç›˜é˜…è¯»é‡æ²¡æœ‰æå‡æˆ–è€…æœ‰æå‡ï¼Œä½ è§‰å¾—åŸå› æ˜¯ä»€ä¹ˆï¼Ÿ</p>
<p>æŒ‡æ ‡æ‹†è§£ï¼Œé˜…è¯»é‡æ¥è‡ªï¼šè®¢é˜…å…¬ä¼—å·ç‚¹å‡»é‡+æœ‹å‹åœˆæˆ–è€…ç¾¤èŠåˆ†äº«ç‚¹å‡»é‡+æ¨èç‚¹å‡»é‡ï¼Œå¦‚æœæ¨èçš„è½¬åŒ–ç‡é«˜ï¼Œå¯èƒ½æ˜¯ç”¨æˆ·å‡å°‘äº†çœ‹è®¢é˜…åˆ—è¡¨å’Œæœ‹å‹åœˆçš„æ–‡ç« ï¼Œæ¯•ç«Ÿç”¨æˆ·æ—¥å¸¸é˜…è¯»æ—¶é—´æœ‰é™ã€‚</p>
<h2 id="4-è´¹ç±³é—®é¢˜">4. è´¹ç±³é—®é¢˜</h2>
<p>å¦‚ä½•ä¼°è®¡ç™½å¤©æŸä¸ªå°æ—¶æ·±åœ³ç©ºä¸­æœ‰å¤šå°‘é£æœºï¼Ÿ</p>
<ul>
<li>
<p>å‡è®¾æ·±åœ³ä¸€åƒä¸‡ï¼Œæ¯å¤©æ—…å®¢æµé‡å¤§æ¦‚10ä¸‡ï¼Œå‡è®¾æ¯æ¶é£æœºè½½å®¢100äººï¼Œåˆ™æ¯å¤©æœºåœºèµ·é£é™è½1000æ¶é£æœº</p>
</li>
<li>
<p>èˆªç­æ—¶é—´æ—©6-æ™š10ç‚¹ï¼ˆæ¯å¤©16ä¸ªå°æ—¶ï¼‰ï¼Œå‡è®¾é£æœºèµ·é£æˆ–è€…é™è½åœ¨æ·±åœ³åœç•™åŠå°æ—¶</p>
</li>
<li>
<p>é‚£ä¹ˆæ¯ä¸ªå°æ—¶ç©ºä¸­åº”è¯¥æœ‰ 1000 * 0.5 / 16 æ¶é£æœº</p>
</li>
</ul>
<p><a href="https://yangshuyi.xyz/post/fei-mi-wen-ti/">ä¹‹å‰å†™è¿‡</a></p>
<h2 id="5-ç±»ä¼¼äº§å“ç»ç†çš„appè¯„ä»·-åˆ†æç±»é—®é¢˜">5. ç±»ä¼¼äº§å“ç»ç†çš„appè¯„ä»·ã€åˆ†æç±»é—®é¢˜</h2>
<p>æœ‰ä½¿ç”¨è¿‡çŸ­è§†é¢‘ä¹ˆ**ï¼Ÿä»å“ªé‡Œå¯ä»¥è·å¾—æŠ–éŸ³ã€å¿«æ‰‹ã€å¾®ä¿¡è§†é¢‘å·çš„æ•°æ®ï¼Ÿæ€ä¹ˆè¯„ä»·3è€…çš„ç«äº‰ï¼Ÿ**</p>
<p>å¸¸ç”¨APPï¼Ÿå¦‚ä½•ä¼˜åŒ–ï¼Ÿå¦‚ä½•çœ‹ç»“æœï¼Ÿ</p>
<p>å¦‚ä½•æ­å»ºæ ¸å¿ƒæŒ‡æ ‡</p>
<h2 id="6æ•°æ®åˆ†æäº†è§£-è½¬è¡Œ-ä¹¦ç±æ¨èç­‰">6.æ•°æ®åˆ†æäº†è§£ã€è½¬è¡Œã€ä¹¦ç±æ¨èç­‰</h2>
<p>æœ‰çœ‹ä»€ä¹ˆ<a href="https://www.nowcoder.com/jump/super-jump/word?word=%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90">æ•°æ®åˆ†æ</a>çš„ä¹¦ç±ä¹ˆï¼Ÿ</p>
<p>åˆ©ç”¨ python è¿›è¡Œæ•°æ®åˆ†æ Rè¯­è¨€å¯è§†åŒ– ggplolt2 æœºå™¨å­¦ä¹ </p>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[sql åŠ›æ‰£é€Ÿæˆï¼ˆä¸‹ï¼‰]]></title>
        <id>https://yangggshuyi.github.io/post/sql-li-kou-su-cheng-xia/</id>
        <link href="https://yangggshuyi.github.io/post/sql-li-kou-su-cheng-xia/">
        </link>
        <updated>2021-03-16T08:06:11.000Z</updated>
        <summary type="html"><![CDATA[<p>åŠ›æ‰£ sql ä¸­ç­‰&amp;å›°éš¾å®Œæˆæ‰“å¡ ~ ç®€å•é¢˜è¿˜å‰©ä¸€äº›æœ‰ç¼˜å†çœ‹å­ğŸ˜—</p>
]]></summary>
        <content type="html"><![CDATA[<p>åŠ›æ‰£ sql ä¸­ç­‰&amp;å›°éš¾å®Œæˆæ‰“å¡ ~ ç®€å•é¢˜è¿˜å‰©ä¸€äº›æœ‰ç¼˜å†çœ‹å­ğŸ˜—</p>
<!-- more -->
<h1 id="å›°éš¾">å›°éš¾</h1>
<h2 id="1384æŒ‰å¹´åº¦åˆ—å‡ºé”€å”®æ€»é¢">1384.æŒ‰å¹´åº¦åˆ—å‡ºé”€å”®æ€»é¢</h2>
<p>æ¯ä¸ªäº§å“<strong>æ¯å¹´çš„æ€»é”€å”®é¢</strong>ï¼Œå¹¶åŒ…å« product_id, product_name ä»¥åŠ report_year total_amount</p>
<p>é”€å”®å¹´ä»½çš„æ—¥æœŸä»‹äº 2018 å¹´åˆ° 2020 å¹´ä¹‹é—´ã€‚ä½ è¿”å›çš„ç»“æœéœ€è¦æŒ‰ product_id å’Œ report_year æ’åºã€‚</p>
<pre><code class="language-sql">select tmp.product_id, product_name, report_year, average_daily_sales * days as total_amount
from(
    select product_id,
    &quot;2018&quot; as report_year,
    average_daily_sales,
    (case when period_end &gt; &quot;2019-01-01&quot;  
    then datediff(&quot;2019-01-01&quot;, period_start) 
    else datediff(period_end, period_start)+1 end) as days
from sales
where period_start&lt;=&quot;2018-12-31&quot; 
union all
select  product_id,
     &quot;2019&quot; as report_year,
     average_daily_sales,
     (case when period_end&gt;=&quot;2020-01-01&quot; and period_start&lt;&quot;2019-01-01&quot;
     then  datediff(&quot;2020-01-01&quot;, &quot;2019-01-01&quot;) 
     when period_end&gt;=&quot;2020-01-01&quot; and period_start&gt;&quot;2019-01-01&quot;
     then  datediff(&quot;2020-01-01&quot;, period_start) 
     when period_end&lt;&quot;2020-01-01&quot; and period_start&lt;&quot;2019-01-01&quot;
     then  datediff(period_end, &quot;2018-12-31&quot;) 
     when period_end&lt;&quot;2020-01-01&quot; and period_start&gt;&quot;2019-01-01&quot;
     then datediff(period_end, period_start)+1
     else 0 end 
     ) as days
from sales
where period_start&lt;=&quot;2019-12-31&quot; and period_end&gt;=&quot;2019-01-01&quot;
union all
select  product_id,
     &quot;2020&quot; as report_year,
     average_daily_sales,
     (
         case when period_start&lt;&quot;2020-01-01&quot; 
         then datediff(period_end, &quot;2019-12-31&quot;)
         else datediff(period_end, period_start)+1 end
     )as days
from sales
where period_end&gt;=&quot;2020-01-01&quot; 
) tmp
left join Product
on tmp.product_id = Product.product_id
order by tmp.product_id asc, report_year asc;
</code></pre>
<h2 id="1412-æŸ¥æ‰¾æˆç»©å¤„äºä¸­æ¸¸çš„å­¦ç”Ÿ">1412. æŸ¥æ‰¾æˆç»©å¤„äºä¸­æ¸¸çš„å­¦ç”Ÿ</h2>
<p>æˆç»©å¤„äºä¸­æ¸¸çš„å­¦ç”Ÿæ˜¯æŒ‡è‡³å°‘å‚åŠ äº†ä¸€æ¬¡æµ‹éªŒ, ä¸”å¾—åˆ†æ—¢ä¸æ˜¯æœ€é«˜åˆ†ä¹Ÿä¸æ˜¯æœ€ä½åˆ†çš„å­¦ç”Ÿã€‚</p>
<p>å†™ä¸€ä¸ª SQL è¯­å¥ï¼Œæ‰¾å‡ºåœ¨ æ‰€æœ‰ æµ‹éªŒä¸­éƒ½å¤„äºä¸­æ¸¸çš„å­¦ç”Ÿ (student_id, student_name)ã€‚</p>
<p>ä¸è¦è¿”å›ä»æ¥æ²¡æœ‰å‚åŠ è¿‡æµ‹éªŒçš„å­¦ç”Ÿã€‚è¿”å›ç»“æœè¡¨æŒ‰ç…§ student_id æ’åºã€‚</p>
<pre><code class="language-sql">with tmp as(
    select exam_id, student_id,
    rank() over(partition by exam_id order by score asc) rk1,
    rank() over(partition by exam_id order by score desc) rk2
    from Exam
)

select distinct tmp.student_id, student_name
from tmp
left join Student
on tmp.student_id = Student.student_id
where tmp.student_id not in (
    select distinct student_id
    from tmp
    where rk1=1 or rk2=1
)
order by tmp.student_id
</code></pre>
<h2 id="1479å‘¨å†…æ¯å¤©çš„é”€å”®æƒ…å†µ">1479.å‘¨å†…æ¯å¤©çš„é”€å”®æƒ…å†µ</h2>
<p>æŠ¥å‘Š å‘¨å†…æ¯å¤© æ¯ä¸ªå•†å“ç±»åˆ«ä¸‹è®¢è´­äº†å¤šå°‘å•ä½ã€‚è¿”å›ç»“æœè¡¨å• æŒ‰å•†å“ç±»åˆ«æ’åº</p>
<pre><code class="language-sql">select item_category as Category,
    sum(case when date_format(order_date,&quot;%W&quot;)=&quot;Monday&quot;then quantity else 0 end) as Monday,
    sum(case when date_format(order_date,&quot;%W&quot;)=&quot;Tuesday&quot;then quantity else 0 end) as Tuesday,
    sum(case when date_format(order_date,&quot;%W&quot;)=&quot;Wednesday&quot;then quantity else 0 end) as Wednesday,
    sum(case when date_format(order_date,&quot;%W&quot;)=&quot;Thursday&quot;then quantity else 0 end) as Thursday,
    sum(case when date_format(order_date,&quot;%W&quot;)=&quot;Friday&quot;then quantity else 0 end) as Friday,
    sum(case when date_format(order_date,&quot;%W&quot;)=&quot;Saturday&quot;then quantity else 0 end) as Saturday,
    sum(case when date_format(order_date,&quot;%W&quot;)=&quot;Sunday&quot;then quantity else 0 end) as Sunday
from Orders
right join Items
on Orders.item_id = Items.item_id
group by Category
order by Category;
</code></pre>
<h1 id="ä¸­ç­‰">ä¸­ç­‰</h1>
<h2 id="1440-è®¡ç®—å¸ƒå°”è¡¨è¾¾å¼çš„å€¼">1440. è®¡ç®—å¸ƒå°”è¡¨è¾¾å¼çš„å€¼</h2>
<p>ä»¥è®¡ç®—è¡¨ <code>Expressions</code> ä¸­çš„å¸ƒå°”è¡¨è¾¾å¼.</p>
<pre><code class="language-sql">select t1.*, 
    if((case 
            when operator = &quot;&gt;&quot; then t2.value&gt;t3.value
            when operator = &quot;&lt;&quot; then t2.value&lt;t3.value
        else t2.value=t3.value end) = 1,&quot;true&quot;, &quot;false&quot;) as value
from Expressions t1
left join `Variables` t2 on t1.left_operand = t2.`name`
left join `Variables` t3 on t1.right_operand = t3.`name`
</code></pre>
<h2 id="1454è‡³å°‘è¿ç»­-5-å¤©ç™»å½•çš„ç”¨æˆ·å">1454.è‡³å°‘è¿ç»­ 5 å¤©ç™»å½•çš„ç”¨æˆ·å</h2>
<pre><code class="language-sql">select  distinct t2.id, t3.name
from
(
    select id, login_date,
        date_sub(login_date, interval(row_number() over(partition by id order by login_date asc)) day) as date_rn
    from (
        select distinct id, login_date
        from Logins
    ) t1
) t2
left join Accounts t3 on t2.id = t3.id
group by t2.id, date_rn
having count(login_date)&gt;=5
order by t2.id;
</code></pre>
<h2 id="1459-çŸ©å½¢é¢ç§¯">1459. çŸ©å½¢é¢ç§¯</h2>
<p>ç”±è¡¨ä¸­ä»»æ„ä¸¤ç‚¹å¯ä»¥å½¢æˆçš„<strong>æ‰€æœ‰å¯èƒ½çš„çŸ©å½¢</strong>ï¼ˆä»…è€ƒè™‘è¾¹ä¸ x è½´å’Œ y è½´å¹³è¡Œçš„æƒ…å†µï¼‰ã€‚</p>
<p>ç»“æœè¡¨ä¸­çš„æ¯ä¸€è¡ŒåŒ…å«ä¸‰åˆ— (p1, p2, area) å¦‚ä¸‹:</p>
<p>p1 å’Œ p2 æ˜¯<strong>çŸ©å½¢ä¸¤ä¸ªå¯¹è§’çš„ç‚¹çš„ id</strong> ä¸” <strong>p1 &lt; p2</strong><br>
çŸ©å½¢çš„é¢ç§¯ç”±åˆ— area è¡¨ç¤º<br>
è¯·æŒ‰ç…§é¢ç§¯å¤§å°é™åºæ’åˆ—ï¼Œå¦‚æœé¢ç§¯ç›¸åŒçš„è¯, åˆ™æŒ‰ç…§ p1 å’Œ p2 å‡åºå¯¹ç»“æœè¡¨æ’åº</p>
<pre><code class="language-sql">select t1.id as p1, t2.id as p2, abs(t1.x_value-t2.x_value) * abs(t1.y_value-t2.y_value)  as area
from points t1, points t2
where t1.id&lt;t2.id
and  t1.x_value-t2.x_value&lt;&gt;0 
and  t1.y_value-t2.y_value&lt;&gt;0
order by area desc, p1 asc, p2 asc;
</code></pre>
<h2 id="1501å¯ä»¥æ”¾å¿ƒæŠ•èµ„çš„å›½å®¶">1501.å¯ä»¥æ”¾å¿ƒæŠ•èµ„çš„å›½å®¶</h2>
<p>æƒ³è¦æŠ•èµ„çš„å›½å®¶æ˜¯: è¯¥å›½çš„å¹³å‡é€šè¯æ—¶é•¿è¦ä¸¥æ ¼åœ°å¤§äºå…¨çƒå¹³å‡é€šè¯æ—¶é•¿.</p>
<h3 id="å›å¿†-å­—ç¬¦ä¸²å¤„ç†éƒ¨åˆ†å‡½æ•°">å›å¿†: å­—ç¬¦ä¸²å¤„ç†éƒ¨åˆ†å‡½æ•°</h3>
<pre><code class="language-sql">select length('ysy'),
		upper('ysy'),lower('YSy'),

    # æˆªå– åˆ‡ç‰‡(py) / substr(r)
    left('Kindergarten', 4),   # å‰4ä¸ª
    right('Kindergarten', 6),  # å6ä¸ª
    substring('Kindergarten', 3, 2),   # ä»ç¬¬3ä¸ªï¼ˆèµ·å§‹ä½ç½®ï¼‰å¾€åçš„2ä¸ªå­—æ¯
    
    # æ›¿æ¢ replace(py) / gsub(r)
    replace('Kindergarten', 'garten','garden'),
    
    # è¿æ¥ +(py) / paste (r)
    concat('aa','+','bb')   # è¾“å‡ºaa+bb
;
</code></pre>
<pre><code class="language-mysql">select distinct Country.`name` as country
from Calls
left join person
on (Calls.caller_id = Person.id or Calls.callee_id = Person.id)
left join Country on Country.country_code = left(person.phone_number,3)
group by left(phone_number,3)
having avg(duration)&gt;(
    select avg(duration)
    from Calls
)
</code></pre>
<h2 id="1555é“¶è¡Œè´¦æˆ·æ¦‚è¦">1555.é“¶è¡Œè´¦æˆ·æ¦‚è¦</h2>
<p>æŸ¥è¯¢æ¯ä¸ªç”¨æˆ·çš„å½“å‰ä½™é¢ï¼Œå¹¶æ£€æŸ¥ä»–ä»¬æ˜¯å¦å·²é€æ”¯ï¼ˆå½“å‰é¢åº¦å°äº 0ï¼‰</p>
<pre><code class="language-sql">select 
    t3.user_id, 
    user_name, credit1 + sum(ifnull(t4.amount,0)) as credit,
    if(credit1 + sum(ifnull(t4.amount,0))&lt;0,&quot;Yes&quot;,&quot;No&quot;) as credit_limit_breached
from
(
    select t1.user_id, t1.user_name, 
        t1.credit - sum(ifnull(t2.amount,0)) as credit1
    from users t1
    left join transactions t2 on t1.user_id = t2.paid_by
    group by t1.user_id
) t3
left join transactions t4 
on t3.user_id = t4.paid_to
group by t3.user_id
</code></pre>
<h2 id="1613-æ‰¾åˆ°é—å¤±çš„idé€’å½’éœ€å¤ä¹ ">1613. æ‰¾åˆ°é—å¤±çš„IDâ€”â€”é€’å½’ï¼ˆéœ€å¤ä¹ ï¼‰</h2>
<p>é—å¤±çš„é¡¾å®¢idæ˜¯æŒ‡é‚£äº›ä¸åœ¨ Customers è¡¨ä¸­, å€¼å´å¤„äº 1 å’Œè¡¨ä¸­æœ€å¤§ customer_id ä¹‹é—´çš„id.</p>
<pre><code class="language-sql">-- é€’å½’ç”Ÿæˆ1åˆ°100
with recursive t1 as 
(
    select 1 as n
    union all 
    select n+1 from t1 where n &lt; 100)
-- æŒ‰ç…§æ¡ä»¶ç­›é€‰
select n as ids
from t1
where n &gt;=1
and n &lt;= (
    select max(customer_id)
    from Customers
)
and n not in (
    select distinct customer_id
    from Customers
)
order by ids
</code></pre>
<h2 id="1709-è®¿é—®æ—¥æœŸä¹‹é—´çš„æœ€å¤§ç©ºæ¡£æœŸ">1709. è®¿é—®æ—¥æœŸä¹‹é—´çš„æœ€å¤§ç©ºæ¡£æœŸ</h2>
<p>å‡è®¾ä»Šå¤©çš„æ—¥æœŸæ˜¯ '2021-1-1' ã€‚ç¼–å†™ SQL è¯­å¥ï¼Œå¯¹äºæ¯ä¸ª user_id ï¼Œæ±‚å‡ºç›¸é‚»è®¿é—®ï¼ˆè‹¥è¯¥æ¬¡è®¿é—®æ˜¯æœ€åä¸€æ¬¡ï¼Œåˆ™ä¸ºä»Šå¤©ã€è¿™é‡Œæš—ç¤ºè¦ left join ã€‘ï¼‰ä¹‹é—´<strong>æœ€å¤§çš„ç©ºæ¡£æœŸå¤©æ•°</strong> window ã€‚</p>
<pre><code class="language-sql">with tmp as(
    select user_id, visit_date, 
        row_number() over(partition by user_id order by visit_date asc) as rn
    from UserVisits
)

select t1.user_id as user_id,
    max(datediff(ifnull(t2.visit_date,&quot;2021-01-01&quot;), t1.visit_date)) as biggest_window
from tmp t1
left join tmp t2
on t1.user_id = t2.user_id
and t1.visit_date&lt;t2.visit_date
and t1.rn+1 = t2.rn
group by t1.user_id
order by user_id;
</code></pre>
<hr>
<h1 id="ä¸­ç­‰ä¸”æ— èŠ">ä¸­ç­‰ä¸”æ— èŠ</h1>
<p>å‰é¢çš„æ„Ÿè§‰è¿˜ä¸é”™ï¼Œåé¢çš„æ˜¯æ— èŠçš„ä¸­ç­‰é¢˜ï¼š</p>
<h2 id="1468-ç¨åå·¥èµ„">1468. ç¨åå·¥èµ„</h2>
<p>å¦‚æœè¿™ä¸ªå…¬å¸æ‰€æœ‰å‘˜å·¥æœ€é«˜å·¥èµ„ä¸åˆ° 1000 ï¼Œç¨ç‡ä¸º 0%<br>
å¦‚æœè¿™ä¸ªå…¬å¸æ‰€æœ‰å‘˜å·¥æœ€é«˜å·¥èµ„åœ¨ 1000 åˆ° 10000 ä¹‹é—´ï¼Œç¨ç‡ä¸º 24%<br>
å¦‚æœè¿™ä¸ªå…¬å¸æ‰€æœ‰å‘˜å·¥æœ€é«˜å·¥èµ„å¤§äº 10000 ï¼Œç¨ç‡ä¸º 49%<br>
æŒ‰ä»»æ„é¡ºåºè¿”å›ç»“æœï¼Œç¨åå·¥èµ„ç»“æœå–æ•´</p>
<pre><code class="language-sql">select t1.company_id,employee_id, employee_name, round(salary*ratio,0) as salary
from Salaries t1
left join 
(
    select company_id,
        (case 
        when max(salary)&lt;1000 then 1
        when max(salary) between 1000 and 10000 then 1-0.24
        when max(salary) &gt; 10000 then 1-0.49
    else null end) as ratio
    from salaries
    group by company_id
) t2
on t1.company_id  = t2.company_id;
</code></pre>
<h2 id="1532æœ€è¿‘çš„ä¸‰ç¬”è®¢å•">1532.æœ€è¿‘çš„ä¸‰ç¬”è®¢å•</h2>
<p>æ‰¾åˆ°æ¯ä¸ªç”¨æˆ·çš„æœ€è¿‘ä¸‰ç¬”è®¢å•ã€‚å¦‚æœç”¨æˆ·çš„è®¢å•å°‘äº 3 ç¬”ï¼Œåˆ™è¿”å›ä»–çš„å…¨éƒ¨è®¢å•ã€‚</p>
<pre><code class="language-sql">select Customers.`name` as customer_name, t1.customer_id as customer_id, order_id, order_date
from
(
    select customer_id,  order_id, order_date, 
        row_number()over(partition by customer_id order by order_date desc) as rk
    from orders
) t1
left join Customers
on t1.customer_id = Customers.customer_id
where rk&lt;=3
order by customer_name asc, customer_id asc, order_date desc;
</code></pre>
<h2 id="1596-é¡¾å®¢æœ€ç»å¸¸è®¢è´­çš„å•†å“">1596. é¡¾å®¢æœ€ç»å¸¸è®¢è´­çš„å•†å“</h2>
<p>æ‰¾åˆ°æ¯ä¸€ä¸ªé¡¾å®¢æœ€ç»å¸¸è®¢è´­çš„å•†å“ï¼ˆå¯èƒ½ä¸æ­¢ä¸€ç§ï¼‰ã€‚è¡¨å•åº”è¯¥æœ‰æ¯ä¸€ä½è‡³å°‘ä¸‹è¿‡ä¸€æ¬¡å•çš„é¡¾å®¢ customer_id , ä»–æœ€ç»å¸¸è®¢è´­çš„å•†å“çš„ product_id å’Œ product_name</p>
<pre><code class="language-sql">select t1.customer_id, t1.product_id, t2.product_name
from
(
    select customer_id, product_id, count(order_id), 
        rank() over (partition by customer_id order by count(order_id) desc) as rk
    from orders
    group by customer_id, product_id
) t1
left join Products t2 on t1.product_id = t2.product_id
where rk = 1;
</code></pre>
<h2 id=""></h2>
<h2 id="1715-è‹¹æœå’Œæ©˜å­çš„ä¸ªæ•°">1715. è‹¹æœå’Œæ©˜å­çš„ä¸ªæ•°</h2>
<p>æŸ¥è¯¢æ¯ä¸ªå¤§ç®±å­ä¸­è‹¹æœå’Œæ©˜å­çš„ä¸ªæ•°ã€‚å¦‚æœå¤§ç®±å­ä¸­åŒ…å«å°ç›’å­ï¼Œè¿˜åº”å½“åŒ…å«å°ç›’å­ä¸­è‹¹æœå’Œæ©˜å­çš„ä¸ªæ•°ã€‚</p>
<pre><code class="language-sql">select sum(ifnull(boxes.apple_count,0))+sum(ifnull(chests.apple_count,0)) as apple_count,
    sum(ifnull(boxes.orange_count,0))+sum(ifnull(chests.orange_count,0)) as orange_count
from boxes 
left join chests
on boxes.chest_id = chests.chest_id
</code></pre>
<h2 id="1699ä¸¤äººçš„é€šè¯æ¬¡æ•°">1699.ä¸¤äººçš„é€šè¯æ¬¡æ•°</h2>
<p>æŸ¥è¯¢æ¯ä¸€å¯¹ç”¨æˆ· <code>(person1, person2)</code> ä¹‹é—´çš„é€šè¯æ¬¡æ•°å’Œé€šè¯æ€»æ—¶é•¿ï¼Œå…¶ä¸­ <code>person1 &lt; person2</code> ã€‚</p>
<pre><code class="language-sql">select person1, person2, count(1) as call_count, sum(duration) as total_duration
from (
    select 
        if(from_id&lt;to_id, from_id, to_id) as person1,
        if(from_id&lt;to_id, to_id, from_id) as person2,
        duration
    from Calls
) tmp 
group by person1, person2
</code></pre>
<h2 id="1549-æ¯ä»¶å•†å“çš„æœ€æ–°è®¢å•">1549. æ¯ä»¶å•†å“çš„æœ€æ–°è®¢å•</h2>
<pre><code class="language-sql">SELECT product_name, t.product_id, order_id, order_date
FROM(
    SELECT *, rank() OVER(PARTITION BY product_id ORDER BY order_date DESC) AS rk 
    FROM Orders
) t LEFT JOIN Products p USING(product_id)
WHERE rk = 1
ORDER BY product_name, product_id, order_id
</code></pre>
<h2 id="1445-è‹¹æœ-å’Œ-æ¡”å­">1445. <strong>è‹¹æœ</strong> å’Œ æ¡”å­</h2>
<p>æŠ¥å‘Šæ¯ä¸€å¤© <strong>è‹¹æœ</strong> å’Œ <strong>æ¡”å­</strong> é”€å”®çš„æ•°ç›®çš„å·®å¼‚.</p>
<pre><code class="language-sql">select sale_date, 
    sum(case when fruit=&quot;apples&quot; then sold_num else 0 end) - sum(case when fruit=&quot;oranges&quot; then sold_num else 0 end) as diff
from Sales
group by sale_date
order by sale_date
</code></pre>
<h2 id="1398è´­ä¹°äº†-a-b-å´æ²¡æœ‰ä¹°-c">1398.è´­ä¹°äº† A  B å´æ²¡æœ‰ä¹° C</h2>
<pre><code class="language-sql">SELECT customer_id,customer_name 
FROM Customers 
WHERE 
customer_id IN(SELECT customer_id FROM Orders WHERE product_name='A') 
AND 
customer_id IN(SELECT customer_id FROM Orders WHERE product_name='B') 
AND 
customer_id NOT IN(SELECT customer_id FROM Orders WHERE product_name='C')
</code></pre>
<h2 id="1393-è‚¡ç¥¨æŸç›Š">1393. è‚¡ç¥¨æŸç›Š</h2>
<p>ç¼–å†™ä¸€ä¸ªSQLæŸ¥è¯¢æ¥æŠ¥å‘Šæ¯æ”¯è‚¡ç¥¨çš„èµ„æœ¬æŸç›Šã€‚</p>
<p>è‚¡ç¥¨çš„èµ„æœ¬æŸç›Šæ˜¯ä¸€æ¬¡æˆ–å¤šæ¬¡ä¹°å–è‚¡ç¥¨åçš„å…¨éƒ¨æ”¶ç›Šæˆ–æŸå¤±ã€‚</p>
<p>ä»¥ä»»æ„é¡ºåºè¿”å›ç»“æœå³å¯ã€‚</p>
<pre><code class="language-sql">with tmp as(
  select stock_name, operation, price,
		row_number()over(partition by stock_name order by operation_day) as rn
	from stocks
)
select t1.stock_name, sum(t2.price - t1.price) as capital_gain_loss
from tmp t1, tmp t2
where t1.stock_name = t2.stock_name
and t1.operation = &quot;buy&quot; 
and t2.operation = &quot;sell&quot;
and t1.rn+1 = t2.rn
group by t1.stock_name
</code></pre>
<h2 id="1421å‡€ç°å€¼æŸ¥è¯¢">1421.å‡€ç°å€¼æŸ¥è¯¢</h2>
<p>æ‰¾åˆ° Queries è¡¨ä¸­æ¯ä¸€æ¬¡æŸ¥è¯¢çš„å‡€ç°å€¼.</p>
<pre><code class="language-sql">select q.id,q.year,ifnull(n.npv,0) npv 
from queries q left join npv n
on q.id=n.id and q.year=n.year
</code></pre>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[sql åŠ›æ‰£é€Ÿæˆï¼ˆä¸Šï¼‰]]></title>
        <id>https://yangggshuyi.github.io/post/sql-li-kou-su-cheng-shang/</id>
        <link href="https://yangggshuyi.github.io/post/sql-li-kou-su-cheng-shang/">
        </link>
        <updated>2021-03-15T13:05:43.000Z</updated>
        <summary type="html"><![CDATA[<p>ä»»åŠ¡å®Œæˆäº†ä½†ä¹ŸçœŸå­¦åˆ°æ¶å¿ƒäº†ï¼Œéš¾è¿‡ğŸ™ƒ</p>
<figure data-type="image" tabindex="1"><img src="https://yangggshuyi.github.io/post-images/1615860345036.jpg" alt="" loading="lazy"></figure>
]]></summary>
        <content type="html"><![CDATA[<p>ä»»åŠ¡å®Œæˆäº†ä½†ä¹ŸçœŸå­¦åˆ°æ¶å¿ƒäº†ï¼Œéš¾è¿‡ğŸ™ƒ</p>
<figure data-type="image" tabindex="1"><img src="https://yangggshuyi.github.io/post-images/1615860345036.jpg" alt="" loading="lazy"></figure>
<!-- more -->
<p>é™„è¿‘æ—¥æ„Ÿå—ï¼š</p>
<ol>
<li>
<p>è§‰å¾—æŸäººç›´ç”·/ç›´å¥³ç™Œ/æ— æ³•äº¤æµ/ä¸èƒ½ç†è§£çš„æ—¶å€™ï¼Œå…¶å®å¯¹æ–¹æœ‰å’Œä»–é¡ºåˆ©äº¤æµçš„äººï¼Œåªä¸è¿‡ä¸æ˜¯ä½ /æ²¡æŠŠä½ å½“ä»–æœ‹å‹/æ‡’å¾—è€ƒè™‘ä½ /è®¨åŒä½ ç½¢äº†ã€‚</p>
</li>
<li>
<p>å¿ƒé‡Œä¸Šæ”¾æ¾å’Œè¡ŒåŠ¨ä¸Šè®¤çœŸæœ‰å¯èƒ½å…¼å¤‡</p>
</li>
</ol>
<p>ä¸‹é¢æ˜¯é‡åˆ°çš„ä¸­ç­‰&amp;å›°éš¾é¢˜ï¼š</p>
<h1 id="262-è¡Œç¨‹å’Œç”¨æˆ·-éœ€å¤ä¹ ">262. è¡Œç¨‹å’Œç”¨æˆ· ï¼ˆéœ€å¤ä¹ ï¼‰</h1>
<p>å†™ä¸€æ®µ SQL è¯­å¥æŸ¥å‡º &quot;2013-10-01&quot; è‡³ &quot;2013-10-03&quot; æœŸé—´<strong>éç¦æ­¢ç”¨æˆ·</strong>ï¼ˆä¹˜å®¢å’Œå¸æœºéƒ½å¿…é¡»æœªè¢«ç¦æ­¢ï¼‰çš„å–æ¶ˆç‡ã€‚å–æ¶ˆç‡çš„è®¡ç®—æ–¹å¼å¦‚ä¸‹ï¼š<strong>(è¢«å¸æœºæˆ–ä¹˜å®¢å–æ¶ˆçš„éç¦æ­¢ç”¨æˆ·ç”Ÿæˆçš„è®¢å•æ•°é‡) / (éç¦æ­¢ç”¨æˆ·ç”Ÿæˆçš„è®¢å•æ€»æ•°)</strong>ã€‚è¿”å›ç»“æœè¡¨ä¸­çš„æ•°æ®å¯ä»¥æŒ‰ä»»æ„é¡ºåºç»„ç»‡ã€‚å…¶ä¸­å–æ¶ˆç‡ Cancellation Rate éœ€è¦å››èˆäº”å…¥ä¿ç•™ ä¸¤ä½å°æ•° ã€‚</p>
<p>æ³¨æ„ä¹˜å®¢å’Œå¸æœºéƒ½å¿…é¡»æœªè¢«ç¦æ­¢ï¼Œè¿™é‡Œ  Users.Banned = &quot;no&quot; ç›¸å½“äºå¤„ç†äº†ä¹˜å®¢æˆ–è€…å¸æœºæœªè¢«ç¦æ­¢ã€‚</p>
<pre><code class="language-sql">-- é”™è¯¯è§£ç­”
select trips.request_at as æ—¥æœŸ, 
	count(distinct (case when Status in (&quot;cancelled_by_driver&quot;, &quot;cancelled_by_client&quot;) then trips.id else full end))/count(distinct trips.id) as å½“æ—¥å–æ¶ˆç‡
from Trips 
left join Users 
on (trips.Client_Id  = Users.Users_Id or trips.Driver_Id  = Users.Users_Id)
and Users.Banned = &quot;no&quot;
group by trips.request_at;

-- æ­£ç¡®è§£ç­”ï¼š
-- æ–¹æ³•ä¸€éœ€è¦ä¸¤æ¬¡joinï¼›æ–¹æ³•äºŒå¯¹cliend_idå’Œdriver_idéƒ½åšå‰”é™¤
select Request_at as `Day`, 
    round(count(distinct (case when Status in (&quot;cancelled_by_driver&quot;, &quot;cancelled_by_client&quot;) then t1.id else null end)) / count(distinct t1.id),2) as `Cancellation Rate`
from trips t1
inner join Users t2 on t1.Client_Id = t2.users_id
inner join users t3 on t1.driver_id = t3.users_id
and t1.Request_at between &quot;2013-10-01&quot; and &quot;2013-10-03&quot;
and t2.banned = &quot;No&quot; and t3.banned = &quot;No&quot; 
group by t1.Request_at;
</code></pre>
<h1 id="534æ¸¸æˆç©æ³•åˆ†æ">534.æ¸¸æˆç©æ³•åˆ†æ</h1>
<p>ç¼–å†™ä¸€ä¸ª SQL æŸ¥è¯¢ï¼ŒåŒæ—¶æŠ¥å‘Šæ¯ç»„ç©å®¶å’Œæ—¥æœŸï¼Œä»¥åŠç©å®¶åœ¨æ­¤æ—¥æœŸä¹‹å‰ç©å®¶æ‰€ç©çš„æ¸¸æˆæ€»æ•°ã€‚</p>
<p>-- ç´¯è®¡æ±‚å’Œé—®é¢˜</p>
<pre><code class="language-sql">select player_id, event_date,
	sum(games_played) over(partition by player_id order by event_date asc) as games_played_so_far
from Activity
order by player_id asc, event_date asc;
</code></pre>
<h1 id="550æ¸¸æˆç©æ³•åˆ†æ">550.æ¸¸æˆç©æ³•åˆ†æ</h1>
<p>ç¼–å†™ä¸€ä¸ª SQL æŸ¥è¯¢ï¼ŒæŠ¥å‘Šåœ¨é¦–æ¬¡ç™»å½•çš„<strong>ç¬¬äºŒå¤©å†æ¬¡ç™»å½•</strong>çš„ç©å®¶çš„æ¯”ç‡ï¼Œå››èˆäº”å…¥åˆ°å°æ•°ç‚¹åä¸¤ä½ã€‚æ¢å¥è¯è¯´ï¼Œæ‚¨éœ€è¦è®¡ç®—ä»é¦–æ¬¡ç™»å½•æ—¥æœŸå¼€å§‹è‡³å°‘è¿ç»­ä¸¤å¤©ç™»å½•çš„ç©å®¶çš„æ•°é‡ï¼Œç„¶åé™¤ä»¥ç©å®¶æ€»æ•°ã€‚</p>
<pre><code class="language-sql">select round(count(distinct t2.player_id) / count(distinct t1.player_id), 2) as fraction
from (
  select player_id, min(event_date) as event_date
  from Activity
  group by player_id
) t1
left join 
(
  select distinct player_id,event_date -- ä¹ æƒ¯å…ˆå»é‡
  from Activity
  group by player_id,event_date
)t2
on t1.player_id = t2.player_id
and datediff(t2.event_date, t1.event_date) = 1  -- t2-t1=1;
</code></pre>
<h1 id="569-å‘˜å·¥è–ªæ°´ä¸­ä½æ•°">569. å‘˜å·¥è–ªæ°´ä¸­ä½æ•°</h1>
<p><code>Employee</code> è¡¨æœ‰ä¸‰åˆ—ï¼šå‘˜å·¥Idï¼Œå…¬å¸åå’Œè–ªæ°´ã€‚è¯·ç¼–å†™SQLæŸ¥è¯¢æ¥æŸ¥æ‰¾æ¯ä¸ªå…¬å¸çš„è–ªæ°´ä¸­ä½æ•°ã€‚æŒ‘æˆ˜ç‚¹ï¼šä½ æ˜¯å¦å¯ä»¥åœ¨ä¸ä½¿ç”¨ä»»ä½•å†…ç½®çš„SQLå‡½æ•°çš„æƒ…å†µä¸‹è§£å†³æ­¤é—®é¢˜ã€‚</p>
<p>N å¥‡æ•°ï¼šn+1/2ï¼Œå¶æ•° n/2 n/2+1 â€”â€”å¯¹æ‰€æœ‰n/2åˆ°n/2+1çš„æ•°å­—æ±‚å¹³å‡å³å¯ï¼ˆå®é™…è¿™é“é¢˜ä¸éœ€è¦æ±‚avgï¼‰</p>
<pre><code class="language-sql">select t1.company, avg(salary)
from(
  select company, salary, row_number() over (partition by company order by salary asc) as rk
	from employee
)t1
left join 
(
  select company, count(id) as num
	from employee
 	group by company
)t2
on t1.company = t2.company
where t1.rk between t2.num/2 and (t2.num/2 +1)
group by t1.company;
</code></pre>
<h1 id="570è‡³å°‘æœ‰5åç›´æ¥ä¸‹å±çš„ç»ç†">570.è‡³å°‘æœ‰5åç›´æ¥ä¸‹å±çš„ç»ç†</h1>
<p>ç»™å®š <code>Employee</code> è¡¨ï¼Œè¯·ç¼–å†™ä¸€ä¸ªSQLæŸ¥è¯¢æ¥æŸ¥æ‰¾è‡³å°‘æœ‰5åç›´æ¥ä¸‹å±çš„ç»ç†ã€‚å¯¹äºä¸Šè¡¨ï¼Œæ‚¨çš„SQLæŸ¥è¯¢åº”è¯¥è¿”å›ï¼š</p>
<pre><code class="language-sql">select `name`
from(
  select t1.id as id, t1.`name` as `name`, count(distinct t2.id) as num
  from Employee t1
  left join Employee t2
  on t1.id = t2.ManagerId
  group by t1.id,t1.`name`
) tmp
where num&gt;=5;
</code></pre>
<h1 id="571ç»™å®šæ•°å­—çš„é¢‘ç‡æŸ¥è¯¢ä¸­ä½æ•°-éœ€å¤ä¹ ">571.ç»™å®šæ•°å­—çš„é¢‘ç‡æŸ¥è¯¢ä¸­ä½æ•° ï¼ˆéœ€å¤ä¹ ï¼‰</h1>
<p><code>Numbers</code> è¡¨ä¿å­˜æ•°å­—çš„å€¼åŠå…¶é¢‘ç‡ï¼Œè¯·ç¼–å†™ä¸€ä¸ªæŸ¥è¯¢æ¥æŸ¥æ‰¾æ‰€æœ‰æ•°å­—çš„ä¸­ä½æ•°å¹¶å°†ç»“æœå‘½åä¸º <code>median</code></p>
<p>å½“æŸä¸€æ•°å­—çš„ <strong>æ­£åºå’Œé€†åºç´¯è®¡</strong> å‡å¤§äº <strong>æ•´ä¸ªåºåˆ—çš„æ•°å­—ä¸ªæ•°çš„ä¸€åŠ</strong> æ—¶å³ä¸ºä¸­ä½æ•°</p>
<pre><code class="language-sql">select avg(number) as median
from (
  select number, 
    sum(frequency) over(order by number asc) as freq1,
    sum(frequency) over(order by number desc) as freq2
  from numbers
) t1,
(
  select sum(frequency)*0.5 as num
	from numbers
)  t2
where freq1&gt;= num and freq2&gt;= num ;
</code></pre>
<h1 id="574å½“é€‰è€…">574.å½“é€‰è€…</h1>
<pre><code class="language-sql">select Name from Candidate
where id = (
    select CandidateId from Vote
    group by CandidateId
    order by count(id) desc
    limit 1
);
</code></pre>
<h1 id="578æŸ¥è¯¢å›ç­”ç‡æœ€é«˜çš„é—®é¢˜">578.æŸ¥è¯¢å›ç­”ç‡æœ€é«˜çš„é—®é¢˜</h1>
<p>å›ç­”ç‡ï¼šå›ç­”æ•°å æ˜¾ç¤ºæ•°çš„æ¯”ä¾‹</p>
<pre><code class="language-sql">select question_id as survey_log
from(
    select question_id,
        count(case when action = 'answer' then question_id else null end) / count(case when action = 'show' then question_id else null end)  as å›ç­”ç‡
    from survey_log
    group by question_id
    order by å›ç­”ç‡ desc
    limit 1
) tmp;
</code></pre>
<h1 id="579æŸ¥è¯¢å‘˜å·¥çš„ç´¯è®¡è–ªæ°´">579.æŸ¥è¯¢å‘˜å·¥çš„ç´¯è®¡è–ªæ°´</h1>
<p>è¯·ä½ ç¼–å†™ SQL è¯­å¥ï¼Œå¯¹äºæ¯ä¸ªå‘˜å·¥ï¼ŒæŸ¥è¯¢ä»–é™¤æœ€è¿‘ä¸€ä¸ªæœˆï¼ˆå³æœ€å¤§æœˆï¼‰ä¹‹å¤–ï¼Œå‰©ä¸‹æ¯ä¸ªæœˆçš„è¿‘ä¸‰ä¸ªæœˆçš„ç´¯è®¡è–ªæ°´ï¼ˆä¸è¶³ä¸‰ä¸ªæœˆä¹Ÿè¦è®¡ç®—ï¼‰ã€‚</p>
<p>ç»“æœè¯·æŒ‰ Id å‡åºï¼Œç„¶åæŒ‰ Month é™åºæ˜¾ç¤ºã€‚</p>
<pre><code class="language-sql">select id, `month`, salary
from
(
  select t1.id,
		t2.`month`, 
  	sum(case when t1.`month` &gt; t2.`month`-3 and t1.`month` &lt;= t2.`month` then t1.salary else 0 end) as salary,
  	row_number() over(partition by t1.id order by t2.`month` desc) as rk
  from Employee t1
  left join  Employee t2
  on t1.id = t2.id 
  group by t1.id, t2.`month`
) tmp
where rk &gt; 1;
</code></pre>
<h1 id="580-ç»Ÿè®¡ä¸“ä¸šå­¦ç”Ÿäººæ•°">580. ç»Ÿè®¡ä¸“ä¸šå­¦ç”Ÿäººæ•°</h1>
<p>å†™ä¸€ä¸ªæŸ¥è¯¢è¯­å¥ï¼ŒæŸ¥è¯¢ <em><strong>department</strong></em> è¡¨ä¸­æ¯ä¸ªä¸“ä¸šçš„å­¦ç”Ÿäººæ•° ï¼ˆå³ä½¿æ²¡æœ‰å­¦ç”Ÿçš„ä¸“ä¸šä¹Ÿéœ€åˆ—å‡ºï¼‰ã€‚æŸ¥è¯¢ç»“æœæŒ‰ç…§å­¦ç”Ÿäººæ•°é™åºæ’åˆ—ã€‚</p>
<pre><code class="language-sql">select t1.dept_name,
	(case when t2.num is null then 0 else t2.num end) as student_number
from department t1
left join 
(
  select dept_id, count(student_id) as num
  from student
  group by dept_id
) t2
on t1.dept_id = t2.dept_id
order by num desc;
</code></pre>
<h1 id="585-æŠ•èµ„é‡‘é¢">585. æŠ•èµ„é‡‘é¢</h1>
<p>å†™ä¸€ä¸ªæŸ¥è¯¢è¯­å¥ï¼Œå°† 2016 å¹´ (TIV_2016) æ‰€æœ‰æˆåŠŸæŠ•èµ„çš„é‡‘é¢åŠ èµ·æ¥ï¼Œä¿ç•™ 2 ä½å°æ•°ã€‚</p>
<p>1.ä»–åœ¨ 2015 å¹´çš„æŠ•ä¿é¢ (TIV_2015) è‡³å°‘è·Ÿä¸€ä¸ªå…¶ä»–æŠ•ä¿äººåœ¨ 2015 å¹´çš„æŠ•ä¿é¢ç›¸åŒã€‚2.ä»–æ‰€åœ¨çš„åŸå¸‚å¿…é¡»ä¸å…¶ä»–æŠ•ä¿äººéƒ½ä¸åŒï¼ˆä¹Ÿå°±æ˜¯è¯´ç»´åº¦å’Œç»åº¦ä¸èƒ½è·Ÿå…¶ä»–ä»»ä½•ä¸€ä¸ªæŠ•ä¿äººå®Œå…¨ç›¸åŒï¼‰ã€‚</p>
<p><strong>concat</strong>(a,b) ï¼ŒåŒæ—¶åŒ¹é…ç»çº¬åº¦æ›´åˆç†</p>
<pre><code class="language-sql">select sum(TIV_2016) as TIV_2016
from insurance
where concat(lat,lon) in (
    select concat(lat,lon)
    from insurance
    group by concat(lat,lon)
    having count(pid)=1 
)
and TIV_2015 in (
    select distinct TIV_2015
    from insurance
    group by TIV_2015
    having count(pid)&gt;1
);
</code></pre>
<h1 id="601-ä½“è‚²é¦†çš„äººæµé‡">601. ä½“è‚²é¦†çš„äººæµé‡</h1>
<p>ç¼–å†™ä¸€ä¸ª SQL æŸ¥è¯¢ä»¥æ‰¾å‡ºæ¯è¡Œçš„äººæ•°å¤§äºæˆ–ç­‰äº <code>100</code> ä¸” <code>id</code> è¿ç»­çš„ä¸‰è¡Œæˆ–æ›´å¤šè¡Œè®°å½•ã€‚</p>
<pre><code class="language-sql">select t1.*
from Stadium t1
,
(
    select id as start_id, id+count(rk)-1 as end_id
    from(
        select row_number()over(order by visit_date asc) as rk, visit_date,id
        from Stadium
        where people&gt;=100
    ) tmp
    group by id-rk
    having count(rk)&gt;=3
) t2
where  (t1.id&gt;=t2.start_id and  t1.id&lt;=t2.end_id)
</code></pre>
<h1 id="602å¥½å‹ç”³è¯·">602.å¥½å‹ç”³è¯·</h1>
<p>è¡¨ <code>request_accepted</code> å­˜å‚¨äº†æ‰€æœ‰å¥½å‹ç”³è¯·é€šè¿‡çš„æ•°æ®è®°å½•ã€‚å†™ä¸€ä¸ªæŸ¥è¯¢è¯­å¥ï¼Œæ±‚å‡ºè°æ‹¥æœ‰æœ€å¤šçš„å¥½å‹å’Œä»–æ‹¥æœ‰çš„å¥½å‹æ•°ç›®ã€‚å¥½å‹ç”³è¯·åªä¼šè¢«æ¥å—ä¸€æ¬¡ï¼Œæ‰€ä»¥ä¸ä¼šæœ‰ requester_id å’Œ accepter_id å€¼éƒ½ç›¸åŒçš„é‡å¤è®°å½•ã€‚</p>
<p><strong>Union all ä¸åˆå¹¶é‡å¤è¡Œ</strong></p>
<pre><code class="language-sql">select id, sum(friend) as num
from
(
    select requester_id as id, count(requester_id) as friend
    from request_accepted
    group by requester_id
    union all
    select accepter_id as id, count(accepter_id) as friend
    from request_accepted
    group by accepter_id
) tmp
group by id
order by num desc
limit 1;
</code></pre>
<h1 id="608æ ‘èŠ‚ç‚¹">608.æ ‘èŠ‚ç‚¹</h1>
<p>ç»™å®šä¸€ä¸ªè¡¨ <code>tree</code>ï¼Œid æ˜¯æ ‘èŠ‚ç‚¹çš„ç¼–å·ï¼Œ p_id æ˜¯å®ƒçˆ¶èŠ‚ç‚¹çš„ id ã€‚æ ‘ä¸­æ¯ä¸ªèŠ‚ç‚¹å±äºä»¥ä¸‹ä¸‰ç§ç±»å‹ä¹‹ä¸€ï¼šå¶ã€æ ¹ã€å†…éƒ¨èŠ‚ç‚¹ã€‚å†™ä¸€ä¸ªæŸ¥è¯¢è¯­å¥ï¼Œè¾“å‡ºæ‰€æœ‰èŠ‚ç‚¹çš„ç¼–å·å’ŒèŠ‚ç‚¹çš„ç±»å‹ï¼Œå¹¶å°†ç»“æœæŒ‰ç…§èŠ‚ç‚¹ç¼–å·æ’åºã€‚</p>
<pre><code class="language-sql">select distinct t1.id,
	(case 
   	when t2.id is null and t1.p_id is not null then &quot;Leaf&quot;
  	when t1.p_id is null then &quot;Root&quot;
  else &quot;Inner&quot; end) as `Type`
from tree t1
left join tree t2
on t2.p_id = t1.id;
</code></pre>
<h1 id="612å¹³é¢ä¸Šçš„æœ€è¿‘è·ç¦»">612.å¹³é¢ä¸Šçš„æœ€è¿‘è·ç¦»</h1>
<p>è¡¨ <code>point_2d</code> ä¿å­˜äº†æ‰€æœ‰ç‚¹ï¼ˆå¤šäº 2 ä¸ªç‚¹ï¼‰çš„åæ ‡ (x,y) ï¼Œè¿™äº›ç‚¹åœ¨å¹³é¢ä¸Šä¸¤ä¸¤ä¸é‡åˆã€‚</p>
<p>å†™ä¸€ä¸ªæŸ¥è¯¢è¯­å¥æ‰¾åˆ°ä¸¤ç‚¹ä¹‹é—´çš„æœ€è¿‘è·ç¦»ï¼Œä¿ç•™ 2 ä½å°æ•°ã€‚</p>
<pre><code class="language-sql">select round(sqrt(min(dist)),2) as shortest
from  
(
  select distinct (t1.x-t2.x)*(t1.x-t2.x)+(t1.y-t2.y)*(t1.y-t2.y) as dist
  from point_2d t1, point_2d t2
) tmp
where dist&gt;0;
</code></pre>
<h1 id="614äºŒçº§å…³æ³¨è€…">614.äºŒçº§å…³æ³¨è€…</h1>
<p>è¡¨ <code>follow</code> ä¼šæœ‰ 2 ä¸ªå­—æ®µï¼š followeeï¼Œfollowerã€‚å¯¹æ¯ä¸€ä¸ªå…³æ³¨è€…ï¼ŒæŸ¥è¯¢å…³æ³¨ä»–çš„å…³æ³¨è€…çš„æ•°ç›®</p>
<pre><code class="language-sql">select t1.follower, count(distinct t2.follower) as num
from follow t1
left join follow t2
on t1.follower = t2.followee
group by t1.follower
having count(distinct t2.follower) &gt;0;
</code></pre>
<h1 id="615å¹³å‡å·¥èµ„éƒ¨é—¨ä¸å…¬å¸æ¯”è¾ƒ">615.å¹³å‡å·¥èµ„ï¼šéƒ¨é—¨ä¸å…¬å¸æ¯”è¾ƒ</h1>
<p>åœ¨æ¯ä¸€ä¸ªå·¥èµ„å‘æ”¾æ—¥ï¼Œéƒ¨é—¨å¹³å‡å·¥èµ„ä¸å…¬å¸å¹³å‡å·¥èµ„çš„æ¯”è¾ƒç»“æœ ï¼ˆé«˜ / ä½ / ç›¸åŒï¼‰ã€‚</p>
<pre><code class="language-sql">select a.pay_month, department_id,
    (case when avg_dep&gt;avg_comp then &quot;higher&quot;
        when avg_dep=avg_comp then &quot;same&quot;
        else &quot;lower&quot; 
    end) as comparison
from
(
  select date_format(t1.pay_date, &quot;%Y-%m&quot;) as pay_month, t2.department_id, avg(t1.amount) as avg_dep
  from salary t1
  inner join employee t2
  on t1.employee_id = t2.employee_id
  group by date_format(t1.pay_date,&quot;%Y-%m&quot;), t2.department_id
) a
,
(
  select date_format(pay_date,&quot;%Y-%m&quot;) as pay_month, avg(amount) as avg_comp
  from salary 
  group by date_format(pay_date,&quot;%Y-%m&quot;) 
) b
where a.pay_month = b.pay_month;
</code></pre>
<h1 id="618å­¦ç”Ÿåœ°ç†ä¿¡æ¯æŠ¥å‘Šéœ€å¤ä¹ ">618.å­¦ç”Ÿåœ°ç†ä¿¡æ¯æŠ¥å‘Šï¼ˆéœ€å¤ä¹ ï¼‰</h1>
<p>é•¿è¡¨å˜å®½è¡¨ï¼Œå®ç°åˆ—çš„é€è§†è¡¨æ“ä½œï¼Œä½¿å¾—æ¯ä¸ªå­¦ç”ŸæŒ‰ç…§å§“åçš„å­—æ¯é¡ºåºä¾æ¬¡æ’åˆ—åœ¨å¯¹åº”çš„å¤§æ´²ä¸‹é¢ã€‚è¾“å‡ºçš„æ ‡é¢˜åº”ä¾æ¬¡ä¸ºç¾æ´²ï¼ˆAmericaï¼‰ã€äºšæ´²ï¼ˆAsiaï¼‰å’Œæ¬§æ´²ï¼ˆEuropeï¼‰:</p>
<table>
<thead>
<tr>
<th>America</th>
<th>Asia</th>
<th>Europe</th>
</tr>
</thead>
<tbody>
<tr>
<td>Jack</td>
<td>Xi</td>
<td>Pascal</td>
</tr>
<tr>
<td>Jane</td>
<td></td>
<td></td>
</tr>
</tbody>
</table>
<pre><code class="language-sql">-- é”™è¯¯è§£ç­”
with tmp as(
select `name`, continent,
    row_number()over(partition by continent order by `name`) as rk
from student
)
select t1.name,t2.name,t3.name
from tmp t1, tmp t2, tmp t3
where t1.rk = t2.rk and t2.rk = t3.rk
and t1.continent = &quot;America&quot; 
and t2.continent = &quot;Asia&quot; 
and t3.continent = &quot;Europe&quot;;


-- æ­£ç¡®è§£ç­”(maxå‡½æ•°å¯ä»¥ä»nullå’Œénullä¸­å–å‡ºéNull)
SELECT
    MAX(IF(continent = 'America', name, NULL)) America,
    MAX(IF(continent = 'Asia', name, NULL)) Asia,
    MAX(IF(continent = 'Europe', name, NULL)) Europe
FROM 
(
  select `name`, continent,
  	row_number()over(partition by continent order by `name`) as rk
	from student
) tmp
GROUP BY rk;
</code></pre>
<h1 id="626æ¢åº§ä½">626.æ¢åº§ä½</h1>
<p>çºµåˆ—çš„ <strong>id</strong> æ˜¯è¿ç»­é€’å¢çš„ï¼Œæƒ³æ”¹å˜ç›¸é‚»ä¿©å­¦ç”Ÿçš„åº§ä½ã€‚å³12äº¤æ¢ 34äº¤æ¢ã€‚ã€‚ã€‚</p>
<pre><code class="language-sql">select id,
    (case  
        when (id = max_id and id%2=1) then student
        when (id &lt; max_id and id%2=1) then next_anme
        else last_name
    end) as student
from
(
    select id,student,
        lead(student)over(order by id) next_anme,
        lag(student)over(order by id) last_name
    from seat
) t1
,
(
    select max(id) as max_id
    from seat
) t2;
</code></pre>
<h1 id="1045ä¹°ä¸‹æ‰€æœ‰äº§å“çš„å®¢æˆ·">1045.ä¹°ä¸‹æ‰€æœ‰äº§å“çš„å®¢æˆ·</h1>
<p>ä» <code>Customer</code> è¡¨ä¸­æŸ¥è¯¢è´­ä¹°äº† <code>Product</code> è¡¨ä¸­æ‰€æœ‰äº§å“çš„å®¢æˆ·çš„ idã€‚</p>
<pre><code class="language-sql">select distinct customer_id
from(
  select customer_id, count(distinct Product_key) as type_num
  from Customer
  group by customer_id
) tmp
where type_num = (
  select count(distinct Product_key)
	from Product
);
</code></pre>
<h1 id="1070äº§å“é”€å”®åˆ†æ">1070.äº§å“é”€å”®åˆ†æ</h1>
<p>é€‰å‡ºæ¯ä¸ªé”€å”®äº§å“çš„ <strong>ç¬¬ä¸€å¹´</strong> çš„ <strong>äº§å“ id</strong>ã€<strong>å¹´ä»½</strong>ã€<strong>æ•°é‡</strong> å’Œ <strong>ä»·æ ¼</strong>ã€‚</p>
<pre><code class="language-sql">select product_id, 
    year as first_year,
    quantity, 
    price
from sales
where (product_id, year) in (
  select product_id, min(year)
  from sales
  group by product_id
)
</code></pre>
<h1 id="1084é”€å”®åˆ†æ">1084.é”€å”®åˆ†æ</h1>
<p>æŠ¥å‘Š<strong>ä»…</strong>åœ¨<strong>2019-01-01</strong>è‡³<strong>2019-03-31</strong>ï¼ˆå«ï¼‰ä¹‹é—´å‡ºå”®çš„å•†å“ã€‚</p>
<pre><code class="language-sql">select product_id, product_name
from product
where product_id not in (
    select distinct product_id
    from sales
    where (sale_date&gt;&quot;2019-03-31&quot; or sale_date&lt;&quot;2019-01-01&quot;)
)
and product_id in (
    select distinct product_id
    from sales
    where (sale_date &lt;=&quot;2019-03-31&quot; and sale_date&gt;=&quot;2019-01-01&quot;)
)
</code></pre>
<h1 id="1097æ¸¸æˆç©æ³•åˆ†æé¦–ç™»ç•™å­˜ç‡">1097.æ¸¸æˆç©æ³•åˆ†æâ€”â€”é¦–ç™»ç•™å­˜ç‡</h1>
<pre><code class="language-sql">select t1.event_date as install_dt,
    count(distinct t1.player_id) as installs, 
    round(count(distinct t2.player_id) / count(distinct t1.player_id),2) as Day1_retention
from (
  select player_id, min(event_date) as event_date
  from Activity
  group by player_id
) t1-- ç¬¬ä¸€å¤©ç™»å½•
left join Activity t2 
on t1.player_id = t2.player_id
and datediff(t2.event_date, t1.event_date)=1
group by t1.event_date
</code></pre>
<p>è¿™é‡Œè®°å¾—è€ƒè™‘ä½¿ç”¨on andè€Œä¸æ˜¯where</p>
<h1 id="1098å°ä¼—ä¹¦ç±">1098.å°ä¼—ä¹¦ç±</h1>
<p>ç­›é€‰å‡ºè¿‡å»ä¸€å¹´ä¸­è®¢å•æ€»é‡å°‘äº10æœ¬çš„ä¹¦ç± ã€‚æ³¨æ„ï¼šä¸è€ƒè™‘ ä¸Šæ¶ï¼ˆavailable fromï¼‰è·ä»Š ä¸æ»¡ä¸€ä¸ªæœˆ çš„ä¹¦ç±ã€‚å¹¶ä¸” å‡è®¾ä»Šå¤©æ˜¯ 2019-06-23 ã€‚</p>
<p>date_SUB(&quot;2019-06-23&quot;, INTERVAL 365 DAY) = &quot;2018-06-23&quot;</p>
<pre><code class="language-sql">select t1.book_id,
    t1.name
    -- , (case when t2.è®¢å•æ€»é‡ is null then 0 else t2.è®¢å•æ€»é‡ end ) as è®¢å•æ€»é‡
from 
(
    select book_id, name
    from books
    where available_from &lt;= date_sub(&quot;2019-06-23&quot;, INTERVAL 1 month)
) t1
left join
(
    select book_id, sum(quantity) as &quot;è®¢å•æ€»é‡&quot;
    from Orders
    where dispatch_date &gt;= date_sub(&quot;2019-06-23&quot;, INTERVAL 365 DAY)  
    and dispatch_date &lt;= &quot;2019-06-23&quot;
    group by book_id
) t2
on t1.book_id = t2.book_id
where (t2.è®¢å•æ€»é‡ is null or t2.è®¢å•æ€»é‡&lt;10)
</code></pre>
<p>ä¸€å®šæ³¨æ„ on å’Œ where çš„åŒºåˆ«ï¼</p>
<h1 id="1107æ¯æ—¥æ–°ç”¨æˆ·ç»Ÿè®¡">1107.æ¯æ—¥æ–°ç”¨æˆ·ç»Ÿè®¡</h1>
<p>ä»ä»Šå¤©èµ·æœ€å¤š 90 å¤©å†…ï¼Œæ¯ä¸ªæ—¥æœŸè¯¥æ—¥æœŸé¦–æ¬¡ç™»å½•çš„ç”¨æˆ·æ•°ï¼Œä»Šå¤©æ˜¯ <strong>2019-06-30</strong>.</p>
<pre><code class="language-sql">select first_login as login_date,
	count(distinct user_id) as user_count
from
(
  select user_id, min(activity_date) as first_login
  from traffic
  where activity = &quot;login&quot;
  group by user_id
) tmp
where first_login&lt;=&quot;2019-06-30&quot; 
and first_login &gt;= date_sub(&quot;2019-06-30&quot;,interval 90 day)
group by first_login;
</code></pre>
<h1 id="1126-æŸ¥è¯¢æ´»è·ƒä¸šåŠ¡">1126. æŸ¥è¯¢æ´»è·ƒä¸šåŠ¡</h1>
<p>å¦‚æœä¸€ä¸ªä¸šåŠ¡çš„æŸä¸ªäº‹ä»¶ç±»å‹çš„å‘ç”Ÿæ¬¡æ•°<strong>å¤§äº</strong>æ­¤äº‹ä»¶ç±»å‹åœ¨æ‰€æœ‰ä¸šåŠ¡ä¸­çš„å¹³å‡å‘ç”Ÿæ¬¡æ•°ï¼Œå¹¶ä¸”è¯¥ä¸šåŠ¡è‡³å°‘æœ‰ä¸¤ä¸ªè¿™æ ·çš„äº‹ä»¶ç±»å‹ï¼Œé‚£ä¹ˆè¯¥ä¸šåŠ¡å°±å¯è¢«çœ‹åšæ˜¯æ´»è·ƒä¸šåŠ¡ã€‚</p>
<pre><code class="language-sql">select business_id
    -- , count(distinct(case when occurences &gt; avg_occr then events.event_type else null end)) 
from events
left join
(
    select event_type, avg(occurences) as avg_occr
    from events
    group by event_type
) t1
on events.event_type = t1.event_type
group by business_id
having count(distinct(case when occurences &gt; avg_occr then events.event_type else null end))&gt;=2
</code></pre>
<h1 id="1127-ç”¨æˆ·è´­ä¹°å¹³å°éœ€å¤ä¹ ">1127. ç”¨æˆ·è´­ä¹°å¹³å°ï¼ˆéœ€å¤ä¹ ï¼‰</h1>
<p>æ¯å¤© <strong>ä»…</strong> ä½¿ç”¨æ‰‹æœºç«¯ç”¨æˆ·ã€<strong>ä»…</strong> ä½¿ç”¨æ¡Œé¢ç«¯ç”¨æˆ·å’Œ <strong>åŒæ—¶</strong> ä½¿ç”¨æ¡Œé¢ç«¯å’Œæ‰‹æœºç«¯çš„ç”¨æˆ·äººæ•°å’Œæ€»æ”¯å‡ºé‡‘é¢ï¼Œnullçš„æ—¶å€™éœ€è¦è®°ä½œ0</p>
<pre><code class="language-sql">-- æ„é€ æ—¥æœŸ*platformçš„ç¬›å¡å°”ç§¯
with table_2 as(
    select t4.spend_date, t3.platform
    from 
	(
    select 'mobile' as platform
    union
    select 'desktop' as platform
    union
    select 'both' as platform
	) t3,
	(
    select distinct spend_date
    from Spending
    order by spend_date
	) t4
)
-- left join 
select table_2.spend_date as spend_date, 
    table_2.platform as platform, 
    ifnull(sum(table_1.amount),0) as total_amount,
    count(table_1.user_id) as total_users
from table_2
left join 
(
    select t1.spend_date, t1.user_id, sum(t1.amount) as amount,
        (case when t2.num=1 then t1.platform else &quot;both&quot; end) as platform
    from spending t1
  	inner join (
            select spend_date, user_id, 
                count(distinct platform) as num
            from Spending
            group by spend_date, user_id
      ) t2
    on t1.spend_date = t2.spend_date
    and t1.user_id = t2.user_id
    group by t1.spend_date, t1.user_id
) table_1
on table_1.spend_date = table_2.spend_date
and  table_1.platform = table_2.platform
group by table_2.spend_date, table_2.platform
</code></pre>
<h1 id="1132æŠ¥å‘Šçš„è®°å½•2">1132.æŠ¥å‘Šçš„è®°å½•2</h1>
<p>åœ¨è¢«æŠ¥å‘Šä¸ºåƒåœ¾å¸–å­ï¼ˆspamï¼‰ä¸­ï¼Œè¢«ç§»é™¤çš„å¸–å­çš„æ¯”ä¾‹çš„æ¯æ—¥å¹³å‡å€¼ï¼Œå°æ•°ç‚¹å 2 ä½ã€‚</p>
<pre><code class="language-sql">select round(avg(ratio)*100,2) as average_daily_percent
from 
(
    select action_date,
        avg(case when t2.remove_date is null then 0 else 1 end) as ratio
    from
    (
      select distinct action_date, post_id
      from Actions
      where extra = &quot;spam&quot;
    ) t1
    left join Removals t2
    on t1.post_id = t2.post_id
    group by action_date
) t2
</code></pre>
<h1 id="1149-æ–‡ç« æµè§ˆ">1149. æ–‡ç« æµè§ˆ</h1>
<p>æ‰¾å‡ºåœ¨åŒä¸€å¤©é˜…è¯»è‡³å°‘ä¸¤ç¯‡æ–‡ç« çš„äººï¼Œç»“æœæŒ‰ç…§ id å‡åºæ’åº</p>
<pre><code class="language-sql">select distinct viewer_id as id
from views
group by view_date, viewer_id
having count(distinct article_id)&gt;=2
order by id asc
</code></pre>
<h1 id="1158-å¸‚åœºåˆ†æ1">1158. å¸‚åœºåˆ†æ1</h1>
<p>ç”¨æˆ· buyer_id  |æ³¨å†Œæ—¥æœŸ join_date  |  2019 å¹´ä½œä¸ºä¹°å®¶çš„è®¢å•æ€»æ•°orders_in_2019</p>
<pre><code class="language-sql">select t1.user_id as buyer_id, t1.join_date, ifnull(t2.orders_num,0) as orders_in_2019
from users t1
left join
(
  select buyer_id, count(distinct order_id) as orders_num
  from orders
  where order_date between &quot;2019-01-01&quot; and &quot;2019-12-31&quot;
  group by buyer_id
) t2
on t1.user_id = t2.buyer_id
</code></pre>
<h1 id="1159å¸‚åœºåˆ†æ2">1159.å¸‚åœºåˆ†æ2</h1>
<p>ç¡®å®šæ¯ä¸ªç”¨æˆ·æŒ‰æ—¥æœŸé¡ºåº<strong>å–å‡ºçš„ç¬¬äºŒä»¶å•†å“çš„å“ç‰Œæ˜¯å¦æ˜¯ä»–ä»¬æœ€å–œçˆ±çš„å“ç‰Œ</strong>ã€‚å¦‚æœä¸€ä¸ªç”¨æˆ·å–å‡ºå°‘äºä¸¤ä»¶å•†å“ï¼ŒæŸ¥è¯¢çš„ç»“æœæ˜¯ noã€‚</p>
<pre><code class="language-sql">select t1.user_id as seller_id,
     (case when t1.favorite_brand=t3.item_brand then &quot;yes&quot;
else &quot;no&quot; end) as 2nd_item_fav_brand
from Users t1
left join 
(
    select seller_id, item_id
    from(
        select seller_id, item_id, 
            row_number() over(partition by seller_id order by order_date asc) as rn
        from orders
    ) tmp
    where rn=2
) t2
on t1.user_id = t2.seller_id
left join Items t3
on t3.item_id = t2.item_id
order by seller_id
</code></pre>
<h1 id="1164æŒ‡å®šæ—¥æœŸçš„äº§å“ä»·æ ¼">1164.æŒ‡å®šæ—¥æœŸçš„äº§å“ä»·æ ¼</h1>
<p>Products è®°å½•äº† æŸäº§å“ åœ¨æŸä¸ªæ—¥æœŸ æ›´æ”¹å çš„æ–°ä»·æ ¼ã€‚æŸ¥æ‰¾åœ¨ <strong>2019-08-16</strong> æ—¶å…¨éƒ¨äº§å“çš„ä»·æ ¼ï¼Œå‡è®¾æ‰€æœ‰äº§å“åœ¨ä¿®æ”¹å‰çš„ä»·æ ¼éƒ½æ˜¯ <strong>10ã€‚</strong></p>
<p>å°äº0816çš„æ‰€æœ‰æ—¥æœŸé‡Œçš„æœ€å¤§å€¼å¯¹åº”çš„ä»·æ ¼ï¼Œæ²¡æœ‰æ”¹è¿‡çš„è¯å°±æ˜¯10</p>
<pre><code class="language-sql">select t1.product_id, ifnull(t2.new_price,10) as price
from 
(
  select distinct product_id
  from Products
) t1
left join 
(
  -- ä¿®æ”¹è¿‡ä»·æ ¼çš„
  select product_id, new_price
  from(
        select product_id
          , row_number() over(partition by product_id order by change_date desc) as rn
          , new_price
      from Products
      where change_date&lt;=&quot;2019-08-16&quot;
  ) tmp
  where rn = 1
) t2
on t1.product_id = t2.product_id
</code></pre>
<h1 id="1174å³æ—¶å®ç‰©é…é€2">1174.å³æ—¶å®ç‰©é…é€2</h1>
<p>å¦‚æœé¡¾å®¢æœŸæœ›<strong>é…é€æ—¥æœŸå’Œä¸‹å•æ—¥æœŸç›¸åŒ</strong>ï¼Œåˆ™è¯¥è®¢å• ã€Œå³æ—¶è®¢å•ã€ï¼Œå¦åˆ™ã€Œè®¡åˆ’è®¢å•ã€ã€‚</p>
<p>ã€Œé¦–æ¬¡è®¢å•ã€æ˜¯é¡¾å®¢æœ€æ—©åˆ›å»ºçš„è®¢å•ã€‚æˆ‘ä»¬ä¿è¯ä¸€ä¸ªé¡¾å®¢åªä¼šæœ‰ä¸€ä¸ªã€Œé¦–æ¬¡è®¢å•ã€ã€‚</p>
<p>æ‰€æœ‰ç”¨æˆ·çš„é¦–æ¬¡è®¢å•ä¸­å³æ—¶è®¢å•çš„æ¯”ä¾‹ã€‚ä¿ç•™ä¸¤ä½å°æ•°ã€‚</p>
<pre><code class="language-sql">select round(avg(case when customer_pref_delivery_date=order_date then 1 else 0 end)*100, 2) as immediate_percentage 
from 
(
    select * ,
        row_number() over(partition by customer_id order by order_date) as rk
    from Delivery
) tmp
where rk = 1;
</code></pre>
<h1 id="1193-æ¯æœˆäº¤æ˜“1">1193. æ¯æœˆäº¤æ˜“1</h1>
<p>æ¯ä¸ªæœˆå’Œæ¯ä¸ªå›½å®¶çš„äº‹åŠ¡æ•°åŠå…¶æ€»é‡‘é¢ã€å·²æ‰¹å‡†çš„äº‹åŠ¡æ•°åŠå…¶æ€»é‡‘é¢</p>
<pre><code class="language-sql">select date_format(trans_date, &quot;%Y-%m&quot;) as `month`,
	country,
	count(id) as trans_count,
    count(case when state = &quot;approved&quot; then id else null end) as approved_count,
	sum(amount) as trans_total_amount,
	sum(case when state = &quot;approved&quot; then amount else 0 end) as approved_total_amount
from Transactions
group by date_format(trans_date, &quot;%Y-%m&quot;), country;
</code></pre>
<h1 id="1194-é”¦æ ‡èµ›ä¼˜èƒœè€…">1194. é”¦æ ‡èµ›ä¼˜èƒœè€…</h1>
<p>æ¯ç»„çš„è·èƒœè€…æ˜¯åœ¨ç»„å†…<strong>ç´¯ç§¯å¾—åˆ†æœ€é«˜çš„é€‰æ‰‹</strong>ã€‚å¦‚æœå¹³å±€ï¼Œ<code>player_id</code> <strong>æœ€å°</strong> çš„é€‰æ‰‹è·èƒœã€‚</p>
<pre><code class="language-sql">select group_id,player_id
from 
(
    select  t1.group_id, t1.player_id, 
        row_number() over(partition by t1.group_id order by ifnull(total_score,0) desc) as rn
    from Players t1
    left join
    (
        select player_id, sum(first_score)+sum(second_score) as total_score
        from(
            select first_player as player_id, sum(first_score) as first_score, 0 as second_score
            from matches 
            group by first_player
            union all
            select second_player as player_id, 0 as first_score, sum(second_score) as second_score
            from matches 
            group by second_player
        ) tmp
        group by player_id
    ) t2
    on t1.player_id = t2.player_id
) t3
where rn = 1;
</code></pre>
<h1 id="1204æœ€åè¿›å…¥ç”µæ¢¯çš„">1204.æœ€åè¿›å…¥ç”µæ¢¯çš„</h1>
<p>ç”µæ¢¯æœ€å¤§è½½é‡é‡ä¸º <strong>1000</strong>ã€‚æŸ¥æ‰¾æœ€åä¸€ä¸ªèƒ½è¿›å…¥ç”µæ¢¯ä¸”ä¸è¶…è¿‡é‡é‡é™åˆ¶çš„ <code>person_name</code> ã€‚</p>
<pre><code class="language-sql">select person_name
from(
  select person_name, 
    sum(weight) over(order by turn asc) as weight_sum
  from queue
) tmp
where weight_sum &lt;= 1000
order by weight_sum desc
limit 1;
</code></pre>
<h1 id="1205-æ¯æœˆäº¤æ˜“2">1205. æ¯æœˆäº¤æ˜“2</h1>
<p>ä»¥æŸ¥æ‰¾æ¯ä¸ªæœˆå’Œæ¯ä¸ªå›½å®¶/åœ°åŒºçš„å·²æ‰¹å‡†äº¤æ˜“çš„æ•°é‡åŠå…¶æ€»é‡‘é¢ã€é€€å•çš„æ•°é‡åŠå…¶æ€»é‡‘é¢ã€‚</p>
<pre><code class="language-sql">select `month`,country,
    sum(approved_count) as approved_count,
    sum(approved_amount) as approved_amount,
    sum(chargeback_count) as chargeback_count,
    sum(chargeback_amount) as chargeback_amount
from
(
  	-- æ‰¹å‡†äº¤æ˜“çš„
    select date_format(trans_date, &quot;%Y-%m&quot;) as `month`, country,
        count(id) as  approved_count,
        sum(amount) as approved_amount,
        0 as chargeback_count,
        0 as chargeback_amount
    from Transactions
    where state = &quot;approved&quot;
    group by date_format(trans_date, &quot;%Y-%m&quot;), country
    
  	union all
    -- é€€å•çš„
  	select 
        date_format(t1.trans_date, &quot;%Y-%m&quot;) as `month`,
        t2.country,
        0 as approved_count,
        0 as approved_amount,
        count(t2.id) as chargeback_count,
        sum(t2.amount) as chargeback_amount
    from Chargebacks t1
    inner join Transactions t2
    on t1.trans_id = t2.id
    group by date_format(t1.trans_date, &quot;%Y-%m&quot;), t2.country
) tmp
group by `month`,country
</code></pre>
<h1 id="1212-æŸ¥è¯¢çƒé˜Ÿç§¯åˆ†">1212. æŸ¥è¯¢çƒé˜Ÿç§¯åˆ†</h1>
<p>èµ¢ä¸€åœºå¾—ä¸‰åˆ†ï¼›å¹³ä¸€åœºå¾—ä¸€åˆ†ï¼›è¾“ä¸€åœºä¸å¾—åˆ†ã€‚<br>
æŸ¥è¯¢æ¯ä¸ªé˜Ÿçš„ team_idï¼Œteam_name å’Œ num_pointsã€‚ç»“æœæ ¹æ® num_points é™åºæ’åºï¼Œå¦‚æœæœ‰ä¸¤é˜Ÿç§¯åˆ†ç›¸åŒï¼Œé‚£ä¹ˆè¿™ä¸¤é˜ŸæŒ‰ team_id  å‡åºæ’åºã€‚</p>
<pre><code class="language-sql">-- my answer
select 
    Teams.team_id,
    Teams.team_name,
    ifnull(sum(tmp.host_goals),0) + ifnull(sum(tmp.guest_goals),0) as num_points
from Teams
left join
(
  select host_team as team_id, 
    sum(case when host_goals&gt;guest_goals then 3 
      when  host_goals=guest_goals then 1
    else 0 end) as host_goals,
    0 as guest_goals
  from matches
  group by host_team
  union all
  select guest_team as team_id, 
    0 as host_goals,
    sum(case when host_goals&lt;guest_goals then 3 
      when  host_goals=guest_goals then 1
    else 0 end) as guest_goals
  from matches
  group by guest_team
) tmp
on Teams.team_id = tmp.team_id
group by team_id
order by num_points desc, team_id asc;

-- å†™çš„æœ‰ç‚¹å¤æ‚ï¼Œå‚è€ƒé¢˜è§£
-- ä¸ç”¨ union ç”¨ å¤æ‚çš„ or 
select t1.team_id,t1.team_name,
	sum((case when (t1.team_id = t2.host_team and host_goals&gt;guest_goals) or (t1.team_id = t2.guest_team and host_goals&lt;guest_goals)  then 3
   when host_goals=guest_goals then 1
   else 0
  end)) as num_points
from teams t1
left join matches t2
on (t1.team_id = t2.host_team or t1.team_id = t2.guest_team)
group by t1.team_id, t1.team_name
order by num_points desc, team_id asc
</code></pre>
<h1 id="1225-æŠ¥å‘Šç³»ç»ŸçŠ¶æ€çš„è¿ç»­æ—¥æœŸéœ€å¤ä¹ ">1225. æŠ¥å‘Šç³»ç»ŸçŠ¶æ€çš„è¿ç»­æ—¥æœŸï¼ˆéœ€å¤ä¹ ï¼‰</h1>
<p>ç³»ç»Ÿ æ¯å¤© è¿è¡Œä¸€ä¸ªä»»åŠ¡ã€‚æ¯ä¸ªä»»åŠ¡éƒ½ç‹¬ç«‹äºå…ˆå‰çš„ä»»åŠ¡ã€‚ä»»åŠ¡çš„çŠ¶æ€å¯ä»¥æ˜¯å¤±è´¥æˆ–æ˜¯æˆåŠŸã€‚</p>
<p>ç¼–å†™ä¸€ä¸ª SQL æŸ¥è¯¢ 2019-01-01 åˆ° 2019-12-31 æœŸé—´ä»»åŠ¡<strong>è¿ç»­åŒçŠ¶æ€ period_state çš„èµ·æ­¢æ—¥æœŸ</strong>ï¼ˆstart_date å’Œ end_dateï¼‰ã€‚å³å¦‚æœä»»åŠ¡å¤±è´¥äº†ï¼Œå°±æ˜¯å¤±è´¥çŠ¶æ€çš„èµ·æ­¢æ—¥æœŸï¼Œå¦‚æœä»»åŠ¡æˆåŠŸäº†ï¼Œå°±æ˜¯æˆåŠŸçŠ¶æ€çš„èµ·æ­¢æ—¥æœŸã€‚</p>
<p>æœ€åç»“æœæŒ‰ç…§èµ·å§‹æ—¥æœŸ start_date æ’åº</p>
<pre><code class="language-sql">with tmp as(
    select fail_date as date_day,
  -- ç”¨datediff è€Œä¸æ˜¯åŸæœ¬æ—¥æœŸï¼Œä»¥é¿å…åˆ¤å®š1.31å’Œ2.1ä¸æ˜¯è¿ç»­çš„è¿™ç§æƒ…å†µ
        datediff(fail_date, &quot;2019-01-01&quot;)+1 as date_day2,
         &quot;failed&quot; as period_state
    from Failed
    union 
    select success_date as date_day,
        datediff(success_date, &quot;2019-01-01&quot;)+1 as date_day2,
        &quot;succeeded&quot; as period_state
    from Succeeded
) -- å…ˆunion
-- è¿ç»­æŒ‰ç…§day - row_number è®¡ç®—
select period_state,
      min(date_day) as start_date,
      max(date_day) as end_date
from(
    select date_day, period_state, 
        row_number() over(partition by period_state order by date_day2 asc) as rn,
        date_day2 - row_number() over(partition by period_state order by date_day2 asc) as date_rn
    from tmp
    where date_day&gt;=&quot;2019-01-01&quot; and date_day&lt;=&quot;2019-12-31&quot;
) tmp2
group by period_state, date_rn 
order by start_date asc;
</code></pre>
<h1 id="1264é¡µé¢æ¨è">1264.é¡µé¢æ¨è</h1>
<p>å†™ä¸€æ®µ SQL  å‘<code>user_id</code> = 1 çš„ç”¨æˆ·ï¼Œæ¨èå…¶æœ‹å‹ä»¬å–œæ¬¢çš„é¡µé¢ã€‚ä¸è¦æ¨èè¯¥ç”¨æˆ·å·²ç»å–œæ¬¢çš„é¡µé¢ã€‚ä½ è¿”å›çš„ç»“æœä¸­ä¸åº”å½“åŒ…å«é‡å¤é¡¹ã€‚</p>
<pre><code class="language-sql">select distinct page_id as recommended_page
from likes
where user_id in (
    select distinct (case when user1_id = 1 then user2_id else user1_id end) as friend_id
    from Friendship
    where (user1_id = 1 or user2_id = 1)
)
and page_id not in (
    select distinct page_id
    from likes
    where user_id = 1
)
</code></pre>
<h1 id="1270å‘å…¬å¸ceoæ±‡æŠ¥å·¥ä½œçš„æ‰€æœ‰äºº">1270.å‘å…¬å¸CEOæ±‡æŠ¥å·¥ä½œçš„æ‰€æœ‰äºº</h1>
<p>ç”¨ SQL æŸ¥è¯¢å‡ºæ‰€æœ‰ç›´æ¥æˆ–é—´æ¥å‘å…¬å¸ CEO æ±‡æŠ¥å·¥ä½œçš„èŒå·¥çš„ employee_id ã€‚ç”±äºå…¬å¸è§„æ¨¡è¾ƒå°ï¼Œç»ç†ä¹‹é—´çš„é—´æ¥å…³ç³»ä¸è¶…è¿‡ 3 ä¸ªç»ç†ã€‚å¯ä»¥ä»¥ä»»ä½•é¡ºåºè¿”å›çš„ç»“æœï¼Œä¸éœ€è¦å»é‡ã€‚</p>
<pre><code class="language-sql">select distinct employee_id
from Employees
where manager_id  in (
    select distinct employee_id
    from Employees
    where manager_id  in (
        select distinct employee_id
        from Employees
        where manager_id = 1
    )
)
and employee_id != 1
</code></pre>
<h1 id="1285-è¿ç»­åŒºé—´çš„å¼€å§‹å’Œç»“æŸæ•°å­—">1285. è¿ç»­åŒºé—´çš„å¼€å§‹å’Œç»“æŸæ•°å­—</h1>
<p><code>Logs</code> è¡¨ä¸­çš„è¿ç»­åŒºé—´çš„å¼€å§‹æ•°å­—å’Œç»“æŸæ•°å­—ã€‚æŒ‰ç…§ <code>start_id</code> æ’åºã€‚</p>
<pre><code class="language-sql">select min(log_id) as start_id, max(log_id) as end_id
from(
  select log_id,log_id - row_number()over(order by log_id asc) as log_rk
	from logs
) tmp
group by log_rk;
</code></pre>
<h1 id="1308-ä¸åŒæ€§åˆ«çš„æ¯æ—¥åˆ†æ•°ç»Ÿè®¡">1308. ä¸åŒæ€§åˆ«çš„æ¯æ—¥åˆ†æ•°ç»Ÿè®¡</h1>
<p>æŸ¥è¯¢æ¯ç§æ€§åˆ«åœ¨æ¯ä¸€å¤©çš„æ€»åˆ†ï¼Œå¹¶æŒ‰æ€§åˆ«å’Œæ—¥æœŸå¯¹æŸ¥è¯¢ç»“æœæ’åºã€‚</p>
<pre><code class="language-sql">select gender, day, 
    sum(score_points) over(partition by gender order by day) total
from scores
order by gender, day
</code></pre>
<h1 id="1321-é¤é¦†è¥ä¸šé¢å˜åŒ–å¢é•¿è¿ç»­æ±‚å’Œ">1321. é¤é¦†è¥ä¸šé¢å˜åŒ–å¢é•¿â€”è¿ç»­æ±‚å’Œ</h1>
<p>å†™ä¸€æ¡ SQL æŸ¥è¯¢è®¡ç®—ä»¥ 7 å¤©ï¼ˆæŸæ—¥æœŸ + è¯¥æ—¥æœŸå‰çš„ 6 å¤©ï¼‰ä¸ºä¸€ä¸ªæ—¶é—´æ®µçš„é¡¾å®¢æ¶ˆè´¹å¹³å‡å€¼ã€‚è¾“å‡ºæŒ‰ç…§æ—¥æœŸæ’åºã€‚</p>
<p>è¿ç»­æ±‚å’Œï¼š<strong>sum</strong>(amount) over(<strong>order by</strong> visited_on <strong>rows 6 preceding</strong>) å¯¹å½“å‰å’Œå6è¡Œè¿ç»­æ±‚å’Œ</p>
<pre><code class="language-sql">-- æ™®é€šè§£æ³•
select 
    c1.visited_on, 
    sum(c2.amount) as amount,
    round(sum(c2.amount) / 7, 2) as average_amount
from 
(
    select distinct visited_on
    from Customer
    where datediff(visited_on,(select min(visited_on) from Customer))&gt;=6
) c1,
Customer c2
where datediff(c1.visited_on, c2.visited_on)&lt;=6
and c2.visited_on &lt;= c1.visited_on
group by c1.visited_on
order by c1.visited_on asc


-- çª—å£å‡½æ•°æ–°è§£æ³•
select * from
(
    select visited_on,
        sum(amount) over(order by visited_on rows 6 preceding) as amount,
        round(avg(amount) over(order by visited_on rows 6 preceding),2) as average_amount
    from(
         select visited_on, sum(amount) as amount 
         from Customer
         group by visited_on
    )t1
)t2 
where datediff(visited_on, (select min(visited_on)from Customer))&gt;=6
</code></pre>
<h1 id="1336æ¯æ¬¡è®¿é—®çš„äº¤æ˜“æ¬¡æ•°">1336.æ¯æ¬¡è®¿é—®çš„äº¤æ˜“æ¬¡æ•°</h1>
<p>å¤šå°‘å®¢æˆ·è®¿é—®äº†é“¶è¡Œä½†æ²¡æœ‰è¿›è¡Œä»»ä½•äº¤æ˜“ï¼Œå¤šå°‘å®¢æˆ·è®¿é—®äº†é“¶è¡Œè¿›è¡Œäº†ä¸€æ¬¡äº¤æ˜“ç­‰ç­‰</p>
<p>ç»“æœåŒ…å«ä¸¤åˆ—ï¼š</p>
<p>transactions_countï¼š å®¢æˆ·åœ¨ä¸€æ¬¡è®¿é—®ä¸­çš„äº¤æ˜“æ¬¡æ•°<br>
visits_countï¼š åœ¨ transactions_count äº¤æ˜“æ¬¡æ•°ä¸‹<strong>ç›¸åº”çš„å®¢æˆ·æ•°é‡</strong><br>
transactions_count çš„å€¼ä» 0 åˆ°æ‰€æœ‰ç”¨æˆ·ä¸€æ¬¡è®¿é—®ä¸­çš„ max(transactions_count)</p>
<pre><code class="language-sql">select 
from visits t1
left join Transactions t2
on t1.user_id=t2.user_id
and 
</code></pre>
<h1 id="1341-ç”µå½±è¯„åˆ†">1341. ç”µå½±è¯„åˆ†</h1>
<p>è¯·ä½ ç¼–å†™ä¸€ç»„ SQL æŸ¥è¯¢ï¼š</p>
<p>æŸ¥æ‰¾è¯„è®ºç”µå½±æ•°é‡æœ€å¤šçš„ç”¨æˆ·åã€‚<br>
å¦‚æœå‡ºç°å¹³å±€ï¼Œè¿”å›å­—å…¸åºè¾ƒå°çš„ç”¨æˆ·åã€‚</p>
<p>æŸ¥æ‰¾åœ¨ 2020 å¹´ 2 æœˆ å¹³å‡è¯„åˆ†æœ€é«˜ çš„ç”µå½±åç§°ã€‚<br>
å¦‚æœå‡ºç°å¹³å±€ï¼Œè¿”å›å­—å…¸åºè¾ƒå°çš„ç”µå½±åç§°ã€‚</p>
<p>æŸ¥è¯¢åˆ†ä¸¤è¡Œè¿”å›ï¼ŒæŸ¥è¯¢ç»“æœæ ¼å¼å¦‚ä¸‹ä¾‹æ‰€ç¤ºï¼š</p>
<pre><code class="language-sql">select `name` as results
from
(
    select `name`,
        count(1) as num
    from Movie_Rating
    left join Users on Movie_Rating.user_id = Users.user_id
    group by `name`
    order by num desc, `name` asc
    limit 1
) t1
union all
select title as results
from 
(
    select title,
        avg(case when date_format(created_at, &quot;%Y-%m&quot;)=&quot;2020-02&quot; then rating else null end ) as rating
    from Movie_Rating
    inner join Movies on Movie_Rating.movie_id = Movies.movie_id
    group by title
    order by rating desc, title asc
    limit 1
) t2
</code></pre>
<h1 id="1355æ´»åŠ¨å‚ä¸è€…">1355.æ´»åŠ¨å‚ä¸è€…</h1>
<p>å†™ä¸€æ¡ SQL æŸ¥è¯¢é‚£äº›æ—¢æ²¡æœ‰æœ€å¤šï¼Œä¹Ÿæ²¡æœ‰æœ€å°‘å‚ä¸è€…çš„æ´»åŠ¨çš„åå­—ã€‚æ³¨æ„åç§°ç›¸åŒ id ä¸åŒçš„å‚ä¸è€…ç®—ä½œä¸¤ä¸ªäººã€‚</p>
<pre><code class="language-sql">select activity
from
(
    select activity, num,
    rank() over(order by num asc ) as rk1,
    rank() over(order by num desc ) as rk2
    from (
        select activity, count(distinct id) as num
        from Friends
        group by activity
    ) t1
) t2
where rk1&gt;1 and rk2&gt;1
</code></pre>
<h1 id="1364é¡¾å®¢çš„å¯ä¿¡è”ç³»äººæ•°">1364.é¡¾å®¢çš„å¯ä¿¡è”ç³»äººæ•°</h1>
<p>ä¸ºæ¯å¼ å‘ç¥¨ invoice_id ç¼–å†™ä¸€ä¸ªSQLæŸ¥è¯¢ä»¥æŸ¥æ‰¾ä»¥ä¸‹å†…å®¹ï¼š</p>
<p>customer_nameï¼šä¸å‘ç¥¨ç›¸å…³çš„é¡¾å®¢åç§°ã€‚<br>
priceï¼šå‘ç¥¨çš„ä»·æ ¼ã€‚<br>
contacts_cntï¼šè¯¥é¡¾å®¢çš„è”ç³»äººæ•°é‡ã€‚<br>
trusted_contacts_cntï¼šå¯ä¿¡è”ç³»äººçš„æ•°é‡ï¼šæ—¢æ˜¯è¯¥é¡¾å®¢çš„è”ç³»äººåˆæ˜¯å•†åº—é¡¾å®¢çš„è”ç³»äººæ•°é‡ï¼ˆå³ï¼šå¯ä¿¡è”ç³»äººçš„ç”µå­é‚®ä»¶å­˜åœ¨äºå®¢æˆ·è¡¨ä¸­ï¼‰ã€‚<br>
å°†æŸ¥è¯¢çš„ç»“æœæŒ‰ç…§ invoice_id æ’åºã€‚</p>
<pre><code class="language-sql">select t1.invoice_id,t3.customer_name,
    t1.price as price, 
    count(distinct t2.contact_email) as contacts_cnt,
    ifnull(t4.trusted_contacts_cnt,0) as trusted_contacts_cnt
from Invoices t1
left join Contacts t2
on t1.user_id = t2.user_id
left join Customers t3
on t3.customer_id = t1.user_id
left join (
    select Contacts.user_id, count(distinct Customers.customer_id) as trusted_contacts_cnt
    from Contacts
    inner join Customers
    on Contacts.contact_name = Customers.customer_name
    group by Contacts.user_id
) t4
on t4.user_id = t1.user_id
group by t1.invoice_id
</code></pre>
<h1 id="1369-è·å–ç¬¬äºŒæ¬¡çš„æ´»åŠ¨">1369. è·å–ç¬¬äºŒæ¬¡çš„æ´»åŠ¨</h1>
<p>å±•ç¤ºæ¯ä¸€ä½ç”¨æˆ· <strong>æœ€è¿‘ç¬¬äºŒæ¬¡</strong> çš„æ´»åŠ¨ï¼Œå¦‚æœç”¨æˆ·ä»…æœ‰ä¸€æ¬¡æ´»åŠ¨ï¼Œè¿”å›è¯¥æ´»åŠ¨</p>
<pre><code class="language-sql">select username, activity,startDate,endDate
from (
    select *,
        row_number() over(partition by username order by startDate desc) as rk1,
        row_number() over(partition by username order by startDate asc) as rk2
    from UserActivity
) tmp
where (rk1 = rk2 and rk1 = 1)  or rk1=2
</code></pre>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[XGBoost åŸç†ä¸é¢è¯•é—®é¢˜]]></title>
        <id>https://yangggshuyi.github.io/post/xgboost-yuan-li-yu-mian-shi-wen-ti/</id>
        <link href="https://yangggshuyi.github.io/post/xgboost-yuan-li-yu-mian-shi-wen-ti/">
        </link>
        <updated>2021-03-11T10:07:51.000Z</updated>
        <content type="html"><![CDATA[<h1 id="åŸç†æ¨å¯¼">åŸç†æ¨å¯¼ï¼š</h1>
<figure data-type="image" tabindex="1"><img src="https://yangggshuyi.github.io/post-images/1615543724318.jpg" alt="" loading="lazy"></figure>
<h1 id="xgboostå¸¸è§é¢è¯•é¢˜">xgboostå¸¸è§é¢è¯•é¢˜</h1>
<h2 id="1boostingçš„æ€æƒ³">1.Boostingçš„æ€æƒ³</h2>
<p>ï¼ˆç›´æ¥è®²adaboostï¼‰åˆå§‹åŒ–è®­ç»ƒä¸€ä¸ªå¼±å­¦ä¹ å™¨ï¼Œæ¯æ¬¡ä¾ç…§è®­ç»ƒç»“æœè°ƒæ•´æ ·æœ¬æƒé‡ï¼Œå¢å¤§é”™åˆ†æ ·æœ¬çš„æƒé‡å¹¶åŸºäºæ­¤è®­ç»ƒä¸‹ä¸€ä¸ªå­¦ä¹ å™¨ï¼Œé¢„æµ‹æ—¶ä¸²è”å„å­¦ä¹ å™¨çš„åŠ æƒç»“æœã€‚</p>
<h2 id="2xgboostå’Œgbdtçš„åŒºåˆ«">2.XGBoostå’ŒGBDTçš„åŒºåˆ«ï¼š</h2>
<ol>
<li>
<p>æŸå¤±å‡½æ•°ä¸Šï¼šå¯¹äºLosséƒ¨åˆ†æ˜¯ä¸€é˜¶è¿˜æ˜¯äºŒé˜¶å±•å¼€ï¼ˆäºŒé˜¶æ›´å‡†ç¡®ï¼‰</p>
</li>
<li>
<p>æ­£åˆ™é¡¹ä¸Šï¼šXGBooståŠ ä¸Šæ ‘æ¨¡å‹å¤æ‚åº¦çš„æ­£åˆ™é¡¹</p>
</li>
<li>
<p>ç‰¹å¾é€‰æ‹©ä¸Šï¼š</p>
<ul>
<li>
<p>åŠ å…¥è¿‘ä¼¼ç®—æ³•ï¼ˆä¸æ˜¯éå†æ‰€æœ‰å¯èƒ½å–å€¼ï¼Œè€Œæ˜¯æœ‰é—´éš”çš„é€‰å–å€™é€‰æ‹†åˆ†ç‚¹/åˆ†æ¡¶ï¼‰ï¼Œé»˜è®¤tree_method = â€œautoâ€å°†åœ¨ä¸­å°æ•°æ®ä¸Šæ²¿ç”¨è´ªå¿ƒç®—æ³•ï¼Œå¤§æ•°æ®é›†ä¸Šä½¿ç”¨è¿‘ä¼¼ç®—æ³•ã€‚</p>
</li>
<li>
<p>XGBoostå¼•å…¥éšæœºæ£®æ—åœ¨ç‰¹å¾é›†åˆæŠ½æ ·çš„æ€æƒ³ï¼Œå¸®åŠ©é™ä½è¿‡æ‹Ÿåˆ</p>
</li>
</ul>
</li>
<li>
<p>åŸºå­¦ä¹ å™¨ä¸Šï¼šgbdt åªèƒ½ç”¨cartç®—æ³•çš„å›å½’æ ‘ï¼Œè€Œxgboost æ”¯æŒçº¿æ€§åˆ†ç±»å™¨ gblinearã€‚</p>
</li>
<li>
<p>ç¼ºå¤±å€¼å¤„ç†ä¸Šï¼šXGBooståœ¨è®­ç»ƒæ—¶ç¼ºå¤±å€¼ä¼šè¢«åˆ†åˆ°å·¦å­æ ‘å’Œå³å­æ ‘ï¼Œåˆ†åˆ«è®¡ç®—ç›®æ ‡å‡½æ•°ï¼Œå¯¹æ¯”é€‰æ‹©è¾ƒä¼˜çš„åˆ†é…æ–¹å¼ã€‚</p>
</li>
<li>
<p>è®¡ç®—é€Ÿåº¦ä¸Šâ€”â€”pre_sortedé¢„æ’åºã€åˆ†ç®±çš„è¿‘ä¼¼ç®—æ³•ã€åˆ†å¸ƒå¼è®¡ç®—ç­‰</p>
</li>
</ol>
<h2 id="3xgboost-è®¡ç®—é€Ÿåº¦ä¸Šçš„æå‡ç‚¹">3.XGBoost è®¡ç®—é€Ÿåº¦ä¸Šçš„æå‡ç‚¹</h2>
<ol>
<li>
<p>å†³ç­–æ ‘æœ€è€—æ—¶çš„æ­¥éª¤æ˜¯å¯¹ç‰¹å¾çš„å€¼æ’åºï¼ŒXGBooståœ¨è¿­ä»£ä¹‹å‰ï¼Œå…ˆè¿›è¡Œé¢„æ’åºï¼Œå­˜ä¸ºblockç»“æ„ï¼Œæ¯æ¬¡è¿­ä»£é‡å¤ä½¿ç”¨è¯¥ç»“æ„ï¼Œé™ä½è®¡ç®—ï¼ŒåŒæ—¶å„ä¸ªç‰¹å¾çš„å¢ç›Šè®¡ç®—å¯ä»¥<strong>å¼€å¤šçº¿ç¨‹è¿›è¡Œ</strong></p>
<p>ï¼ˆè¿™é‡Œä¹Ÿæœ‰ä¸€ä¸ªè€ƒç‚¹ï¼Œ<strong>xgb çš„å¹¶è¡Œå’ŒRfä¸åŒï¼Œæ˜¯åœ¨é€‰æ‹©åˆ†å‰²æ–¹å¼æ—¶ï¼Œå¹¶è¡Œè®¡ç®—å„ä¸ªç‰¹å¾çš„æœ€ä½³åˆ†å‰²ç‚¹ï¼Œè€Œä¸æ˜¯å¹¶è¡Œæ„é€ tree</strong>ï¼Œæ‰€æœ‰ boosting ç®—æ³•éƒ½æ˜¯additive training æ— æ³•å¹¶è¡Œæ„é€ treeï¼‰</p>
</li>
<li>
<p>åˆ†ç®± / è¿‘ä¼¼ç›´æ–¹å›¾ç®—æ³•ï¼Œä¸æ˜¯éå†æ‰€æœ‰å¯èƒ½å–å€¼ï¼Œè€Œæ˜¯æœ‰é—´éš”çš„é€‰å–å€™é€‰æ‹†åˆ†ç‚¹/åˆ†æ¡¶ï¼Œæ¯”å¦‚è¿ç»­å€¼ç›´æ¥å–åˆ†ä½æ•°ã€‚ï¼ˆLightGBMæ–¹æ³•é‡‡ç”¨histogramç®—æ³•ï¼Œå¤æ‚åº¦æ›´ä½ï¼‰</p>
</li>
</ol>
<h2 id="4ç›®æ ‡å‡½æ•°-mae-äºŒé˜¶ä¸å¯å¯¼é—®é¢˜">4.ç›®æ ‡å‡½æ•° MAE äºŒé˜¶ä¸å¯å¯¼é—®é¢˜</h2>
<p>æœ‰ç»å¯¹å€¼çš„ç›®æ ‡å‡½æ•° MAE MAPE äºŒé˜¶ä¸å¯å¯¼ï¼Œä¸»æµæ–¹æ³•æ˜¯ç”¨åˆ©ç”¨å¯å¯¼å‡½æ•°é€¼è¿‘ï¼Œæ¯”å¦‚MSEæˆ–è€…<strong>Pseudo-Huber loss function</strong>ï¼š</p>
<figure data-type="image" tabindex="2"><img src="https://www.zhihu.com/equation?tex=L_%5Cdelta%28y_i%2C%5Ctilde%7By%7D_i%29%3D%5Cdelta%5E%7B2%7D%28%5Csqrt%7B1%2B%28%5Cfrac%7B%5Ctilde%7By%7D_i-y_i%7D%7B%5Cdelta%7D%29%5E%7B2%7D%7D-1%29" alt="[å…¬å¼]" loading="lazy"></figure>
<h2 id="5xgboost-å¦‚ä½•è°ƒå‚">5.XGBoost å¦‚ä½•è°ƒå‚ï¼Ÿ</h2>
<p><a href="https://xgboost.readthedocs.io/en/latest/parameter.html">æ‰€æœ‰å‚æ•°ä»‹ç»åœ°å€</a></p>
<ul>
<li>ç¡®å®š etaï¼ˆå­¦ä¹ ç‡ï¼‰å’Œ n_estimatorsï¼ˆè¿­ä»£æ¬¡æ•°=æ ‘çš„ä¸ªæ•°ï¼‰</li>
<li>å†ç¡®å®šæ¯æ£µæ ‘çš„åŸºæœ¬ä¿¡æ¯ï¼Œmax_depth å’Œ min_child_weightï¼ˆå³èŠ‚ç‚¹å¤§Hå€¼ï¼‰</li>
<li>å†ç¡®å®šå…¨å±€ä¿¡æ¯ï¼šæ¯”å¦‚æœ€å°åˆ†è£‚å¢ç›Šï¼Œé‡‡æ ·å‚æ•°ï¼ˆæ ·æœ¬é‡‡æ · subsampleã€ç‰¹å¾é‡‡æ ·colsample_bytreeï¼‰ï¼Œæ­£åˆ™å‚æ•°ï¼ˆL1-alphaå’ŒL2-lambdaï¼‰</li>
<li>é‡æ–°é™ä½ etaï¼ˆå­¦ä¹ ç‡ï¼‰ï¼Œå¾—åˆ°æœ€ä¼˜è§£</li>
</ul>
<h2 id="6xgboost-è¿‡æ‹Ÿåˆæ€ä¹ˆåŠ">6.XGBoost è¿‡æ‹Ÿåˆæ€ä¹ˆåŠï¼Ÿ</h2>
<ol>
<li>
<p>å¯¹æ ‘çš„å‰ªæï¼š</p>
<ul>
<li>é™ä½æ ‘çš„æ·±åº¦ max_depth</li>
<li>å¢å¤§ min_child_weightï¼ˆå³èŠ‚ç‚¹å¤§Hå€¼ï¼‰</li>
<li>å¢å¤§æƒ©ç½šç³»æ•°alphaå’Œlambda</li>
</ul>
</li>
<li>
<p>subsample åŠ›åº¦å˜å¤§ï¼Œé™ä½å¼‚å¸¸ç‚¹å½±å“</p>
</li>
<li>
<p>å‡å° learning rateï¼Œæé«˜ n_estimators</p>
</li>
</ol>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[å› æœæ¨æ–­åŸºæœ¬æ¦‚å¿µ]]></title>
        <id>https://yangggshuyi.github.io/post/yin-guo-tui-duan-jian-jie/</id>
        <link href="https://yangggshuyi.github.io/post/yin-guo-tui-duan-jian-jie/">
        </link>
        <updated>2021-03-06T04:28:02.000Z</updated>
        <summary type="html"><![CDATA[<p>ä»Šæ—¥æ”¶è·å°±æ˜¯æ²¡æœ‰æ”¶è·ï¼Œè·Ÿé£æ„Ÿè°¢æ—¥æ–‡å’Œæ¶›æ€»çš„é™ªä¼´~</p>
]]></summary>
        <content type="html"><![CDATA[<p>ä»Šæ—¥æ”¶è·å°±æ˜¯æ²¡æœ‰æ”¶è·ï¼Œè·Ÿé£æ„Ÿè°¢æ—¥æ–‡å’Œæ¶›æ€»çš„é™ªä¼´~</p>
<!-- more -->
<p>é—®é¢˜å¼•å…¥æºè‡ªä¸¤æ–¹é¢ï¼š</p>
<p>1.è€æ¿æé—®ï¼š</p>
<blockquote>
<p>ä¸ºäº†å¯¹æ¯”abä¸¤ç»„æµé‡çš„ctrå·®åˆ«ï¼Œåœ¨ç»™ç‚¹æ˜¾è‘—æ€§æ°´å¹³å’ŒæœŸæœ›è¯¯å·®1%å†…çš„æ¡ä»¶ä¸‹ï¼Œå¯ä»¥è®¡ç®—å‡ºæ‰€éœ€æœ€å°çš„æ ·æœ¬é‡ã€‚éšåæ ¹æ®æµé‡é¡ºåºåˆ’åˆ†ABä¸¤ç»„ä½œä¸ºå®éªŒç»„å’Œå¯¹ç…§ç»„ã€‚åœ¨è¯¥åˆ†ç»„çš„åŸºç¡€ä¸Šï¼Œè¯„ä»·ä½¿ç”¨æ ¸å¿ƒæŒ‡æ ‡å˜ä¸ºgmvï¼ˆæ¯ä¸ªäººåœ¨å‘¨æœŸå†…çš„æ€»è´­ä¹°é‡‘é¢ï¼‰ã€‚ç©ºè·‘4å¤©ï¼Œç»“æœå‘ç°ABä¸¤ç»„gmvå·®å¼‚å·²ç»å­˜åœ¨ï¼Œç”šè‡³æœ‰äº›æ—¶é—´åŒºé—´ä¸Šæ˜¾è‘—ã€‚å¦‚æœä»åšæŒå¼€å§‹å®éªŒï¼Œå¦‚ä½•é€šè¿‡æ•°æ®åˆ†æçš„æ–¹æ³•ï¼Œè¯´æ˜æœ€ç»ˆç»“æœå·®å¼‚æ˜¾è‘—æ˜¯ç”±äºå®éªŒå¤„ç†è€Œä¸åªæ˜¯åˆ†ç»„æœ¬èº«å·®å¼‚æˆ–è€…å…¶ä»–å› ç´ ï¼Ÿ</p>
</blockquote>
<p>2.é¢è¯•é—®é¢˜ï¼š</p>
<blockquote>
<p>Simpson æ‚–è®ºåœ¨ç¬¬ä¸€æ¬¡é¢å­—èŠ‚æ—¶è¢«é—®åˆ°äº†ï¼Œå½“æ—¶æ‡µäº†ä¸€ä¼šæ‰æ„è¯†è¿‡æ¥~ Simpson æ‚–è®ºï¼ˆæ€»ä½“å’Œéƒ¨åˆ†è¡¨ç°å‡ºç›¸åç»“è®ºï¼Œæ¯”å¦‚<a href="https://baike.baidu.com/item/%E8%BE%9B%E6%99%AE%E6%A3%AE%E6%82%96%E8%AE%BA/4475862?fr=aladdin">ç”·å¥³å½•å–ç‡åœ¨æ€»ä½“å’Œä¸åŒä¸“ä¸šåˆ†å±‚çš„ç»“æœä¹‹é—´çŸ›ç›¾</a>ï¼‰æœ¬è´¨ä¸Šå±äºå†…ç”Ÿæ€§é—®é¢˜ï¼ˆè§£é‡Šå˜é‡å’Œè¯¯å·®é¡¹å­˜åœ¨ç›¸å…³å…³ç³»ï¼‰ï¼Œå¸¸è§çš„åŸå› æ˜¯é—æ¼å˜é‡ï¼ˆæ¯”å¦‚ç”·å¥³æ¯”ä¾‹å·®å¼‚ï¼‰ã€‚è¿™è¯´æ˜ï¼Œæœ‰æ—¶æ˜¯æ— æ³•ä»ç›¸å…³æ€§æ¨å¯¼å‡ºå› æœå…³ç³»çš„ã€‚</p>
</blockquote>
<h1 id="1rubin-causal-model">1.Rubin Causal Model</h1>
<p><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>Z</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">Z_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.07153em;">Z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> è¡¨ç¤ºä¸ªä½“iæ˜¯å¦æ¥å—å¤„ç†ï¼Œ<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>Y</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">Y_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.22222em;">Y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.22222em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>è¡¨ç¤ºç»“æœå˜é‡ï¼Œåˆ™ä¸ªä½“içš„è§‚æµ‹ç»“æœæ˜¯ï¼š</p>
<p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>Y</mi><mi>i</mi></msub><mo>=</mo><msub><mi>Z</mi><mi>i</mi></msub><msub><mi>Y</mi><mi>i</mi></msub><mo>(</mo><mn>1</mn><mo>)</mo><mo>+</mo><mo>(</mo><mn>1</mn><mo>âˆ’</mo><msub><mi>Z</mi><mi>i</mi></msub><mo>)</mo><msub><mi>Y</mi><mi>i</mi></msub><mo>(</mo><mn>0</mn><mo>)</mo></mrow><annotation encoding="application/x-tex">Y_i = Z_iY_i(1) +  (1-Z_i) Y_i(0)
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.22222em;">Y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.22222em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.07153em;">Z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.22222em;">Y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.22222em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord">1</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.07153em;">Z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.22222em;">Y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.22222em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord">0</span><span class="mclose">)</span></span></span></span></span></p>
<h2 id="11-causal-effect">1.1 Causal effect</h2>
<ul>
<li>
<p><strong>ä¸å¯è§‚æµ‹çš„ ä¸ªä½“å› æœä½œç”¨ (ICE)</strong></p>
<p>ICE: individual Causal effectï¼Œä¸ªä½“içš„å› æœä½œç”¨ causal effect :</p>
<p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>I</mi><mi>C</mi><mi>E</mi><mo>=</mo><msub><mi>Y</mi><mi>i</mi></msub><mo>(</mo><mn>1</mn><mo>)</mo><mo>âˆ’</mo><msub><mi>Y</mi><mi>i</mi></msub><mo>(</mo><mn>0</mn><mo>)</mo></mrow><annotation encoding="application/x-tex">ICE = Y_i(1) -Y_i(0)
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.07847em;">I</span><span class="mord mathdefault" style="margin-right:0.07153em;">C</span><span class="mord mathdefault" style="margin-right:0.05764em;">E</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.22222em;">Y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.22222em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord">1</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.22222em;">Y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.22222em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord">0</span><span class="mclose">)</span></span></span></span></span></p>
<p>è€Œå®éªŒä¸­çš„ä¸ªä½“è¦ä¹ˆæ¥å—å¤„ç†ï¼Œè¦ä¹ˆæ¥å—å¯¹ç…§ï¼Œæˆ‘ä»¬åªèƒ½è§‚æµ‹<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>Y</mi><mi>i</mi></msub><mo>(</mo><mn>1</mn><mo>)</mo></mrow><annotation encoding="application/x-tex">Y_i(1)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.22222em;">Y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.22222em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord">1</span><span class="mclose">)</span></span></span></span> æˆ–è€…<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>Y</mi><mi>i</mi></msub><mo>(</mo><mn>0</mn><mo>)</mo></mrow><annotation encoding="application/x-tex">Y_i(0)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.22222em;">Y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.22222em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord">0</span><span class="mclose">)</span></span></span></span>ï¼Œä¾¿æ— æ³•è®¡ç®—å…¶å› æœä½œç”¨ï¼Œè¿™æ˜¯å› æœæ¨æ–­çš„åŸºæœ¬é—®é¢˜ã€‚</p>
</li>
<li>
<p><strong>å¯è¯†åˆ«çš„ å¹³å‡å› æœä½œç”¨ (ACE)</strong></p>
<p>ACE: average Causal effectï¼Œ å®šä¹‰ä¸ºä¸ªä½“å› æœä½œç”¨çš„æœŸæœ›ï¼š</p>
<p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>A</mi><mi>C</mi><mi>E</mi><mo>=</mo><mi>E</mi><mo>(</mo><mi>I</mi><mi>C</mi><mi>E</mi><mo>)</mo><mo>=</mo><mi>E</mi><mo>(</mo><mi>Y</mi><mn>1</mn><mi mathvariant="normal">âˆ’</mi><mi>Y</mi><mn>0</mn><mo>)</mo><mo>=</mo><mi>E</mi><mo>(</mo><msub><mi>Y</mi><mn>1</mn></msub><mo>)</mo><mo>âˆ’</mo><mi>E</mi><mo>(</mo><msub><mi>Y</mi><mn>0</mn></msub><mo>)</mo></mrow><annotation encoding="application/x-tex">ACE = E(ICE) = E(Y1 âˆ’Y0) = E(Y_1) - E(Y_0) 
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault">A</span><span class="mord mathdefault" style="margin-right:0.07153em;">C</span><span class="mord mathdefault" style="margin-right:0.05764em;">E</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.05764em;">E</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.07847em;">I</span><span class="mord mathdefault" style="margin-right:0.07153em;">C</span><span class="mord mathdefault" style="margin-right:0.05764em;">E</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.05764em;">E</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.22222em;">Y</span><span class="mord">1</span><span class="mord">âˆ’</span><span class="mord mathdefault" style="margin-right:0.22222em;">Y</span><span class="mord">0</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.05764em;">E</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.22222em;">Y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.22222em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.05764em;">E</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.22222em;">Y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.22222em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span></p>
<p>å…¶ä¸­<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>Y</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">Y_1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.22222em;">Y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.22222em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>è¡¨ç¤ºä¸ªä½“æ¥å—å¤„ç†ä¹‹åçš„æ½œåœ¨ç»“æœï¼Œå…¶æœŸæœ›å¯ä»¥ç”±<em>æ‰€æœ‰ä¸ªä½“éƒ½æ¥å—å¤„ç†çš„æ½œåœ¨ç»“æœçš„å‡å€¼</em>æ¥ä¼°è®¡ã€‚<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>Y</mi><mn>0</mn></msub></mrow><annotation encoding="application/x-tex">Y_0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.22222em;">Y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.22222em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>åŒç†ã€‚</p>
</li>
</ul>
<p>ä½†æ˜¯åœ¨å®é™…ä¸­ï¼Œæˆ‘ä»¬ä¸å¯èƒ½è®©æ‰€æœ‰çš„ä¸ªä½“éƒ½æ¥å—å¤„ç†ã€‚æˆ‘ä»¬åˆ†é…å®éªŒç»„å’Œå¯¹ç…§ç»„ï¼Œè€Œå½“ Z åšéšæœºåŒ–çš„å‰æä¸‹æœ‰ <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>E</mi><mo>(</mo><msub><mi>Y</mi><mn>1</mn></msub><mo>)</mo><mo>=</mo><mi>E</mi><mo>(</mo><mi>Y</mi><mi mathvariant="normal">âˆ£</mi><mi>Z</mi><mo>=</mo><mn>1</mn><mo>)</mo><mo separator="true">,</mo><mi>E</mi><mo>(</mo><msub><mi>Y</mi><mn>0</mn></msub><mo>)</mo><mo>=</mo><mi>E</mi><mo>(</mo><mi>Y</mi><mi mathvariant="normal">âˆ£</mi><mi>Z</mi><mo>=</mo><mn>0</mn><mo>)</mo></mrow><annotation encoding="application/x-tex">E(Y_1)  = E(Y|Z =1 ) ,E(Y_0)  = E(Y|Z = 0)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.05764em;">E</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.22222em;">Y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.22222em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.05764em;">E</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.22222em;">Y</span><span class="mord">âˆ£</span><span class="mord mathdefault" style="margin-right:0.07153em;">Z</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">)</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.05764em;">E</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.22222em;">Y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.22222em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.05764em;">E</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.22222em;">Y</span><span class="mord">âˆ£</span><span class="mord mathdefault" style="margin-right:0.07153em;">Z</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">0</span><span class="mclose">)</span></span></span></span>ã€‚æ­¤æ—¶ä¸ªä½“æ˜¯å¦å¤„ç†ä¸æ½œåœ¨ç»“æœæ— å…³ï¼Œæ€»ä½“çš„å¹³å‡å› æœä½œç”¨å¯è¯†åˆ«ï¼ˆå¯è¯†åˆ«è¡¨ç¤ºå› æœä½œç”¨å¯ä»¥ç”¨<strong>è§‚æµ‹æ•°æ®çš„åˆ†å¸ƒå”¯ä¸€çš„è¡¨ç¤º</strong>ï¼‰:</p>
<p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>A</mi><mi>C</mi><mi>E</mi><mo>(</mo><mi mathvariant="normal">éš</mi><mi mathvariant="normal">æœº</mi><mi mathvariant="normal">åŒ–</mi><mi mathvariant="normal">è¯•</mi><mi mathvariant="normal">éªŒ</mi><mi mathvariant="normal">ä¸‹</mi><mo>)</mo><mo>=</mo><mi>E</mi><mo>(</mo><mi>Y</mi><mi mathvariant="normal">âˆ£</mi><mi>Z</mi><mo>=</mo><mn>1</mn><mo>)</mo><mi mathvariant="normal">âˆ’</mi><mi>E</mi><mo>(</mo><mi>Y</mi><mi mathvariant="normal">âˆ£</mi><mi>Z</mi><mo>=</mo><mn>0</mn><mo>)</mo></mrow><annotation encoding="application/x-tex">ACE  (éšæœºåŒ–è¯•éªŒä¸‹) = E(Y |Z = 1) âˆ’ E(Y |Z= 0)
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">A</span><span class="mord mathdefault" style="margin-right:0.07153em;">C</span><span class="mord mathdefault" style="margin-right:0.05764em;">E</span><span class="mopen">(</span><span class="mord cjk_fallback">éš</span><span class="mord cjk_fallback">æœº</span><span class="mord cjk_fallback">åŒ–</span><span class="mord cjk_fallback">è¯•</span><span class="mord cjk_fallback">éªŒ</span><span class="mord cjk_fallback">ä¸‹</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.05764em;">E</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.22222em;">Y</span><span class="mord">âˆ£</span><span class="mord mathdefault" style="margin-right:0.07153em;">Z</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">)</span><span class="mord">âˆ’</span><span class="mord mathdefault" style="margin-right:0.05764em;">E</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.22222em;">Y</span><span class="mord">âˆ£</span><span class="mord mathdefault" style="margin-right:0.07153em;">Z</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">0</span><span class="mclose">)</span></span></span></span></span></p>
<h2 id="12-éšæœºåŒ–è¯•éªŒçš„ç†æƒ³ä¸ç°å®">1.2 éšæœºåŒ–è¯•éªŒçš„ç†æƒ³ä¸ç°å®</h2>
<h3 id="ç†æƒ³å¯å¿½ç•¥çš„åˆ†é…æœºåˆ¶">ç†æƒ³ï¼šå¯å¿½ç•¥çš„åˆ†é…æœºåˆ¶</h3>
<p>éšæœºåŒ–è¯•éªŒå¯¹äºå¹³å‡å› æœä½œç”¨çš„è¯†åˆ«èµ·ç€è‡³å…³é‡è¦çš„ä½œç”¨ã€‚åœ¨æœ‰åå˜é‡çš„éšæœºåŒ–è¯•éªŒä¸­ï¼Œå¹³å‡å› æœä½œç”¨æ˜¯å¯è¯†åˆ«çš„è¦æ±‚ï¼š</p>
<p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>Z</mi><mi mathvariant="normal">âŠ¥</mi><mrow><mi>Y</mi><mo>(</mo><mn>1</mn><mo>)</mo><mo separator="true">,</mo><mi>Y</mi><mo>(</mo><mn>0</mn><mo>)</mo></mrow><mi mathvariant="normal">âˆ£</mi><mi>X</mi></mrow><annotation encoding="application/x-tex">ZâŠ¥{Y(1),Y(0)} | X
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.07153em;">Z</span><span class="mord">âŠ¥</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.22222em;">Y</span><span class="mopen">(</span><span class="mord">1</span><span class="mclose">)</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.22222em;">Y</span><span class="mopen">(</span><span class="mord">0</span><span class="mclose">)</span></span><span class="mord">âˆ£</span><span class="mord mathdefault" style="margin-right:0.07847em;">X</span></span></span></span></span></p>
<p>å³ç»™å®šåå˜é‡X åï¼Œå¤„ç†çš„åˆ†é…æœºåˆ¶æ˜¯å®Œå…¨éšæœºåŒ–çš„ï¼Œè¿™è¢«å«åšâ€œå¯å¿½ç•¥æ€§â€ã€‚è¿™é‡Œå¼•å‡ºäº†å› æœæ¨æ–­é—®é¢˜æœ€é‡è¦çš„ä¸€æ­¥ï¼Œå°±æ˜¯å¯¹å¯¹ç…§ç»„å’Œå®éªŒç»„çš„å¹³è¡¡è¿›è¡Œæ£€æµ‹ã€‚</p>
<h3 id="ç°å®æ··æ‚åå€š">ç°å®ï¼šæ··æ‚åå€š</h3>
<p>å½“åå˜é‡çš„åˆ†å¸ƒåœ¨å¤„ç†ç»„å’Œå¯¹ç…§ç»„å‡è¡¡æ—¶ï¼Œåˆ™æˆ‘ä»¬åœ¨åå˜é‡å–å€¼çš„æ¯ä¸€å±‚ï¼Œ éƒ½èƒ½å¾—åˆ°è¯¥å±‚å¹³å‡å› æœä½œç”¨çš„ç›¸åˆä¼°è®¡ã€‚å½“åå˜é‡çš„åˆ†å¸ƒåœ¨å¤„ç†ç»„å’Œå¯¹ç…§ç»„å‡è¡¡æ—¶ï¼Œå°±ä¼šå‡ºç°ä¸åŒå±‚ç»“æœä¸ä¸€è‡´ç”šè‡³æˆªç„¶ç›¸åçš„çŸ›ç›¾ã€‚ä¸ºäº†æ¶ˆé™¤åå˜é‡çš„åˆ†å¸ƒåœ¨å¤„ç†ç»„ä¸å¯¹ç…§ç»„ä¹‹é—´çš„å·®å¼‚ï¼Œæœ€åŸºç¡€çš„æ–¹æ³•å°±æ˜¯ï¼š</p>
<h2 id="13-matching-ä¸-å€¾å‘å¾—åˆ†">1.3 Matching  ä¸ å€¾å‘å¾—åˆ†</h2>
<p>ç®€å•çš„æƒ³æ³•å°±æ˜¯ä»å¯¹ç…§ç»„ä¸­æ‰¾åˆ°å’Œå¤„ç†ç»„ä¸­æ¯”è¾ƒâ€œæ¥è¿‘â€ çš„ä¸ªä½“è¿›è¡ŒåŒ¹é…ï¼Œè¿™æ ·å¾—å‡ºçš„ä½œç”¨ï¼Œå¯ä»¥è¿‘ä¼¼å¹³å‡å› æœä½œç”¨ï¼Œâ€œæ¥è¿‘â€çš„æ ‡å‡†æ˜¯åŸºäºè§‚æµ‹åå˜é‡çš„ã€‚å¦‚æœè§‚æµ‹åå˜é‡çš„ç»´æ•°è¾ƒé«˜ï¼ŒåŒ¹é…å°±å¾ˆéš¾å®ç°äº†ã€‚</p>
<p>æ­¤æ—¶å¯ä»¥ä½¿ç”¨å€¾å‘å¾—åˆ†åŒ¹é…ã€‚å€¾å‘å¾—åˆ† ( propensity score ) å®šä¹‰ä¸ºæ¡ä»¶æ¦‚ç‡:<br>
<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>p</mi><mo>(</mo><mi>Z</mi><mo>=</mo><mn>1</mn><mi mathvariant="normal">âˆ£</mi><mi>X</mi><mo>)</mo></mrow><annotation encoding="application/x-tex">p(Z = 1|X)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">p</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.07153em;">Z</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mord">âˆ£</span><span class="mord mathdefault" style="margin-right:0.07847em;">X</span><span class="mclose">)</span></span></span></span>ï¼Œä¸éš¾çœ‹å‡ºå¯ä»¥ç”¨ logistic å›å½’ç®—å‡ºå€¾å‘å¾—åˆ†ã€‚éšåå¯ä»¥æ ¹æ®å®ƒåˆ†å±‚/åŠ æƒï¼Œå¾—åˆ°å„å±‚/æ€»ä½“åŠ æƒå¹³å‡å› æœæ•ˆåº”çš„ä¼°è®¡ã€‚</p>
<p>è¿™é‡Œï¼Œç”¨ä¸€ä¸ªæ€§åˆ«åå˜é‡ä¸å¹³è¡¡å¯¼è‡´çš„<strong>è¾›æ™®æ£®æ‚–è®º</strong>ä½œä¸ºä¾‹å­ï¼š</p>
<figure data-type="image" tabindex="1"><img src="https://uploads.cosx.org/2012/03/simpson.png" alt="" loading="lazy"></figure>
<pre><code>Yï¼šç»“æœå˜é‡ï¼Œsurvive / dieï¼ˆåˆ™ E(Y) = P(Y=1) = survive rate ï¼‰
Zï¼šéšæœºåˆ†ç»„å˜é‡ï¼Œtreatment / control
Xï¼šåå˜é‡ï¼Œmale / female
--
1.å¦‚æœä¸è€ƒè™‘åå˜é‡æ€§åˆ«çš„åœ¨åˆ†ç»„ä¸­çš„ä¸å¹³è¡¡é—®é¢˜ï¼Œç›´æ¥å¯¹ç”·å¥³æ€»ä½“è¿›è¡Œä¼°è®¡ï¼š
ACE = E(y|z=1) - E(y|z=0) =  p(y=1|z=1) - p(y=1|z=0) = 0.5-0.4 = 0.1
-- 
2.å¦‚æœè€ƒè™‘åˆ†ç»„ä¸å¹³è¡¡ï¼ŒæŒ‰ç…§åå˜é‡æ€§åˆ«è¿›è¡ŒåŠ æƒè°ƒæ•´ï¼š
ACE = (p(y=1|z=1, x=1) - p(y=1|z=0, x=1))*p(x=1) + 
			(p(y=1|z=1, x=0) - p(y=1|z=0, x=0))*p(x=0) 
		= (0.6-0.7)*0.5 + (0.2-0.3)*0.5
		= -0.1
-- 
æ˜¯å¦æ ¹æ®æ€§åˆ«è¿›è¡Œè°ƒæ•´ï¼Œå¾—åˆ°çš„ç»“æœå®Œå…¨ç›¸å
</code></pre>
<h1 id="2-å› æœå›¾-causal-diagram">2. å› æœå›¾ (Causal Diagram)</h1>
<h2 id="21-å›¾æ¨¡å‹åŸºæœ¬æ¦‚å¿µ">2.1 å›¾æ¨¡å‹åŸºæœ¬æ¦‚å¿µ</h2>
<p>å›¾æ¨¡å‹çš„æ¦‚å¿µè¿™éƒ¨åˆ†åœ¨æ•°æ®ç»“æ„æœ‰æ‰€æ¥è§¦ï¼Œ<a href="http://localhost:4000/post/py1015-2/">è¿™é‡Œå›é¡¾ä¸€ä¸‹</a></p>
<p>å…¶ä¸­é‡ç‚¹åœ¨äºDAGï¼ˆæœ‰å‘æ— ç¯å›¾ï¼‰/å›¾æ¨¡å‹/è´å¶æ–¯ç½‘ç»œ</p>
<figure data-type="image" tabindex="2"><img src="https://cloud.githubusercontent.com/assets/18478302/25562044/03151afa-2dad-11e7-94c8-c5826f17d063.png" alt="" loading="lazy"></figure>
<p>åœ¨è¿™å¼ å›¾ä¸­ï¼Œx1...xjçš„è”åˆåˆ†å¸ƒå¯ä»¥æ ¹æ®å…¨æ¦‚ç‡å…¬å¼åšå¦‚ä¸‹çš„é€’å½’åˆ†è§£ï¼š</p>
<p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>P</mi><mo>(</mo><msub><mi>X</mi><mn>1</mn></msub><mo separator="true">,</mo><msub><mi>X</mi><mn>2</mn></msub><mo separator="true">,</mo><msub><mi>X</mi><mn>3</mn></msub><mo separator="true">,</mo><msub><mi>X</mi><mn>4</mn></msub><mo separator="true">,</mo><msub><mi>X</mi><mn>5</mn></msub><mo separator="true">,</mo><msub><mi>X</mi><mn>6</mn></msub><mo separator="true">,</mo><msub><mi>X</mi><mi>i</mi></msub><mo separator="true">,</mo><msub><mi>X</mi><mi>j</mi></msub><mo>)</mo><mo>=</mo><mi>P</mi><mo>(</mo><msub><mi>X</mi><mn>1</mn></msub><mo>)</mo><mo>(</mo><msub><mi>X</mi><mn>2</mn></msub><mo>)</mo><mi>P</mi><mo>(</mo><msub><mi>X</mi><mn>3</mn></msub><mi mathvariant="normal">âˆ£</mi><msub><mi>X</mi><mn>1</mn></msub><mo>)</mo><mi>P</mi><mo>(</mo><msub><mi>X</mi><mn>5</mn></msub><mi mathvariant="normal">âˆ£</mi><msub><mi>X</mi><mn>2</mn></msub><mo>)</mo><mi>P</mi><mo>(</mo><msub><mi>X</mi><mn>4</mn></msub><mi mathvariant="normal">âˆ£</mi><msub><mi>X</mi><mn>1</mn></msub><mo separator="true">,</mo><msub><mi>X</mi><mn>2</mn></msub><mo>)</mo><mi>P</mi><mo>(</mo><msub><mi>X</mi><mi mathvariant="normal">âˆ£</mi></msub><msub><mi>X</mi><mn>3</mn></msub><mo separator="true">,</mo><msub><mi>X</mi><mn>4</mn></msub><mo>)</mo><mi>P</mi><mo>(</mo><msub><mi>X</mi><mn>6</mn></msub><mi mathvariant="normal">âˆ£</mi><msub><mi>X</mi><mi>i</mi></msub><mo>)</mo><mi>P</mi><mo>(</mo><msub><mi>X</mi><mi>j</mi></msub><mi mathvariant="normal">âˆ£</mi><msub><mi>X</mi><mn>4</mn></msub><mo separator="true">,</mo><msub><mi>X</mi><mn>5</mn></msub><mo separator="true">,</mo><msub><mi>X</mi><mn>6</mn></msub><mo>)</mo></mrow><annotation encoding="application/x-tex">P(X_1, X_2, X_3, X_4, X_5, X_6, X_i, X_j) = P(X_1)(X_2)P(X_3|X_1) P(X_5|X_2)P(X_4| X_1, X_2)P(X_|X_3, X_4)  P(X_6|X_i) P(X_j|X_4, X_5, X_6)
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.036108em;vertical-align:-0.286108em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.07847em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.07847em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.07847em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.07847em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">4</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.07847em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">5</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.07847em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">6</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.07847em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:-0.07847em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.1052em;vertical-align:-0.3551999999999999em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.07847em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.07847em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.07847em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord">âˆ£</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.07847em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.07847em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">5</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord">âˆ£</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.07847em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.07847em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">4</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord">âˆ£</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.07847em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.07847em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.34480000000000005em;"><span style="top:-2.5198em;margin-left:-0.07847em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">âˆ£</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.3551999999999999em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.07847em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.07847em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">4</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.07847em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">6</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord">âˆ£</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.07847em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:-0.07847em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mord">âˆ£</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.07847em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">4</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.07847em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">5</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.07847em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">6</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span></p>
<p>ã€æ³¨æ„ç‚¹ã€‘ä¸€ä¸ªæœ‰å‘æ— ç¯å›¾å”¯ä¸€åœ°å†³å®šäº†ä¸€ä¸ªè”åˆåˆ†å¸ƒï¼›åè¿‡æ¥ï¼Œä¸€ä¸ªè”åˆåˆ†å¸ƒä¸èƒ½å”¯ä¸€åœ°å†³å®šæœ‰å‘æ— ç¯å›¾ï¼ˆå› ä¸ºä¹˜æ³•å…¬å¼çš„ä¸å”¯ä¸€ï¼‰</p>
<h2 id="22-ç»“æ„æ–¹ç¨‹æ¨¡å‹">2.2 ç»“æ„æ–¹ç¨‹æ¨¡å‹</h2>
<p><strong>structural equation model: SEM</strong></p>
<p>SEM æ˜¯å› æœå›¾çš„å…ˆé©±ã€‚å…·ä½“æ¥è¯´ç»“æ„æ–¹ç¨‹æ¨¡å‹å’Œå›¾æ¨¡å‹ä¹‹é—´çš„å…³ç³»ï¼š</p>
<ul>
<li>åŸå› Zâ€”â€”çˆ¶èŠ‚ç‚¹ï¼Œç»“æœYâ€”â€”å­èŠ‚ç‚¹ï¼Œé—´æ¥åŸå› Xâ€”â€”Zçš„çˆ¶èŠ‚</li>
<li>å¤–ç”Ÿå˜é‡ï¼šæ ¹èŠ‚ç‚¹</li>
<li>å†…ç”Ÿå˜é‡ï¼šå­èŠ‚ç‚¹</li>
<li>è¾¹ï¼šå‡½æ•°å…³ç³»</li>
</ul>
<p>e.g. U = {X æ•™è‚²ç¨‹åº¦ï¼ŒY ç»éªŒ}  ï¼Œ  V = {Z å·¥èµ„}</p>
<p><strong>ã€æ³¨æ„ç‚¹ã€‘å› æœå…³ç³»&amp;ç»Ÿè®¡ç›¸å…³æ€§ï¼šäº’ç›¸éƒ½ä¸èƒ½æ¨å‡ºå¦ä¸€æ–¹</strong></p>
<h2 id="23-v-structure">2.3 V structure</h2>
<p>ä¸åŒç»“æ„ä¸‹ï¼Œå¦‚ä½•å¿«é€Ÿåˆ¤æ–­æ¡ä»¶ç‹¬ç«‹æ€§</p>
<ol>
<li>
<p><strong>é“¾å¼ç»“æ„</strong>ï¼ˆchainï¼‰</p>
<p>X å’Œ Zä¹‹é—´é€šè¿‡Yç›¸è¿â€”â€”åˆ™ç»™å®šYæ—¶ï¼ŒZå’ŒXç‹¬ç«‹ã€‚condition åœ¨å“ªå„¿ç›¸å½“äºåˆ‡æ–­æ­¤å¤„å’Œå‘¨å›´çš„æ‰€æœ‰çš„è¿æ¥ã€‚å¯ä»¥åˆ©ç”¨è¿™ä¸ªæ¥<strong>è§£é‡Šè¾›æ™®æ£®æ‚–è®º</strong>ï¼š<br>
<img src="https://yangggshuyi.github.io/post-images/1615037603717.jpg" alt="" loading="lazy"></p>
<p>Xæ˜¯é’ˆå¯¹æŸä¸€ç§ç–¾ç—…çš„è¯ç‰©ï¼Œå¯ä»¥ä¿ƒè¿›Yçš„æ¢å¤ã€‚å…·ä½“æ¥è¯´ï¼Œä½¿ç”¨Xå¯ä»¥å¸®åŠ©è°ƒèŠ‚è¡€å‹Zï¼Œä»è€Œä¿ƒè¿›Yçš„æ¢å¤<u>ã€‚ä½†å½“æˆ‘ä»¬æ§åˆ¶/condition on Zæ—¶ï¼Œç›¸å½“äºåˆ‡æ–­æ­¤å¤„çš„æ‰€æœ‰è¿æ¥</u>ï¼Œåªçœ‹Xå¯¹Yçš„ç›´æ¥å½±å“ï¼ˆå‰¯ä½œç”¨ï¼‰ï¼Œç»“æœåˆ™æ˜¯æŠ‘åˆ¶æ¢å¤ã€‚</p>
</li>
<li>
<p><strong>å‰çŠ¶ç»“æ„ï¼ˆforkï¼‰</strong></p>
<p>Xæ˜¯çš„å¯¼è‡´Yå’ŒZçš„å…±åŒåŸå› ï¼ŒY å’Œ Z æ˜¯ç›¸å…³çš„â€”â€”conditionalåœ¨Xä¸Šï¼ŒYå’ŒZç‹¬ç«‹ã€‚å¯ä»¥åˆ©ç”¨è¿™ä¸ªæ¥<strong>è§£é‡Šè¾›æ™®æ£®æ‚–è®º</strong>ï¼š</p>
</li>
</ol>
<p><img src="https://yangggshuyi.github.io/post-images/1615037607834.jpg" alt="" loading="lazy"><br>
æ¯”å¦‚Xï¼šageï¼ŒYï¼šexercieï¼ŒZï¼šèƒ†å›ºé†‡å«é‡ã€‚ç›´æ¥çœ‹Yå’ŒZä¹‹é—´çš„å…³ç³»ï¼Œexercise æé«˜èƒ†å›ºé†‡å«é‡å¢åŠ ã€‚è€ŒåŠ ä¸Š condition X æ—¶ï¼Œæ¯ä¸ªå¹´é¾„æ®µå†… exercise æé«˜èƒ†å›ºé†‡å«é‡é™ä½ã€‚ï¼ˆwhyï¼Œå¹´é¾„Xå¯¹exercise Y å’Œ èƒ†å›ºé†‡å«é‡ Z éƒ½æœ‰å½±å“ï¼Œå¹´é¾„å¢åŠ exercise å¢å¤šï¼Œèƒ†å›ºé†‡ä¹Ÿå¢å¤šï¼‰</p>
<p>å¦ä¸€ä¸ªå¤¸å¼ çš„ä¾‹å­ï¼Œç©¿ç€é‹ç¡è§‰å’Œé†’æ¥å¤´ç—›ä¹‹é—´æœ‰å¼ºçƒˆç›¸å…³å…³ç³»ï¼Œè€Œcondition on å®¿é†‰æ—¶ï¼Œä¸¤è€…ç‹¬ç«‹ã€‚</p>
<ol start="3">
<li>
<p><strong>å¯¹æ’ç»“æ„ï¼ˆcolliderï¼‰</strong></p>
<p>X å’Œ Y æ˜¯å¯¼è‡´ Z çš„å…±åŒåŸå› ã€‚åˆ™ X å’Œ Y ç‹¬ç«‹ï¼Œä½†å½“ <strong>condition åœ¨ Z æˆ–è€… Zçš„åç»§èŠ‚ç‚¹ä¸Š</strong>ï¼Œåˆ™ åŸæœ¬ç‹¬ç«‹çš„ X å’Œ Y å˜ä¸ºç›¸å…³ã€‚</p>
<p>æ¯”å¦‚æ™ºåŠ›å’Œè¯•é¢˜éš¾åº¦å…±åŒå†³å®šæˆç»©é«˜ä½ï¼Œé¦–å…ˆæ™ºåŠ›å’Œéš¾åº¦æ˜¯ç‹¬ç«‹çš„ï¼Œä½†å½“ condition æˆç»©æ—¶ï¼Œä¸¤è€…å‡ºç°ç›¸å…³ã€‚å·²çŸ¥æˆç»©ä½ï¼Œå¦‚æœæ™ºåŠ›é«˜åˆ™è¯´æ˜è¯•é¢˜éš¾åº¦é«˜ã€‚å·²çŸ¥æˆç»©é«˜ï¼Œå¦‚æœéš¾åº¦é«˜è¯´æ˜æ™ºåŠ›ä¹Ÿé«˜ã€‚</p>
</li>
<li>
<p><strong>d åˆ†ç¦» (d - separation)</strong></p>
<p>å®šä¹‰ï¼ˆ<strong>d åˆ†ç¦»</strong>ï¼‰: è®¾ <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>X</mi></mrow><annotation encoding="application/x-tex">X</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.07847em;">X</span></span></span></span>ï¼Œ<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>Y</mi></mrow><annotation encoding="application/x-tex">Y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.22222em;">Y</span></span></span></span>ï¼Œ<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>Z</mi></mrow><annotation encoding="application/x-tex">Z</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.07153em;">Z</span></span></span></span> æ˜¯ DAG ä¸­ä¸ç›¸äº¤çš„èŠ‚ç‚¹é›†åˆï¼Œ<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>Ï€</mi></mrow><annotation encoding="application/x-tex">\pi</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.03588em;">Ï€</span></span></span></span> ä¸ºä¸€æ¡è¿æ¥ <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>X</mi></mrow><annotation encoding="application/x-tex">X</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.07847em;">X</span></span></span></span> ä¸­æŸèŠ‚ç‚¹åˆ° <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>Y</mi></mrow><annotation encoding="application/x-tex">Y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.22222em;">Y</span></span></span></span> ä¸­æŸèŠ‚ç‚¹çš„è·¯å¾„ ï¼ˆä¸ç®¡æ–¹å‘ï¼‰ã€‚å¦‚æœè·¯å¾„ <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>Ï€</mi></mrow><annotation encoding="application/x-tex">\pi</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.03588em;">Ï€</span></span></span></span> ä¸ŠæŸèŠ‚ç‚¹æ»¡è¶³å¦‚ä¸‹çš„æ¡ä»¶ï¼š</p>
</li>
</ol>
<p>ï¼ˆ1ï¼‰åœ¨è·¯å¾„<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>Ï€</mi></mrow><annotation encoding="application/x-tex">\pi</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.03588em;">Ï€</span></span></span></span> ï¼Œ<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>w</mi></mrow><annotation encoding="application/x-tex">w</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.02691em;">w</span></span></span></span> ç‚¹å¤„ä¸º <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>V</mi></mrow><annotation encoding="application/x-tex">V</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.22222em;">V</span></span></span></span> ç»“æ„ ï¼ˆæˆ–ç§°å†²æ’ç‚¹ï¼Œcolliderï¼‰ï¼Œä¸” <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>w</mi></mrow><annotation encoding="application/x-tex">w</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.02691em;">w</span></span></span></span> åŠå…¶åä»£ä¸åœ¨ <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>Z</mi></mrow><annotation encoding="application/x-tex">Z</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.07153em;">Z</span></span></span></span> ä¸­ï¼›</p>
<p>ï¼ˆ2ï¼‰åœ¨è·¯å¾„ <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>Ï€</mi></mrow><annotation encoding="application/x-tex">\pi</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.03588em;">Ï€</span></span></span></span> ä¸Šï¼Œ<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>w</mi></mrow><annotation encoding="application/x-tex">w</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.02691em;">w</span></span></span></span> ç‚¹å¤„ä¸æ˜¯ <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>V</mi></mrow><annotation encoding="application/x-tex">V</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.22222em;">V</span></span></span></span> ç»“æ„ï¼Œä¸” <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>w</mi></mrow><annotation encoding="application/x-tex">w</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.02691em;">w</span></span></span></span> åœ¨ <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>Z</mi></mrow><annotation encoding="application/x-tex">Z</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.07153em;">Z</span></span></span></span> ä¸­,</p>
<p>é‚£ä¹ˆç§° <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>Z</mi></mrow><annotation encoding="application/x-tex">Z</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.07153em;">Z</span></span></span></span> é˜»æ–­ (block) äº†è·¯å¾„ <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>Ï€</mi></mrow><annotation encoding="application/x-tex">\pi</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.03588em;">Ï€</span></span></span></span>ã€‚è¿›ä¸€æ­¥ï¼Œå¦‚æœ <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>Z</mi></mrow><annotation encoding="application/x-tex">Z</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.07153em;">Z</span></span></span></span> é˜»æ–­äº† <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>X</mi></mrow><annotation encoding="application/x-tex">X</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.07847em;">X</span></span></span></span> åˆ° <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>Y</mi></mrow><annotation encoding="application/x-tex">Y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.22222em;">Y</span></span></span></span> çš„æ‰€æœ‰è·¯å¾„ï¼Œé‚£ä¹ˆç§° <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>Z</mi></mrow><annotation encoding="application/x-tex">Z</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.07153em;">Z</span></span></span></span> <strong>dåˆ†ç¦»</strong> <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>X</mi></mrow><annotation encoding="application/x-tex">X</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.07847em;">X</span></span></span></span> å’Œ <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>Y</mi></mrow><annotation encoding="application/x-tex">Y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.22222em;">Y</span></span></span></span>ï¼Œè®°ä¸º <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo>(</mo><mi>X</mi><mi mathvariant="normal">âŠ¥</mi><mi>Y</mi><mi mathvariant="normal">âˆ£</mi><mi>Z</mi><msub><mo>)</mo><mi>G</mi></msub></mrow><annotation encoding="application/x-tex">(X\bot Y|Z)_{G}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.07847em;">X</span><span class="mord">âŠ¥</span><span class="mord mathdefault" style="margin-right:0.22222em;">Y</span><span class="mord">âˆ£</span><span class="mord mathdefault" style="margin-right:0.07153em;">Z</span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">G</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>ã€‚</p>
<blockquote>
<p>å¦‚ä½•ç›´è§‚ç†è§£dåˆ†ç¦»ï¼Ÿç”¨ä¸€ä¸ªä¾‹å­ï¼š</p>
</blockquote>
<figure data-type="image" tabindex="3"><img src="https://yangggshuyi.github.io/post-images/1615037481472.jpg" alt="" loading="lazy"></figure>
<pre><code>åœ¨è¿™æ ·çš„ä¸€ä¸ªDAGä¸­ï¼Œè§‚å¯Ÿåˆ°ä¸Šæ–¹æ˜¯ fork ç»“æ„ï¼Œä¸­é—´æ˜¯ chain ç»“æ„ï¼Œä¸‹æ–¹æ˜¯ collider ç»“æ„ã€‚
æ‰¾åˆ°èƒ½å¤Ÿ block ä» T åˆ° Y æ‰€æœ‰è·¯å¾„çš„æ–¹å¼å¦‚ä¸‹ï¼š
- M1 + W1/W2/W3ï¼ˆé˜»æ–­fork&amp;chain, collider ä¸åŠ¨ï¼Œå¯¹äºï¼ˆ2ï¼‰çš„æƒ…å†µï¼‰
- M1 + W1/W2/W3 + X2 + X1/X3ï¼ˆåªæœ‰ X2 è®©ä¸‹æ–¹çš„collider çˆ¶èŠ‚ç‚¹ç›¸å…³ï¼ŒåŠ ä¸ŠX1æˆ–X3ä¹‹å T å’Œ Y ç‹¬ç«‹äº†ã€‚
</code></pre>
<h2 id="24-ä»dagåˆ°å› æœå›¾">2.4 ä»DAGåˆ°å› æœå›¾</h2>
<h3 id="do-operator">do-operator</h3>
<blockquote>
<p>â€œå¹²é¢„â€ vs â€œæ¡ä»¶â€</p>
</blockquote>
<p>ç†è§£Doç®—å­ï¼Œä»<strong>å¹²é¢„</strong>ï¼ˆintervening) å’Œ<strong>æ¡ä»¶</strong> (conditioning) çš„æ¦‚å¿µå…³ç³»æ¥ç†è§£ã€‚ä¸¤ä¸ªæ¦‚å¿µéå¸¸éå¸¸æ¥è¿‘ï¼Œåœ¨å›¾æ¨¡å‹ä¸­éƒ½ç›¸å½“äºåˆ‡æ–­æŸå¤„çš„æ‰€æœ‰è¿æ¥ï¼Œå¹¶ä¸”å°†å…¶å–å€¼çœ‹åšå¸¸æ•°ã€‚ä½†æ˜¯åŒºåˆ«åœ¨äºï¼Œå½“æˆ‘ä»¬å¼•å…¥â€œå› æœâ€çš„æ¦‚å¿µåï¼Œ<u><strong>å½“æˆ‘ä»¬å¹²é¢„â€œç»“æœâ€ï¼Œå¹¶ä¸ä¼šå½±å“â€œåŸå› â€çš„åˆ†å¸ƒï¼Œä½†æ˜¯å½“ condition on â€œç»“æœâ€çš„æ—¶å€™ï¼Œâ€œåŸå› â€çš„æ¡ä»¶åˆ†å¸ƒä¼šæ”¹å˜</strong></u>ã€‚</p>
<figure data-type="image" tabindex="4"><img src="https://cloud.githubusercontent.com/assets/18478302/25562057/8e81e640-2dad-11e7-8a97-c79ef34f169e.png" alt="" loading="lazy"></figure>
<p>åœ¨ä¸Šå›¾çš„ä¾‹å­ä¸­ï¼Œçœ‹æ¡ä»¶å’Œå¹²é¢„çš„åŒºåˆ«ï¼š</p>
<ul>
<li>A.æ¡ä»¶ p(X1|x2)
<ul>
<li>æ— è®ºX1å’ŒX2çš„å› æœå…³ç³»å¦‚ä½•ï¼Œp(X1|X2)ä¸å˜</li>
</ul>
</li>
<li>B.å¹²é¢„  p(X1|do(X2))
<ul>
<li>åœ¨ï¼ˆ1ï¼‰çš„æƒ…å†µä¸‹ï¼ŒX1æ˜¯åŸå› X2æ˜¯ç»“æœï¼Œåˆ™p(X1|do(X2))  = p(X1)ã€ä¸Šé¢åˆ’çº¿å¥ã€‘</li>
<li>åœ¨ï¼ˆ2ï¼‰çš„æƒ…å†µä¸‹ï¼ŒX1æ˜¯ç»“æœX2æ˜¯åŸå› ï¼Œåˆ™p(X1|do(X2))  = p(X1|X2)</li>
</ul>
</li>
</ul>
<h3 id="backdoor-frontdoor-criterion">backdoor / frontdoor criterion</h3>
<p>ã€‚ã€‚ã€‚ï¼ˆæ²¡ç†è§£ä½†æ˜¯ç´¯äº†ï¼Œsoä¸‹å‘¨ç»§ç»­~</p>
<p>å‚è€ƒèµ„æ–™ï¼š</p>
<p><a href="https://www.bilibili.com/video/BV1nZ4y1K78i?p=1">çˆ±å¯å¯è€å¸ˆåœ¨Bç«™ä¸Šæ¨èçš„å› æœæ¨ç†å¯¼è®ºè¯¾</a></p>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[å“ˆä½›å¤§å­¦å¹¸ç¦è¯¾ç¬”è®° ï¼ˆä¸Šï¼‰p1-p8]]></title>
        <id>https://yangggshuyi.github.io/post/ha-fo-da-xue-xing-fu-ke-bi-ji-shang-p1-p8/</id>
        <link href="https://yangggshuyi.github.io/post/ha-fo-da-xue-xing-fu-ke-bi-ji-shang-p1-p8/">
        </link>
        <updated>2021-03-05T16:04:01.000Z</updated>
        <summary type="html"><![CDATA[<blockquote>
<p>çƒ­è¯„: â€œå…œå…œè½¬è½¬è¿™ä¹ˆå¤šå¹´ï¼Œå®Œç¾ä¸»ä¹‰ï¼Œè¿‡çŠ¹ä¸åŠï¼Œall or nothingï¼Œå½’å’ä»–äººï¼Œè¿™äº›â€œé—®é¢˜â€æˆ´ä¸Šå„å¼é¢å…·ç»§ç»­å›°æ‰°ç€æˆ‘ã€‚ä¸€å¤±è´¥å°±æ‰‹è¶³æ— æªï¼Œä¸€åŠªåŠ›å°±æ€¥äºæ±‚æˆï¼Œæˆ‘å‡ ä¹ç¿»éæ‰€æœ‰å†™ç„¦è™‘ï¼ŒæŠ‘éƒï¼Œæ¶ˆæçš„å¸–å­ï¼Œå´æ€»æ˜¯é¬¼æ‰“å¢™ä¸€èˆ¬åœ°æ¶æ€§å¾ªç¯ã€‚ä»Šå¹´å¡åœ¨äººç”Ÿè½¬å˜çš„å…³å£ï¼Œè¶Šæ¥è¶Šæ·±åˆ»åœ°æ„Ÿå—åˆ°ç§¯æä¸»åŠ¨çš„é‡è¦æ€§ï¼Œäºæ˜¯é‡æ–°æ‰“å¼€è¿™é—¨è¯¾ï¼Œè®¤è®¤çœŸçœŸåœ°ä»å¤´çœ‹å®Œã€‚&quot;</p>
</blockquote>
]]></summary>
        <content type="html"><![CDATA[<blockquote>
<p>çƒ­è¯„: â€œå…œå…œè½¬è½¬è¿™ä¹ˆå¤šå¹´ï¼Œå®Œç¾ä¸»ä¹‰ï¼Œè¿‡çŠ¹ä¸åŠï¼Œall or nothingï¼Œå½’å’ä»–äººï¼Œè¿™äº›â€œé—®é¢˜â€æˆ´ä¸Šå„å¼é¢å…·ç»§ç»­å›°æ‰°ç€æˆ‘ã€‚ä¸€å¤±è´¥å°±æ‰‹è¶³æ— æªï¼Œä¸€åŠªåŠ›å°±æ€¥äºæ±‚æˆï¼Œæˆ‘å‡ ä¹ç¿»éæ‰€æœ‰å†™ç„¦è™‘ï¼ŒæŠ‘éƒï¼Œæ¶ˆæçš„å¸–å­ï¼Œå´æ€»æ˜¯é¬¼æ‰“å¢™ä¸€èˆ¬åœ°æ¶æ€§å¾ªç¯ã€‚ä»Šå¹´å¡åœ¨äººç”Ÿè½¬å˜çš„å…³å£ï¼Œè¶Šæ¥è¶Šæ·±åˆ»åœ°æ„Ÿå—åˆ°ç§¯æä¸»åŠ¨çš„é‡è¦æ€§ï¼Œäºæ˜¯é‡æ–°æ‰“å¼€è¿™é—¨è¯¾ï¼Œè®¤è®¤çœŸçœŸåœ°ä»å¤´çœ‹å®Œã€‚&quot;</p>
</blockquote>
<!-- more -->
<h1 id="01-02-make-your-life-better">01-02 make your life better</h1>
<p><em>No one is coming to make your life better for you. You're resposible for your life,for  your self-confidence, for your happiness.</em></p>
<ul>
<li>
<p>æˆ‘ä»¬ç°åœ¨çš„æ—¶é—´å¤§å¤šèŠ±åœ¨ time-outï¼ŒèŠ±åœ¨look into yourself çš„ time-in å¤ªå°‘äº†</p>
</li>
<li>
<p>Question create realityï¼šå¤šé—®é—®è‡ªå·±ç§¯æé—®é¢˜ï¼Œæ¯”å¦‚æˆ‘çš„ä¼˜ç‚¹æ˜¯ä»€ä¹ˆï¼ˆå¿ƒç†æš—ç¤ºï¼‰</p>
</li>
<li>
<p>slightly happy if you lower my levels of expectation, but not in the long term.ï¼ˆå¯¹æœ€è¿‘çš„æˆ‘æ¥è¯´å¾ˆé‡è¦ï¼‰ã€‚è´¢å¯Œã€å‡èŒç­‰ç­‰éƒ½ make very little difference.</p>
</li>
</ul>
<h1 id="03-05-the-cause-of-unhappiness">03-05 the cause of unhappiness</h1>
<ul>
<li>
<p>å¼—æ´›ä¾å¾·ï¼šâ€œäººä»¬åœ¨èˆ’é€‚åœ°éº»æœ¨â€ã€‚äººç±»çš„é€‚åº”æ€§ï¼Œä½†è¿™ç§é€‚åº”æ€§å¸¦æ¥çš„å¯¹ç¾å¥½äº‹ç‰©çš„ä¹ ä»¥ä¸ºå¸¸ï¼Œè®©æˆ‘ä»¬å¯¹äº‹æƒ…éº»æœ¨ï¼Œè¿™æ˜¯è´Ÿé¢çš„ï¼ˆæƒ³èµ·ç‹å°æ³¢å…³äºæŒ‘ç²ªç”Ÿæ´»çš„é‚£å¥è¯äº†ï¼‰ã€‚æˆ‘ä»¬å¦‚æœå¯¹æ¶ˆæå¯é€‚åº”ï¼Œä½†å¯¹å¹¸ç¦çš„æ—¥å¸¸ç”Ÿæ´»ä¸ä¹ ä»¥ä¸ºå¸¸ã€‚å°±å¥½äº†ã€‚</p>
</li>
<li>
<p>æˆ–è®¸ç›¸ä¿¡æŸä»¶äº‹èƒ½åŸºäºç²¾ç¥ä¸Šæ…°è—‰å’Œå……å®ï¼Œä½†é•¿æœŸä¼šäº§ç”Ÿæ„§ç–šæ„Ÿå’Œæ²®ä¸§æ„Ÿã€‚</p>
</li>
<li>
<p>åªæœ‰æ­£ç¡®çš„ expectation æ‰èƒ½è®©æˆ‘ä»¬ happier ã€‚é”™è¯¯çš„ expectation æ¯”å¦‚ï¼šæ‰¾åˆ°å·¥ä½œ/ç†æƒ³ä¼´ä¾£ï¼Œè€Œ right expectation is to believe in changeâ€”â€”ç›¸ä¿¡äº‹æƒ…ä¼šå®Œç¾è§£å†³</p>
</li>
<li>
<p>è®¤ä¸ºç”Ÿæ´»æœ‰æ„ä¹‰ã€‚æ„ä¹‰æ„Ÿä»å“ªé‡Œæ¥ï¼ŸGoal settingï¼Œrole modelï¼Œsocial supportï¼Œcourage of admit weaknessã€‚çœŸæ­£æ„Ÿè§‰å¹¸ç¦çš„äººçš„ leading question: how can I make this world a better place?</p>
</li>
<li>
<p>No.1 cause of unhappinessâ€”people feel guilty about pursuing their own happiness. æ€ä¹ˆè§£å†³ï¼šthe permission to be human: rejecting our nature leads to suboptimal performance. æ¯”å¦‚ï¼Œ<strong>å«‰å¦’æ˜¯ä¸€ç§æƒ…æ„Ÿï¼Œæˆ‘ä»¬ accept&amp;æ‰¿è®¤ï¼Œä½†æ˜¯ä¸ä»£è¡¨å±ˆä»è¿™ç§æƒ³æ³•</strong>ï¼Œe.g. i can still experience envy toward my best friend, and choose to behave generously toward him.</p>
</li>
<li>
<p>æ‚²è§‚å’Œä¹è§‚åŒºåˆ«ä¸åœ¨äºæ˜¯å¦å¿«ä¹ï¼Œè€Œæ˜¯å¤šå¿«èƒ½ä»ä¸å¿«ä¹ä¸­æ¢å¤è¿‡æ¥â€”â€”ç§¯æä¸»åŠ¨åœ°å»å¤„ç†è¿™äº›æƒ…å†µã€‚é‡ç‚¹åœ¨äºï¼šmore generous, more accepting of other people, more tolerant of other people as well as ourselves.</p>
</li>
<li>
<p>å…·ä½“æ¥è¯´ï¼Œå°è¯•<strong>ä¸€å¤©å†…å¤šåšäº”ä»¶å¥½äº‹</strong>ï¼Œæ¯æ—¥å†¥æƒ³ï¼ˆä»Šå¤©1/1ï¼‰</p>
</li>
</ul>
<h1 id="06-08-learn-to-fail-or-fail-to-learn">06-08  learn to fail, or fail to learn</h1>
<ul>
<li>ç„¦è™‘çš„æˆå› ä¾¿æ˜¯æ„è¯†åˆ°ç†æƒ³ä¸ç°å®çš„gapã€‚è§£å†³ç„¦è™‘ï¼š
<ul>
<li>è¦ä¹ˆæ”¹å˜ç†æƒ³ï¼Œå¢™å¤´è‰åˆå¦‚ä½•</li>
<li>è¦ä¹ˆæ”¹å˜ç°å®ï¼šâ‘ æ”¹å˜ä¸»è§‚å¯¹ç°å®çš„è®¤çŸ¥ï¼šé€‰æ‹©æ€§çœ‹å¾…ç°å®ï¼Œé€ƒé¿æ€»æ˜¯æ¯”æ”¹å˜ç®€å•å‘¢ï¼›â‘¡æ”¹å˜å®¢è§‚ç°å®</li>
</ul>
</li>
<li>äººç”Ÿçš„èµ·ä¼æ”¹å˜çš„ä¸è¿‡æ˜¯æš‚æ—¶çš„å¹¸ç¦ä¸è‡ªå°Šï¼Œé‚£ä¹ˆæ€æ ·æå‡ base level happniessï¼Ÿå¹¸ç¦å’Œä»€ä¹ˆå…³ç³»æœ€å¤§ï¼Ÿç­”æ¡ˆæ˜¯è‡ªå°Š self-concept is destiny.  <strong>æ€æ ·æå‡è‡ªå°Šï¼Ÿ</strong>
<ul>
<li>ã€è¡ŒåŠ¨èµ·æ¥ã€‘<strong>è§£å†³è€Œä¸æ˜¯é€ƒé¿é—®é¢˜ï¼ŒæŠŠè‡ªå·±ç½®äºé£é™©ä¹‹ä¸Š</strong>ï¼Œå°è¯•é‚£äº›é‡è¦çš„äº‹æƒ…ï¼Œè‡ªå°Šä¼šèºæ—‹å¼ä¸Šå‡ã€‚why? â€”â€”Self-perception theoryã€‚å¤šç»å†å¤±è´¥ï¼Œæˆé•¿çš„é€”å¾„åªæœ‰è¿™ä¸€æ¡ã€‚<em>learn to fail, or fail to learn</em></li>
<li>ã€æƒ³è±¡æˆåŠŸã€‘å¤§è„‘æ— æ³•åŒºåˆ«çœŸå®çš„äº‹ç‰©å’Œæƒ³è±¡çš„äº‹ç‰©ï¼Œåå¤æƒ³è±¡æˆåŠŸ</li>
<li>ã€è®¤çŸ¥ç–—æ³•ã€‘é¿å…æ”¾å¤§ï¼Œå½’çº³è¿‡åº¦</li>
</ul>
</li>
</ul>
<blockquote>
<p><strong>è‡ªæˆ‘è®¤çŸ¥ç†è®º</strong>: å¦‚æœçœ‹åˆ°åˆ«äººä¸»åŠ¨äº¤æµã€å‘è¨€ã€å°è¯•ï¼Œæˆ‘ä¼šè§‰å¾—ä»–å¾ˆè‡ªä¿¡æœ‰å‹‡æ°”ï¼Œäºæ˜¯ä¾¿ä¼šç”¨åŒæ ·çš„æ–¹å¼åˆ¤æ–­è‡ªå·±çš„è‡ªå°Šã€å®½å®¹ç¨‹åº¦ã€è±è¾¾ç¨‹åº¦ã€‚æ¯”å¦‚è‡ªå·±ä¹Ÿå¤§èƒ†ä¸»åŠ¨äº¤æµï¼Œé‚£ä¹ˆæˆ‘ä¹Ÿä¼šè®¤ä¸ºâ€æˆ‘ä¸€å®šå¾ˆå‹‡æ•¢â€œã€‚</p>
</blockquote>
<blockquote>
<p><strong>å½’çº³è¿‡åº¦</strong>ï¼šä»–æ‹’ç»äº†æˆ‘ï¼Œå› æ­¤å¤§å®¶éƒ½ä¼šæ‹’ç»æˆ‘ï¼ŒæŠŠå¤±è´¥å½“åšä¸€æ¬¡æœºé‡ã€ä¸€ä¸ªè·³æ¿ï¼Œè€Œæ˜¯è§†ä¹‹ä¸ºä¸–ç•Œæœ«æ—¥ï¼Œæ°¸è¿œæ‰¾ä¸åˆ°å·¥ä½œï¼Œå…¨æœ‰æˆ–å…¨æ— ã€‚è¦ä¹ˆå…¨æ˜¯Aï¼Œè¦ä¹ˆå°±æ˜¯å½»åº•çš„å¤±è´¥ï¼Œé˜»æ­¢æˆ‘ä»¬æŠ•å…¥è¿›å»ã€‚å®ƒçš„å¦ä¸€é¢ï¼ŒåŒä¸€ä¸ªç¡¬å¸çš„å¦ä¸€é¢ï¼Œæ˜¯æå°åŒ–ã€‚</p>
</blockquote>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[ä¸šåŠ¡é¢˜ | æŒ‡æ ‡å¼‚åŠ¨é—®é¢˜]]></title>
        <id>https://yangggshuyi.github.io/post/ye-wu-or-zhi-biao-yi-dong-wen-ti/</id>
        <link href="https://yangggshuyi.github.io/post/ye-wu-or-zhi-biao-yi-dong-wen-ti/">
        </link>
        <updated>2021-03-04T13:45:44.000Z</updated>
        <summary type="html"><![CDATA[<p>å¸¸è§é—®é¢˜ï¼šGMV\æ—¥æ´»\è½¬åŒ–ç‡\å®¢å•ä»·\ç”¨æˆ·æµå¤±ç‡çš„å˜åŒ–åŸå› åˆ†æã€‚åˆ†æåŸºæœ¬æµç¨‹ï¼šæ˜ç¡®é—®é¢˜â€”â€”å®šä½é—®é¢˜â€”â€”åŸå› å‡è®¾â€”â€”æå‡ºå»ºè®®/æ•°æ®æ”¯æ’‘å‡è®¾ã€‚</p>
]]></summary>
        <content type="html"><![CDATA[<p>å¸¸è§é—®é¢˜ï¼šGMV\æ—¥æ´»\è½¬åŒ–ç‡\å®¢å•ä»·\ç”¨æˆ·æµå¤±ç‡çš„å˜åŒ–åŸå› åˆ†æã€‚åˆ†æåŸºæœ¬æµç¨‹ï¼šæ˜ç¡®é—®é¢˜â€”â€”å®šä½é—®é¢˜â€”â€”åŸå› å‡è®¾â€”â€”æå‡ºå»ºè®®/æ•°æ®æ”¯æ’‘å‡è®¾ã€‚</p>
<!-- more -->
<h1 id="åŸºæœ¬æµç¨‹">åŸºæœ¬æµç¨‹</h1>
<p>æ˜ç¡®é—®é¢˜â€”â€”å®šä½é—®é¢˜â€”â€”åŸå› å‡è®¾å’Œå»ºè®®</p>
<p>1.æ˜ç¡®é—®é¢˜ï¼šç¡®è®¤æ•°æ®çœŸå®æ€§ï¼Œæ˜¯ç›¸å¯¹ä»€ä¹ˆè€Œè¨€çš„ä¸‹é™</p>
<p>2.å®šä½é—®é¢˜ï¼šæŒ‡æ ‡æ‹†è§£+æ¼æ–—åˆ†æ</p>
<p>3.åŸå› å‡è®¾ï¼Œå†…éƒ¨ï¼ˆè¿è¥ã€å¼€å‘ï¼‰+å¤–éƒ¨ï¼ˆpestï¼‰</p>
<p>4.æå‡ºå»ºè®®ï¼šé’ˆå¯¹ä¸åŒçš„åŸå› å‡è®¾</p>
<h1 id="å…·ä½“åˆ†æ">å…·ä½“åˆ†æ</h1>
<h2 id="å•ä¸€ç±»æŒ‡æ ‡dau">å•ä¸€ç±»æŒ‡æ ‡â€”â€”DAU</h2>
<p>DAU ä¸‹é™ï¼Œå¦‚ä½•åˆ†æï¼Ÿç›´æ¥å¥—ç”¨ä¸Šé¢çš„åŸºæœ¬æµç¨‹ï¼š</p>
<h3 id="1æ˜ç¡®é—®é¢˜">1.æ˜ç¡®é—®é¢˜</h3>
<p>ç¡®è®¤æ•°æ®çœŸå®æ€§ï¼Œè®¡ç®—bugï¼›ç¡®è®¤æ˜¯ç›¸å¯¹ä»€ä¹ˆè€Œè¨€çš„ä¸‹é™ï¼ˆæ¨ªæ¯”è¿˜æ˜¯æ€»æ¯”ï¼Ÿï¼‰</p>
<ul>
<li>ç¯æ¯”æ•°æ®ï¼šå¹³ç¨³ä¸‹é™è¿˜æ˜¯éª¤è·Œï¼Ÿæ’æŸ¥çªå‘æ€§äº‹ä»¶è¿˜æ˜¯ç´¯ç§¯æ€§äº‹ä»¶ã€‚</li>
<li>è¿‘å¹´åŒæ¯”æ•°æ®ï¼šæ˜¯å¦æœ‰åŒçº§åˆ«çš„ä¸‹é™ï¼Ÿæ’æŸ¥æ˜¯å¦æ”¶åˆ°å‘¨æœŸæ€§ã€èŠ‚æ—¥ã€é‡å¤§èµ›äº‹çš„åˆ†æ</li>
</ul>
<h3 id="2å®šä½é—®é¢˜">2.å®šä½é—®é¢˜</h3>
<p>æŒ‡æ ‡æ‹†è§£å®šä½é—®é¢˜ï¼Œè¶Šç»†è¶Šå¥½â€”â€”å®šä½å…·ä½“ç¾¤ä½“</p>
<p>å¸¸è§åˆ†æé¡ºåºï¼šæ–° or è€ç”¨æˆ·ï¼Œç”¨æˆ·æ¥æºæ¸ é“ï¼ˆè´¨é‡ï¼Œå®šä½é—®é¢˜ï¼Œå¸®åŠ©åˆ†æå„ä¸ªæ¸ é“æŠ•æ”¾ROIï¼Œä»è€Œæ”¹å˜æ¸ é“æŠ•æ”¾æ¯”ä¾‹æˆ–è€…å†…å®¹ï¼‰ï¼Œç™»å½•å…¥å£ï¼ˆæ‰‹æœºç«¯å’Œpcæ®µï¼‰ï¼Œæœºå‹ï¼ˆä¸åŒæ¡£æ¬¡çš„æœºå‹ï¼Œç”¨æˆ·è´¨é‡ä¸åŒï¼‰ç­‰ç­‰ã€‚å…·ä½“å¯ä»¥è®¡ç®—æŒ‡æ ‡å˜åŒ–ç‡ã€‚</p>
<ul>
<li>ç”¨æˆ·åˆ†ç¾¤
<ul>
<li>åŸºæœ¬ï¼šæ–°è€ç”¨æˆ·ã€æ¸ é“ã€æœºå‹ã€ç™»å½•å…¥å£</li>
<li>ç”»åƒï¼šç”·å¥³ã€åœ°åŒºã€èŒä¸šç­‰ç­‰</li>
</ul>
</li>
<li>è®¿é—®æ—¶æ®µ</li>
</ul>
<h3 id="3åŸå› å‡è®¾">3.åŸå› å‡è®¾</h3>
<p>æå‡ºåŸå› å‡è®¾ï¼Œä¸ºä»€ä¹ˆä¼šå‡ºç°é—®é¢˜ã€‚</p>
<ul>
<li>å†…éƒ¨åŸå› 
<ul>
<li>äº§å“ï¼šåŠŸèƒ½å˜åŠ¨ã€æ¨èç­–ç•¥è°ƒæ•´ã€UIè®¾è®¡æ”¹åŠ¨</li>
<li>å¼€å‘ï¼šbugï¼Ÿè€—ç”µï¼ŒåŠ è½½è¿‡æ…¢</li>
<li>è¿è¥ï¼šæ¨é€æ´»åŠ¨ï¼Œæ¨å¹¿æ•ˆæœä¸ä½³</li>
</ul>
</li>
<li>å¤–éƒ¨åŸå› ï¼š
<ul>
<li>æ—¶é—´å› ç´ ï¼Œæ¯”å¦‚å¼€å­¦æˆ–è€…å‡æœŸ</li>
<li>æ”¿åºœæ”¿ç­–ã€ç¤¾ä¼šäº‹ä»¶ï¼ˆèˆ†è®ºï¼‰</li>
<li>å¸‚åœºä»·æ ¼ã€ç«å“</li>
</ul>
</li>
</ul>
<h3 id="4æå‡ºå»ºè®®">4.æå‡ºå»ºè®®</h3>
<ul>
<li>æ¯”å¦‚æŸæ¸ é“ç”¨æˆ·è½¬åŒ–ç‡/ç•™å­˜ä½ï¼Œè€ƒè™‘ROIï¼Œå‡å°‘æ¸ é“æŠ•æ”¾æˆ–è€…ä¿®æ”¹æŠ•æ”¾å†…å®¹ã€‚</li>
<li>ç”¨æˆ·ä½“éªŒä¸ä½³ï¼Œæ›´æ–°ç‰ˆæœ¬ï¼Œè¿›è¡Œabtest</li>
<li>è€ç”¨æˆ·æµå¤±ï¼Œè°ƒæŸ¥é—®å·è¿›ä¸€æ­¥ä¼˜åŒ–+æŒ½å›</li>
</ul>
<p>ï¼ˆå½“ç„¶ï¼Œè¿™æ˜¯æ¯”è¾ƒæ¨¡æ¿å¼çš„è§£ç­”ï¼Œé¢è¯•å®˜å¯èƒ½ä¼šè§‰å¾—æ²¡æœ‰äº®ç‚¹~</p>
<h2 id="å¤åˆç±»æŒ‡æ ‡gmv">å¤åˆç±»æŒ‡æ ‡â€”â€”GMV</h2>
<p>GMV ä¸‹é™ï¼Œå¦‚ä½•æ‹†è§£åˆ†æï¼Ÿ</p>
<p><strong>gmv = è®¿å®¢æ•° * è½¬åŒ–ç‡ * è®¢å•å‡ä»·</strong></p>
<p>è¿›è¡Œ<strong>æŒ‡æ ‡æ‹†è§£</strong>ï¼ŒéšåæŒ‰ç…§å•ä¸€æŒ‡æ ‡åˆ†æï¼Œæ‹†è§£ä¸ºä»¥ä¸‹ä¸‰ä¸ªæŒ‡æ ‡ï¼š</p>
<ol>
<li>
<p>è®¿å®¢æ•°ï¼šåˆ†æåŒå•ä¸€æŒ‡æ ‡ï¼Œå®šä½å…·ä½“ç”¨æˆ·ç¾¤ä½“é—®é¢˜</p>
</li>
<li>
<p>è½¬åŒ–ç‡ï¼š<strong>æ¼æ–—åˆ†æ</strong></p>
<ul>
<li>
<p>ç”¨æˆ·ä»ç‚¹å¼€APPåˆ°æœ€ç»ˆå®Œæˆè´­ä¹°çš„è¿‡ç¨‹ä¸­ç»å†äº†é‚£äº›æ­¥éª¤ï¼Œåˆ†ææ¯ä¸ªå­ç¯èŠ‚æ‰€äº§ç”Ÿçš„ç”¨æˆ·æµå¤±ç‡ï¼Œä»è€Œå®šä½åˆ°å…·ä½“å­ç¯èŠ‚çš„åŠŸèƒ½æˆ–è€…ç•Œé¢ç­‰é—®é¢˜ã€‚</p>
</li>
<li>
<p>æ¯”å¦‚æ‹†è§£ä¸ºï¼šå¹¿å‘Šç‚¹å‡»ã€å•†å“æµè§ˆã€æ”¾å…¥è´­ç‰©è½¦ã€äº¤æ˜“æˆåŠŸï¼Œæ£€æŸ¥æ¯ä¸€æ­¥è½¬åŒ–ç‡æ˜¯å¦æœ‰æ˜¾è‘—å˜åŒ–ã€‚</p>
</li>
</ul>
</li>
<li>
<p>è®¢å•å‡ä»·ï¼šè€ƒè™‘æ”¿åºœæ”¿ç­–ï¼Œå¸‚åœºä»·æ ¼ç­‰å¤–éƒ¨å› ç´ </p>
</li>
</ol>
<h1 id="çœŸé¢˜æ€è·¯">çœŸé¢˜æ€è·¯</h1>
<ol>
<li>æŠ–éŸ³æ—¥æ´»ä¸‹é™20%ï¼Œå¦‚ä½•åˆ†æï¼Ÿ</li>
</ol>
<p>ï¼ˆ1ï¼‰20% è¿‡å¤§ï¼Œæš—ç¤ºéœ€è¦ç¡®å®šæ•°æ®çš„å‡†ç¡®æ€§ã€‚ï¼ˆ2ï¼‰é—®é¢˜æ‹†è§£ï¼Œä»ç”¨æˆ·ã€äº§å“ã€è¿è¥ã€å†…å®¹å››ä¸ªè§’åº¦è¿›è¡Œäº†åˆ†æï¼Œç„¶åç»§ç»­ç»†åˆ†å„ä¸ªç»´åº¦ï¼Œåœ¨ç”¨æˆ·è§’åº¦å¯ä»¥æ‹†åˆ†å¤„ä¸åŒå…¥å£ã€ä¸åŒæ—¶é—´æ®µç­‰æŒ‡æ ‡ï¼Œå¯¹è¿™äº›æŒ‡æ ‡è¿›è¡Œè¯¦ç»†çš„è®¡ç®—å’Œåˆ†æï¼Œæˆ‘ä»¬ä¾¿çŸ¥é“æ˜¯å¦å…¶å½±å“äº†æ—¥æ´»çš„å˜åŒ–ã€‚å¤–éƒ¨å› ç´ ä¸»è¦ä»ç«å“ï¼Œæ”¿ç­–ï¼Œç¤¾ä¼šç¯å¢ƒä¸‰ä¸ªæ–¹é¢è¿›è¡Œäº†æ‹†åˆ†ï¼Œæ¯”å¦‚æŸå›½ä¸‹æ¶æŠ–éŸ³APPã€‚ï¼ˆ3ï¼‰åšå‡ºå‡è®¾+è§£å†³ï¼Œæ¯”å¦‚â‘ å‘ç°æ–°ç”¨æˆ·ä¸‹é™å¤šï¼ŒæŒ‰ç…§æ¸ é“åˆ’åˆ†ï¼Œå¦‚æœå‘ç°æŸæ¸ é“æœ‰é—®é¢˜ï¼Œåˆ†ææ˜¯æµé‡è¿˜æ˜¯è½¬åŒ–ç‡ä½ï¼Œä»è€Œå®šåˆ¶æ¸ é“ä¼˜åŒ–ç­–ç•¥ï¼›â‘¡è¿‘æœŸæœ‰é‡è¦äº§å“è¿­ä»£ï¼Œabtestçš„ç»“æœè¡¨ç°å¦‚ä½•ã€‚</p>
<ol start="2">
<li>æ¯å¹´å¤å¤©åŒ—äº¬çš„æ»´æ»´å‘¼å«é‡å¢åŠ ï¼Œä¸ºä»€ä¹ˆï¼Ÿ</li>
</ol>
<p>ï¼ˆ1ï¼‰æ˜ç¡®é—®é¢˜ï¼Œå¤å¤©åŒ—äº¬å‘¼å«é‡å¢åŠ æ˜¯é’ˆå¯¹æ˜¥å¤©ï¼Œè¿˜æ˜¯é’ˆå¯¹ä¸Šæµ·ã€‚ï¼ˆ2ï¼‰è¿›è¡Œé—®é¢˜å®šä½ï¼ˆå¥—è·¯ï¼‰ã€‚ï¼ˆ3ï¼‰åŸå› å‡è®¾ï¼Œ<strong>ç”±äºæ˜¯æ¯å¹´å¤å¤©éƒ½å¢åŠ ï¼Œå¼ºè°ƒå‘¨æœŸå­£èŠ‚å› ç´ </strong>ï¼Œå¦‚æœåˆ†æå†…éƒ¨åŸå› æˆ–è€…çªå‘äº‹ä»¶æ˜¾å¾—å¼ºè¡Œã€‚é¢˜ç›®â€œå¤å¤©â€æš—ç¤ºæ˜æ˜¾ï¼Œå¯ä»¥åˆ†ææš‘æœŸæ—…æ¸¸äººæ•°å¢åŠ ï¼Œæˆ–è€…å¤å­£é›¨å¤©å¢åŠ ã€‚ï¼ˆ4ï¼‰è¿™é‡Œç”±äºæ˜¯å¢åŠ ï¼Œä¸éœ€è¦åˆ†ææ”¹è¿›å»ºè®®ï¼Œè½¬è€Œå¯ä»¥ç»™å‡ºå‡è®¾çš„æ•°æ®æ”¯æ’‘ï¼Œæ¯”å¦‚åˆ†æåŸå› è®¤ä¸ºï¼šâ‘ â€œæš‘æœŸæ—…æ¸¸äººæ•°å¢åŠ å¯¼è‡´çš„â€â€”â€”ç»™å‡ºç”¨æˆ·æ•°å˜åŒ–+æ”¿åºœæ¸¸å®¢æ•°æ®ï¼›â‘¡â€œå¤å­£é›¨å¤©å¢åŠ å¯¼è‡´çš„â€â€”â€”ç»™å‡ºå¤å­£é›¨å¤©æ•°é‡+é›¨å¤©å’Œæ™´å¤©æ‰“è½¦äººæ•°å¯¹æ¯”ï¼Œ</p>
<ol start="3">
<li>618åæ‹¼å¤šå¤šæˆäº¤é‡ä¸‹é™ï¼Œåˆ†æåŸå› å¹¶è¯´æ˜éœ€è¦ç”¨å“ªäº›æ•°æ®ä½œæ”¯æ’‘ã€ã€ã€</li>
</ol>
]]></content>
    </entry>
</feed>